"0","# experiment setup"
"0","n <- 100"
"0","set.seed(12345)"
"0","y <- rnorm(n, 0, 1)"
"0","n_iter <- 10^3"
"0","mu_sample <- tau_sample <- numeric(n_iter)"
"0",""
"0","# vague priors: mu ~ N(0, 1/100^2); tau ~ Gamma(.01, 01)"
"0","mu_0 <- 0"
"0","tau_0 <- 1 / 100^2"
"0","a <- .01"
"0","b <- .01"
"0",""
"0","# mu|tau,y "
"0","sample_mu <- function(tau) {"
"0","  mean_mu <- (n * mean(y) * tau + mu_0 * tau_0) / (n * tau + tau_0)"
"0","  precision_mu <- n * tau + tau_0"
"0","  rnorm(1, mean_mu, 1 / sqrt(precision_mu))"
"0","}"
"0","# tau|mu,y"
"0","sample_tau <- function(mu) {"
"0","  rgamma(1, a + n/2, b + .5 * sum((y - mu)^2))"
"0","}"
"0",""
"0","# starting values"
"0","mu_sample[1] <- mean(y)"
"0","tau_sample[1] <- 1 / var(y)"
"0",""
"0","for(i in 2:n_iter){"
"0","  mu_sample[i] <- map_dbl(tau_sample[i-1], sample_mu)"
"0","  tau_sample[i] <- map_dbl(mu_sample[i-1], sample_tau)"
"0","}"
"0",""
"0","# posterior mu"
"0","mean(mu_sample); quantile(mu_sample, c(.025, .975))"
"1","[1]"
"1"," 0.249428"
"1","
"
"1","     2.5% "
"1","    97.5% "
"1","
"
"1","0.0283041 "
"1","0.4718523 "
"1","
"
"0","# posterior tau"
"0","mean(tau_sample); quantile(tau_sample, c(.025, .975))"
"1","[1]"
"1"," 0.8084949"
"1","
"
"1","     2.5% "
"1","    97.5% "
"1","
"
"1","0.6046357 "
"1","1.0507100 "
"1","
"
"0","tibble(iter = 1:n_iter, mu = mu_sample, tau = tau_sample) %>%"
"0","  pivot_longer(cols = c(mu, tau)) %>% "
"0","  ggplot(aes(x = value)) + geom_density() + "
"0","  facet_wrap(facets = vars(name), scales = ""free"") +"
"0","  labs(title = ""Posterior Distributions"", x = NULL)"
