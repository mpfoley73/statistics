"0","plot_bayes <- function(alpha, beta, a, b) {"
"0",""
"0","  prior_ev <- (alpha / (alpha + beta)) %>% round(2)"
"0","  posterior_ev <- ((alpha + a) / (alpha + beta + a + b)) %>% round(2)"
"0","  dat <- data.frame(theta = seq(0, 1, by = .01)) %>%"
"0","    mutate(prior = (1 / beta(alpha, beta)) * theta^(alpha-1) * (1-theta)^(beta-1),"
"0","           prior_ci = theta > qbeta(.025, alpha, beta) & "
"0","                      theta < qbeta(.975, alpha, beta),"
"0","           likelihood = theta^a * (1-theta)^b,"
"0","           posterior = (1 / beta(alpha + a, beta + b)) * theta^(alpha-1+a) * (1-theta)^(beta-1+b),"
"0","           posterior_ci = theta > qbeta(.025, alpha + a, beta + b) & "
"0","                      theta < qbeta(.975, alpha + a, beta + b))"
"0","  "
"0","  p_prior <- dat %>%"
"0","    ggplot(aes(x = theta, y = prior)) + "
"0","    geom_line(color = ""steelblue"") +"
"0","    geom_area(aes(alpha = prior_ci), fill = ""steelblue"") +"
"0","    geom_vline(xintercept = prior_ev, color = ""steelblue"") +"
"0","    scale_alpha_manual(values = c(.1, .5)) +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""none"") +"
"0","    labs(x = NULL)"
"0","  "
"0","  p_likelihood <- dat %>%"
"0","    ggplot(aes(x = theta, y = likelihood)) + "
"0","    geom_line(color = ""steelblue"") +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""none"") +"
"0","    labs(x = NULL)"
"0","  "
"0","  p_posterior <- dat %>%"
"0","    ggplot(aes(x = theta, y = posterior)) + "
"0","    geom_line(color = ""steelblue"") +"
"0","    geom_area(aes(alpha = posterior_ci), fill = ""steelblue"") +"
"0","    geom_vline(xintercept = posterior_ev, color = ""steelblue"") +"
"0","    scale_alpha_manual(values = c(.1, .5))  +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""none"") +"
"0","    labs(x = expression(theta))"
"0","  "
"0","  out <- p_prior / p_likelihood / p_posterior +"
"0","    plot_annotation("
"0","      title = glue(""Beta({alpha}, {beta}) prior with observed evidence a = {a} "","
"0","                   ""and b = {b}""),"
"0","      subtitle = ""with shaded 95% credible interval."","
"0","      caption = glue(""Prior expected value = {prior_ev}; Posterior expected "","
"0","                     ""value = {posterior_ev}""))"
"0","  out"
"0","}"
