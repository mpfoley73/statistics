"0","ad_prop_test <- prop.test(13, 100)"
"0","click_rate_mu <- ad_prop_test$estimate"
"0","click_rate_se <- sqrt(click_rate_mu*(1-click_rate_mu)) / sqrt(100)"
"0","data.frame(pi = seq(0, .30, by = .01)) %>%"
"0","  mutate("
"0","    likelihood = dnorm(pi, click_rate_mu, click_rate_se),"
"0","    # observed = map(pi, ~ c(., 1 - .) * 100),"
"0","    # expected = map(13/100, ~c(., 1 - .) * 100),"
"0","    # x2 = map2_dbl(observed, expected, ~sum((.x - .y)^2 / .y)),"
"0","    # likelihood = dchisq(x2, 1),"
"0","    # pcs = pchisq(x2, 1),"
"0","    ci_low = if_else(pi <= ad_prop_test$conf.int[1], likelihood, NA_real_),"
"0","    ci_high = if_else(pi >= ad_prop_test$conf.int[2], likelihood, NA_real_)"
"0","  ) %>%"
"0","  ggplot(aes(x = pi)) +"
"0","  geom_line(aes(y = likelihood)) +"
"0","  geom_area(aes(y = ci_low), fill = ""firebrick"", alpha = .4) +"
"0","  geom_area(aes(y = ci_high), fill = ""firebrick"", alpha = .4) +"
"0","  geom_vline(xintercept = click_rate_mu, linetype = 2) +"
"0","  theme_minimal() +"
"0","  scale_x_continuous(breaks = seq(0, .3, .05)) +"
"0","  theme(panel.grid.minor = element_blank()) +"
"0","  labs(title = ""Frequentist proportion test for 13 clicks in 100 impressions"", "
"0","       subtitle = glue(""p = {click_rate_mu}, 95%-CI ("","
"0","       ""{ad_prop_test$conf.int[1] %>% scales::number(accuracy = .01)}, "","
"0","       ""{ad_prop_test$conf.int[2] %>% scales::number(accuracy = .01)})""),"
"0","       x = expression(theta))"
