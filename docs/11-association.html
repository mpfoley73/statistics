<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Association – Statistical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12-matrix-algebra.html" rel="next">
<link href="./10-binomial-multinomial-pairwise.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-association.html">Association</a></li><li class="breadcrumb-item"><a href="./11-association.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Association</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Inference</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Frequentist</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-frequentist-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Frequentist Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-likelihood-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Likelihood Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Bayesian</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-bayesian-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Point Estimates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-one-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One-Sample</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pt1-group-differences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Group Differences</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-continuous-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Continuous ~ Binomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-continuous-binomial-pairwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Paired Samples t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-continuous-multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous ~ Multnomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-binomial-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binomial ~ Binomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-multinomial-multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multinomial ~ Multinomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-binomial-multinomial-pairwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Pairwise Discrete ~ Multinomial</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Association</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-association.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Association</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Reference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-matrix-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix Algebra</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pearson" id="toc-pearson" class="nav-link active" data-scroll-target="#pearson"><span class="header-section-number">11.1</span> Pearson’s Correlation</a></li>
  <li><a href="#spearman" id="toc-spearman" class="nav-link" data-scroll-target="#spearman"><span class="header-section-number">11.2</span> Spearman’s Rho</a></li>
  <li><a href="#kendall" id="toc-kendall" class="nav-link" data-scroll-target="#kendall"><span class="header-section-number">11.3</span> Kendal’s Tau</a></li>
  <li><a href="#case-study-pearson-spearman-kendall" id="toc-case-study-pearson-spearman-kendall" class="nav-link" data-scroll-target="#case-study-pearson-spearman-kendall"><span class="header-section-number">11.4</span> Case Study: Pearson, Spearman, Kendall</a>
  <ul>
  <li><a href="#conditions" id="toc-conditions" class="nav-link" data-scroll-target="#conditions">Conditions</a></li>
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test</a></li>
  </ul></li>
  <li><a href="#chisq-independence" id="toc-chisq-independence" class="nav-link" data-scroll-target="#chisq-independence"><span class="header-section-number">11.5</span> Chi-Square Test of Independence</a></li>
  <li><a href="#fisher-exact" id="toc-fisher-exact" class="nav-link" data-scroll-target="#fisher-exact"><span class="header-section-number">11.6</span> Fisher’s Exact Test</a></li>
  <li><a href="#case-study-chi-square-fisher" id="toc-case-study-chi-square-fisher" class="nav-link" data-scroll-target="#case-study-chi-square-fisher"><span class="header-section-number">11.7</span> Case Study: Chi-Square, Fisher</a>
  <ul>
  <li><a href="#conditions-1" id="toc-conditions-1" class="nav-link" data-scroll-target="#conditions-1">Conditions</a></li>
  <li><a href="#test-1" id="toc-test-1" class="nav-link" data-scroll-target="#test-1">Test</a></li>
  </ul></li>
  <li><a href="#kruskals-lambda" id="toc-kruskals-lambda" class="nav-link" data-scroll-target="#kruskals-lambda"><span class="header-section-number">11.8</span> Kruskal’s Lambda</a></li>
  <li><a href="#relative-risk" id="toc-relative-risk" class="nav-link" data-scroll-target="#relative-risk"><span class="header-section-number">11.9</span> Relative Risk</a></li>
  <li><a href="#odds-ratio" id="toc-odds-ratio" class="nav-link" data-scroll-target="#odds-ratio"><span class="header-section-number">11.10</span> Odds Ratio</a></li>
  <li><a href="#partial-correlation" id="toc-partial-correlation" class="nav-link" data-scroll-target="#partial-correlation"><span class="header-section-number">11.11</span> Partial Correlation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-association.html">Association</a></li><li class="breadcrumb-item"><a href="./11-association.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Association</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Association</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Tests of association assess the strength of association between two variables. There are many variations on this theme.</p>
<p><a href="#pearson">Pearson’s correlation</a> assesses the strength of a linear relationship between two continuous variables. It applies when the relationship is linear with no outliers and the variables are bi-variate normal. There are two less restrictive alternatives, <a href="#spearman">Spearman’s rho</a> and <a href="#kendall">Kendall’s tau</a>, that assess the strength and direction of association.</p>
<p>A two-way frequency table is a frequency table for <em>two</em> categorical variables. You usually construct a two-way table to test whether the frequency counts in one categorical variable differ from the other categorical variable using the <a href="#chisq-independence">chi-square test for independence or G-test</a>, or <a href="#fisher-exact">Fisher’s exact test</a>. If there is a significant difference (i.e., the variables are related), then describe the relationship with an analysis of the residuals, calculations of measures of association (difference in proportions, <strong>Phi</strong> and <strong>Cramer’s V</strong>, <strong>Relative risks</strong>, or <strong>Odds Ratio</strong>), and partition tests.</p>
<p>If one of the variables is bivariate categorical, use <strong>point-biserial correlation</strong>, a special case of Pearson’s correlation. <strong>Pearson’s partial correlation</strong> controls for one or more variables - linear regression?</p>
<p>If both variables are ordinal, use <strong>Goodman and Kruskal’s gamma</strong>. <strong>Somers’ d</strong> is an alternative if you want to distinguish between a dependent and independent variable (instead of linear regression?). The <strong>Mantel-Haenszel</strong> test of trend is used to determine whether there is a linear trend (i.e., a linear relationship/association) between two ordinal variables that are represented in a contingency table. The <strong>Cochran-Armitage</strong> test of trend is used to determine whether there is a linear trend (i.e., a linear relationship/association) between an ordinal independent variable and a dichotomous dependent variable.</p>
<p><strong>Goodman and Kruskal’s λ</strong> is a nonparametric measure of the strength of association between two nominal variables where a distinction is made between a dependent and independent variable</p>
<p><strong>Loglinear analysis</strong> is used to understand (and model) associations between two or more categorical variables (i.e., nominal or ordinal variables). However, loglinear analysis is usually employed when dealing with three or more categorical variables, as opposed to two variables, where a chi-square test for association is usually conducted instead.</p>
<p>There are three common correlation tests for categorical variables<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>: Tetrachoric correlation for binary categorical variables; polychoric correlation for ordinal categorical variables; and Cramer’s V for nominal categorical variables.</p>
<section id="pearson" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="pearson"><span class="header-section-number">11.1</span> Pearson’s Correlation</h2>
<p>The Pearson product-moment correlation measures the strength and direction of a linear relationship between two continuous variables, <em>x</em> and <em>y</em>. The Pearson correlation coefficient, <em>r</em>, ranges from -1 (perfect negative linear relationship) to +1 (perfect positive linear relationship). A value of 0 indicates no relationship between two variables.</p>
<p><span class="math display">\[r_{x,y} = \frac{\text{Cov}(x,y)}{\text{SD}(x) \text{SD}(y)}\]</span></p>
<p>The statistic can be used as an estimate of the population correlation, <span class="math inline">\(\rho\)</span>, in a test of statistical significance from 0 (H0: <span class="math inline">\(\rho\)</span> = 0).</p>
<p><span class="math display">\[\rho_{X,Y} = \frac{\text{Cov}(X,Y)}{\text{SD}(X) \text{SD}(Y)}\]</span></p>
<p>As rule of thumb, <span class="math inline">\(|r|\)</span> &lt;.1 is <em>no correlation</em>, [.1, .3) is <em>small</em>, [.3, .5) is <em>moderate</em>, and [.5, 1.0] is <em>strong</em>. The test statistic follows a <em>t</em>-distribution with <em>n</em> − 2 degrees of freedom.</p>
<p><span class="math display">\[t = r_{x,y} \sqrt{\frac{n - 2}{1 - r^2_{x,y}}}\]</span></p>
</section>
<section id="spearman" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="spearman"><span class="header-section-number">11.2</span> Spearman’s Rho</h2>
<p>Spearman’s ranked correlation (Spearman’s rho) is a measure of the strength and direction of a monotonic relationship between two variables that are at least ordinal. Spearman’s correlation is a non-parametric alternative to Pearson when one or more of its conditions are violated. Unlike Pearson, the relationship need not be linear (it only needs to be monotonic), and has no outliers or bivariate normality conditions.</p>
<p>Spearman’s correlation is Pearson’s correlation applied to the <em>ranks</em> of variables (for ordinal variables, their value already is a rank). However, there is also a second definition that gives the same result, at least when there are no ties in the ranks:</p>
<p><span class="math display">\[\rho = 1 - \frac{6 \sum_i d^2_i}{n(n^2 - 1)}\]</span></p>
<p>where <span class="math inline">\(d_i\)</span> is the difference in ranks of observation <span class="math inline">\(i\)</span>.</p>
</section>
<section id="kendall" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="kendall"><span class="header-section-number">11.3</span> Kendal’s Tau</h2>
<p>Kendal’s tau is a second alternative to Pearson and is identical to Spearman’s rho with regard to assumptions. Kendal’s tau only differs from Spearman’s rho in <em>how</em> it measures the relationship. Whereas Spearman measures the correlation of the ranks, Kendal’s tau is a function of concordant (C), discordant (D) and tied (Tx and Ty) pairs of observations. Concordant means both X and Y in one observation of a pair are larger than in the other. Discordant means X is larger in one observation than the other while Y is smaller. Tied mean either both observations have the same X or both have the same Y.</p>
<p><span class="math display">\[\mathrm{Kendall's} \space \tau_b = \frac{C - D}{\sqrt{(C + D + T_x) \times (C + D + T_Y)}}\]</span></p>
</section>
<section id="case-study-pearson-spearman-kendall" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="case-study-pearson-spearman-kendall"><span class="header-section-number">11.4</span> Case Study: Pearson, Spearman, Kendall</h2>
<p>This case study works with two data sets. <code>dat1</code> is composed of two continuous variables; <code>dat2</code> is composed of two ordinal variables.</p>
<p>A researcher investigates the relationship between <code>cholesterol</code> concentration and time spent watching TV, <code>time_tv</code>, in <em>n</em> = 100 otherwise healthy 45 to 65 year old men (<code>dat1</code>). This data set will meet the conditions for Pearson, so we try all three tests on it.</p>
<p>A researcher investigates the relationship between the level of agreement with the statement “<em>Taxes are too high</em>” (<code>tax_too_high</code>, four level ordinal) and participant <code>income</code> level (three level ordinal) (<code>dat2</code>). The ordinal variables rule out Pearson, leaving Spearman and Kendall.</p>
<section id="conditions" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conditions">Conditions</h4>
<p>Pearson’s correlation applies when X and Y are continuous (interval or ratio) paired variables with 1) a linear relationship that 2) has no significant outliers, and 3) are bivariate normal. Spearman’s rho and Kendall’s tau only require that X and Y be at least ordinal with 1) a monotonically increasing or decreasing relationship.</p>
<ol type="1">
<li><strong>Linearity</strong> and <strong>Monotonicity</strong>. A visual inspection of a scatterplot should find a linear relationship (Pearson) or monotonic relationship (Spearman and Kendall).</li>
</ol>
<p>Pearson’s correlation additionall requires</p>
<ol start="2" type="1">
<li><strong>No Outliers</strong>. Identify outliers with the scatterplot.</li>
<li><strong>Normality</strong>. Bivariate normality is difficult to assess. Instead, check that each variable is individually normally distributed. Use the Shapiro-Wilk test.</li>
</ol>
<section id="linearity-monotonicity" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="linearity-monotonicity">Linearity / Monotonicity</h5>
<p>Assess linearity and monotonicity with a scatter plot. <code>dat1</code> is plotted on the left in Figure @ref(fig:ccscatter). A second version that fails the linearity test is shown to the right. If the linear relationship assumption fails, consider transforming the variable instead of reverting to Spearman or Kendall.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>The left scatter plot is <code>dat1</code>. It meets Pearson’s linearity condition. A second version at right illustrates what a failure might look like.</figcaption>
<p><img src="11-association_files/figure-html/ccscatter-1.png" class="img-fluid figure-img" width="720"></p>
</figure>
</div>
</div>
</div>
<p>The ordinal variable data set <code>dat2</code> is plotted in Figure @ref(fig:ooscatter).</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption><code>dat2</code> meets the mononicity assumption for Spearman’s rho and Kendall’s tau.</figcaption>
<p><img src="11-association_files/figure-html/ooscatter-1.png" class="img-fluid figure-img" width="528"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="no-outliers" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="no-outliers">No Outliers</h5>
<p>Pearson’s correlation requires no outliers. Both plots in Figure @ref(fig:ccscatter) are free of outliers. If there were outliers, check whether they are data entry errors or measurement errors and fix or discard them. If the outliers are genuine, leave them in if they do not affect the conclusion. You can also try tranforming the variable. Failing all that, revert to the Spearman’s rho or Kendall’s tau.</p>
</section>
<section id="bivariate-normality" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="bivariate-normality">Bivariate Normality</h5>
<p>Bivariate normality is difficult to assess. If two variables are bivariate normal, they will each be individually normal as well. That’s the best you can hope to check for. Use the Shapiro-Wilk test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(cs<span class="sc">$</span>dat1<span class="sc">$</span>time_tv)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  cs$dat1$time_tv</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## W = 0.97989, p-value = 0.1304</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(cs<span class="sc">$</span>dat1<span class="sc">$</span>cholesterol)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  cs$dat1$cholesterol</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">## W = 0.97594, p-value = 0.06387</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If a variable is not normally distributed, you can transform it, carry on regardless since the Pearson correlation is fairly robust to deviations from normality, or revert to Spearman and Kendall.</p>
</section>
</section>
<section id="test" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="test">Test</h4>
<p>Calculate Pearson’s correlation, Spearman’s rho, or Kendall’s tau. <code>dat</code> meets the assumptions for Pearson’s correlation, but try Spearman’s rho and Kendall’s tau too, just to see how close they come to Pearson. <code>dat2</code> only meets the assumptions for Spearman and Kendall.</p>
<section id="pearsons-correlation" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="pearsons-correlation">Pearson’s Correlation</h5>
<p><code>dat1</code> met the conditions for Pearson’s correlation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>cc_pearson <span class="ot">&lt;-</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(cs<span class="sc">$</span>dat1<span class="sc">$</span>cholesterol, cs<span class="sc">$</span>dat1<span class="sc">$</span>time_tv, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  cs$dat1$cholesterol and cs$dat1$time_tv
t = 3.9542, df = 98, p-value = 0.0001451
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1882387 0.5288295
sample estimates:
      cor 
0.3709418 </code></pre>
</div>
</div>
<p><em>r</em> = 0.37 falls in the range of a “moderate” linear relationship. <span class="math inline">\(r^2\)</span> = 14% is the coefficient of determination. Interpret it as the percent of variability in one variable that is explained by the other. If you are not testing a hypothesis (HO: <span class="math inline">\(\rho \ne 0\)</span>), you can report just report <em>r</em>. Otherwise, include the <em>p</em>-value. Report your results like this:</p>
<blockquote class="blockquote">
<p>A Pearson’s product-moment correlation was run to assess the relationship between cholesterol concentration and daily time spent watching TV in males aged 45 to 65 years. One hundred participants were recruited.</p>
<p>Preliminary analyses showed the relationship to be linear with both variables normally distributed, as assessed by Shapiro-Wilk’s test (p &gt; .05), and there were no outliers.</p>
<p>There was a statistically significant, moderate positive correlation between daily time spent watching TV and cholesterol concentration, <em>r</em>(98) = 0.37, p &lt; .0005, with time spent watching TV explaining 14% of the variation in cholesterol concentration.</p>
</blockquote>
<p>You wouldn’t use Spearman’s rho or Kendall’s tau here since the more precise Pearson’s correlation is available. But just out of curiosity, here are the correlations using those two measures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cs<span class="sc">$</span>dat1<span class="sc">$</span>cholesterol, cs<span class="sc">$</span>dat1<span class="sc">$</span>time_tv, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2383971</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cs<span class="sc">$</span>dat1<span class="sc">$</span>cholesterol, cs<span class="sc">$</span>dat1<span class="sc">$</span>time_tv, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3322122</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Both Kendall and Spearman produced more conservative estimates of the strength of the relationship - Kendall especially so.</p>
<p>You probably wouldn’t use linear regression here either because it describes the linear relationship between a <em>response</em> variable and changes to an independent <em>explanatory</em> variable. Even though we are reluctant to interpret a regression model in terms of causality, that is what is implied the formulation <code>y ~ x</code> and independence assumption in of X. Nevertheless, correlation and regression are related. The slope term in a simple linear regression of the normalized values equals the Pearson correlation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> x, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> cs<span class="sc">$</span>dat1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">scale</span>(cholesterol), <span class="at">x =</span> <span class="fu">scale</span>(time_tv))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = cs$dat1 %&gt;% mutate(y = scale(cholesterol), 
    x = scale(time_tv)))

Coefficients:
(Intercept)            x  
 -3.092e-16    3.709e-01  </code></pre>
</div>
</div>
</section>
<section id="spearmans-rho" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="spearmans-rho">Spearman’s Rho</h5>
<p>Data set <code>dat2</code> did not meet the conditions for Pearson’s correlation, so use Spearman’s rho and/or Kendall’s tau.</p>
<p>Start with Spearman’s rho. Recall that Spearman’s rho is just the Pearson correlation applied to the ranks. Recall also that the Pearson’s correlation is just the covariance divided by the product of the standard deviations. You can quickly calculate it by hand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(<span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income), <span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high)) <span class="sc">/</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">sd</span>(<span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income)) <span class="sc">*</span> <span class="fu">sd</span>(<span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6024641</code></pre>
</div>
</div>
<p>Use the function though. I don’t get why <code>cor.test</code> requires <code>x</code> and <code>y</code> be numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>spearman <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high), </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income), </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  as.numeric(cs$dat2$tax_too_high) and as.numeric(cs$dat2$income)
S = 914.33, p-value = 0.001837
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.6024641 </code></pre>
</div>
</div>
<p>Interpret the statistic using the same rule of thumb as for Pearson’s correlation. A rho over .5 is a strong correlation.</p>
<blockquote class="blockquote">
<p>A Spearman’s rank-order correlation was run to assess the relationship between income level and views towards income taxes in 24 participants. Preliminary analysis showed the relationship to be monotonic, as assessed by visual inspection of a scatterplot. There was a statistically significant, strong positive correlation between income level and views towards income taxes, <span class="math inline">\(r_s\)</span> = 0.602, <em>p</em> = 0.002.</p>
</blockquote>
</section>
<section id="kendalls-tau" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="kendalls-tau">Kendall’s Tau</h5>
<p>Recall that Kendall’s tau is a function of concordant (C), discordant (D) and tied (Tx and Ty) pairs of observations. The manual calculation is a little more involved. Here is the function instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>kendall <span class="ot">&lt;-</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high), </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  as.numeric(cs$dat2$tax_too_high) and as.numeric(cs$dat2$income)
z = 2.9686, p-value = 0.002991
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau 
0.5345225 </code></pre>
</div>
</div>
<p>As with the case study on cholesterol and television, Kendall’s tau was more conservative than Spearman’s rho. <span class="math inline">\(\tau_b\)</span> = 0.535 is still in the “strong” range, though just barely.</p>
<blockquote class="blockquote">
<p>A Kendall’s tau-b correlation was run to assess the relationship between income level and views towards income taxes amongst 24 participants. Preliminary analysis showed the relationship to be monotonic, as assessed by visual inspection of a scatterplot. There was a statistically significant, strong positive correlation between income level and the view that taxes were too high, <span class="math inline">\(\tau_b\)</span> = 0.535, <em>p</em> = 0.003.</p>
</blockquote>
</section>
</section>
</section>
<section id="chisq-independence" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="chisq-independence"><span class="header-section-number">11.5</span> Chi-Square Test of Independence</h2>
<p>The <strong>chi-square test of independence</strong> tests whether two categorical variables are associated, or are instead <em>independent</em><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. It tests whether the observed joint frequency counts <span class="math inline">\(O_{ij}\)</span> differ from expected frequency counts <span class="math inline">\(E_{ij}\)</span> under the <em>independence model</em> (the model of independent explanatory variables, <span class="math inline">\(\pi_{ij} = \pi_{i+} \pi_{+j}\)</span>. The null hypothesis is <span class="math inline">\(O_{ij} = E_{ij}\)</span>. The test assumes the two variables are independent<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> and that all cell counts are at least 5.</p>
<p>Choose from two test statistics, Pearson <span class="math inline">\(X^2\)</span> (and the continuity adjusted <span class="math inline">\(X^2\)</span>), and deviance <em>G</em>. As <span class="math inline">\(n \rightarrow \infty\)</span> their sampling distributions approach <span class="math inline">\(\chi^2(df)\)</span> with degrees of freedom (df) equal to the saturated model df <span class="math inline">\(I \times J - 1\)</span> minus the independence model df <span class="math inline">\((I - 1) + (J - 1)\)</span>, which you can algebraically solve for <span class="math inline">\(df = (I - 1)(J - 1)\)</span>.</p>
<p>The Pearson goodness-of-fit statistic is</p>
<p><span class="math display">\[X^2 = \sum \frac{(O_{ij} - E_{ij})^2}{E_{ij}}\]</span></p>
<p>where <span class="math inline">\(O_{ij}\)</span> is the observed count, and <span class="math inline">\(E_{ij}\)</span> is the product of the row and column marginal probabilities. The deviance statistic is</p>
<p><span class="math display">\[G = 2 \sum_{ij} O_{ij} \log \left( \frac{O_{ij}}{E_{ij}} \right)\]</span></p>
<p><span class="math inline">\(X^2\)</span> and <em>G</em> increase with the disagreement between the saturated model proportions <span class="math inline">\(p_{ij}\)</span> and the independence model proportions <span class="math inline">\(\pi_{ij}\)</span>.</p>
</section>
<section id="fisher-exact" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="fisher-exact"><span class="header-section-number">11.6</span> Fisher’s Exact Test</h2>
<p>Whereas the chi-squared and <em>G</em>-test rely on the approximation that the test statistic distribution approaches <span class="math inline">\(\chi^2\)</span> as <span class="math inline">\(n \rightarrow \infty\)</span>, Fisher’s exact test is an “exact test” in that the <em>p</em>-value is calculated exactly from the <a href="https://bookdown.org/mpfoley1973/probability/hypergeometric.html">hypergeometric distribution</a>. Therefore Fisher’s test <em>should</em> only apply only to 2 x 2 tables. For some reason, it doesn’t.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>The test assumes the row totals <span class="math inline">\(n_{i+}\)</span> and the column totals <span class="math inline">\(n_{+j}\)</span> are fixed by study design, and the expected values of at least 20% of cells in the table have expected cell count &gt;5, and no expected cell count is 0.</p>
<p>The famous example of the Fisher exact test is the “Lady tea testing” example. A lady claims she can guess whether the milk was poured into the cup before or after the tea. The experiment consists of 8 cups, 4 with milk poured first, 4 with milk poured second. The lady guesses correctly in 6 of the 8 cups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(tea <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">Guess =</span> <span class="fu">c</span>(<span class="st">"Milk"</span>, <span class="st">"Tea"</span>),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Truth =</span> <span class="fu">c</span>(<span class="st">"Milk"</span>, <span class="st">"Tea"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Truth
Guess  Milk Tea
  Milk    3   1
  Tea     1   3</code></pre>
</div>
</div>
<p>This is a hypergeometric distribution question because you want to know the probability of 3 or 4 successes in a sample of 4. If <span class="math inline">\(X = k\)</span> is the count of successful events in a sample of size <span class="math inline">\(n\)</span> <em>without replacement</em> from a population of size <span class="math inline">\(N\)</span> containing <span class="math inline">\(K\)</span> successes, then <span class="math inline">\(X\)</span> is a random variable with a hypergeometric distribution</p>
<p><span class="math display">\[f_X(k|N, K, n) = \frac{{{K}\choose{k}}{{N-K}\choose{n-k}}}{{N}\choose{n}}.\]</span></p>
<p>The formula follows from the frequency table of the possible outcomes. <span class="math inline">\({K}\choose{k}\)</span> is the number of ways to get <em>k</em> successes in <em>K</em> draws. <span class="math inline">\({N-K}\choose{n-k}\)</span> is the number of ways to fail to get <em>k</em> successes in <em>K</em> draws. And the denominator <span class="math inline">\({N}\choose{n}\)</span> is the total of all ways to succeed and fail.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">`</span><span class="at"> </span><span class="st">`</span>, <span class="sc">~</span>Sampled, <span class="sc">~</span><span class="st">`</span><span class="at">Not Sampled</span><span class="st">`</span>,  <span class="sc">~</span>Total,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"success"</span>, <span class="st">"k"</span>, <span class="st">"K-k"</span>, <span class="st">"K"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"non-success"</span>, <span class="st">"n-k"</span>, <span class="st">"(N-K)-(n-k)"</span>, <span class="st">"N-K"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Total"</span>, <span class="st">"n"</span>, <span class="st">"N-n"</span>, <span class="st">"N"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">autofit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid tabwid_left"><style>.cl-7ce935ee{}.cl-7ce08afc{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7ce08b1a{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7ce4443a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7ce464b0{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464ba{width:0.864in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464bb{width:1.134in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464bc{width:0.617in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464d8{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464d9{width:0.864in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464e2{width:1.134in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464e3{width:0.617in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464e4{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464ec{width:0.864in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464ed{width:1.134in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce464f6{width:0.617in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce4650a{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce4650b{width:0.864in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce4650c{width:1.134in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7ce46528{width:0.617in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7ce935ee"><thead><tr style="overflow-wrap:break-word;"><th class="cl-7ce464b0"><p class="cl-7ce4443a"><span class="cl-7ce08afc"> </span></p></th><th class="cl-7ce464ba"><p class="cl-7ce4443a"><span class="cl-7ce08afc">Sampled</span></p></th><th class="cl-7ce464bb"><p class="cl-7ce4443a"><span class="cl-7ce08afc">Not Sampled</span></p></th><th class="cl-7ce464bc"><p class="cl-7ce4443a"><span class="cl-7ce08afc">Total</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7ce464d8"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">success</span></p></td><td class="cl-7ce464d9"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">k</span></p></td><td class="cl-7ce464e2"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">K-k</span></p></td><td class="cl-7ce464e3"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">K</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7ce464e4"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">non-success</span></p></td><td class="cl-7ce464ec"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">n-k</span></p></td><td class="cl-7ce464ed"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">(N-K)-(n-k)</span></p></td><td class="cl-7ce464f6"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">N-K</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7ce4650a"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">Total</span></p></td><td class="cl-7ce4650b"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">n</span></p></td><td class="cl-7ce4650c"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">N-n</span></p></td><td class="cl-7ce46528"><p class="cl-7ce4443a"><span class="cl-7ce08b1a">N</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Function <code>choose()</code> returns the binomial coefficient <span class="math inline">\({{n}\choose{k}} = \frac{n!}{k!(n-k)!}\)</span>. The probability of choosing correctly at least 3 times out of 4 is the number of combinations of <em>k</em> = 3 plus the number with <em>k</em> = 4 divided by the number of combinations of <em>any</em> outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>; n <span class="ot">&lt;-</span> <span class="dv">4</span>; K <span class="ot">&lt;-</span> <span class="dv">4</span>; N <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(K, k) <span class="sc">*</span> <span class="fu">choose</span>(N<span class="sc">-</span>K, n<span class="sc">-</span>k) <span class="sc">/</span> <span class="fu">choose</span>(N, n) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(K, k<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">choose</span>(N<span class="sc">-</span>K, n<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">/</span> <span class="fu">choose</span>(N, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2428571</code></pre>
</div>
</div>
<p><code>phyper()</code> does this.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(pi <span class="ot">&lt;-</span> <span class="fu">phyper</span>(<span class="at">q =</span> k<span class="dv">-1</span>, <span class="at">m =</span> K, <span class="at">n =</span> N<span class="sc">-</span>K, <span class="at">k =</span> n, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2428571</code></pre>
</div>
</div>
<p>The <em>p</em>-value from Fisher’s exact test is calculated this way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(tea, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  tea
p-value = 0.2429
alternative hypothesis: true odds ratio is greater than 1
95 percent confidence interval:
 0.3135693       Inf
sample estimates:
odds ratio 
  6.408309 </code></pre>
</div>
</div>
<p>The odds ratio at the bottom is the odds of success divided by the odds of non-success. The sample odds ratio is (3/1) / (1/3) = 9, but the documentation for <code>fisher.test()</code> explains that this it calculates the <em>conditional maximum likelihood estimate</em>.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
</section>
<section id="case-study-chi-square-fisher" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="case-study-chi-square-fisher"><span class="header-section-number">11.7</span> Case Study: Chi-Square, Fisher</h2>
<p>A researcher investigates whether males and females enrolled in an Exercise Science degree course differ in the type of exercise then engage, competitive or non-competitive. They survey 25 males and 25 females.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cs<span class="sc">$</span>or2x2 <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"row"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(comp <span class="sc">~</span> <span class="st">"Competitive"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">add_p</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="argwarhnrr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#argwarhnrr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#argwarhnrr thead, #argwarhnrr tbody, #argwarhnrr tfoot, #argwarhnrr tr, #argwarhnrr td, #argwarhnrr th {
  border-style: none;
}

#argwarhnrr p {
  margin: 0;
  padding: 0;
}

#argwarhnrr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#argwarhnrr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#argwarhnrr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#argwarhnrr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#argwarhnrr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#argwarhnrr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#argwarhnrr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#argwarhnrr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#argwarhnrr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#argwarhnrr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#argwarhnrr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#argwarhnrr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#argwarhnrr .gt_spanner_row {
  border-bottom-style: hidden;
}

#argwarhnrr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#argwarhnrr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#argwarhnrr .gt_from_md > :first-child {
  margin-top: 0;
}

#argwarhnrr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#argwarhnrr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#argwarhnrr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#argwarhnrr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#argwarhnrr .gt_row_group_first td {
  border-top-width: 2px;
}

#argwarhnrr .gt_row_group_first th {
  border-top-width: 2px;
}

#argwarhnrr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#argwarhnrr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#argwarhnrr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#argwarhnrr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#argwarhnrr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#argwarhnrr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#argwarhnrr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#argwarhnrr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#argwarhnrr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#argwarhnrr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#argwarhnrr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#argwarhnrr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#argwarhnrr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#argwarhnrr .gt_left {
  text-align: left;
}

#argwarhnrr .gt_center {
  text-align: center;
}

#argwarhnrr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#argwarhnrr .gt_font_normal {
  font-weight: normal;
}

#argwarhnrr .gt_font_bold {
  font-weight: bold;
}

#argwarhnrr .gt_font_italic {
  font-style: italic;
}

#argwarhnrr .gt_super {
  font-size: 65%;
}

#argwarhnrr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#argwarhnrr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#argwarhnrr .gt_indent_1 {
  text-indent: 5px;
}

#argwarhnrr .gt_indent_2 {
  text-indent: 10px;
}

#argwarhnrr .gt_indent_3 {
  text-indent: 15px;
}

#argwarhnrr .gt_indent_4 {
  text-indent: 20px;
}

#argwarhnrr .gt_indent_5 {
  text-indent: 25px;
}

#argwarhnrr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#argwarhnrr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="2" id="<div data-qmd-base64=&quot;Q29tcGV0aXRpdmU=&quot;><div class='gt_from_md'><p>Competitive</p>
</div></div>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"></span>
<p>Competitive</p>
</th>
<th rowspan="2" id="<div data-qmd-base64=&quot;VG90YWw=&quot;><div class='gt_from_md'><p>Total</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Total</p></th>
<th rowspan="2" id="<div data-qmd-base64=&quot;cC12YWx1ZQ==&quot;><div class='gt_from_md'><p>p-value</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>p-value</p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="<div data-qmd-base64=&quot;WWVz&quot;><div class='gt_from_md'><p>Yes</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Yes</p></th>
<th id="<div data-qmd-base64=&quot;Tm8=&quot;><div class='gt_from_md'><p>No</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>No</p></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">gender</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.023</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Male</td>
<td class="gt_row gt_center" headers="stat_1">18 (72%)</td>
<td class="gt_row gt_center" headers="stat_2">7 (28%)</td>
<td class="gt_row gt_center" headers="stat_0">25 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Female</td>
<td class="gt_row gt_center" headers="stat_1">10 (40%)</td>
<td class="gt_row gt_center" headers="stat_2">15 (60%)</td>
<td class="gt_row gt_center" headers="stat_0">25 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Total</td>
<td class="gt_row gt_center" headers="stat_1">28 (56%)</td>
<td class="gt_row gt_center" headers="stat_2">22 (44%)</td>
<td class="gt_row gt_center" headers="stat_0">50 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
<p>Pearson’s Chi-squared test</p></td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<section id="conditions-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conditions-1">Conditions</h4>
<p>Use the Chi-Square test of independence for nominal, independent variables. The test requires all cell counts to be greater than 5. If your data does not meet this condition, consider collapsing some levels. If you collapse all the way to a 2 x 2 cross-tabulation and still do not have at least 5 counts per cell, use Fisher’s exact test.</p>
<p>Use Fisher’s exact test for <em>dichotomous</em> nominal, independent variables. The test is valid for <em>cross-sectional</em> samples, but not for prospective or retrospective samples.</p>
</section>
<section id="test-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="test-1">Test</h4>
<section id="chi-square" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="chi-square">Chi-Square</h5>
<p>To see what’s going on, here is chi-square test done by hand. The expected values are the joint probabilities from the independence model (e.g., <span class="math inline">\(E(\mathrm{male}, {\mathrm{yes}}) = \pi_{\mathrm{male}} \times \pi_{\mathrm{yes}} \times n\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>exer_table <span class="ot">&lt;-</span> cs<span class="sc">$</span>or2x2 <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">marginSums</span>(exer_table, <span class="dv">1</span>) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">marginSums</span>(exer_table, <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sum</span>(exer_table)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>(X2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((exer_table <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5.194805</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>(df <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(X2, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.02265449</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And the <em>G</em> test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(G <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(exer_table <span class="sc">*</span> <span class="fu">log</span>(exer_table <span class="sc">/</span> expected)))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5.294731</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(G, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.02139004</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>chisq.test()</code> function applies the Yates continuity correction by default to correct for situations with small cell counts. The Yates continuity correction subtracts 0.5 from the <span class="math inline">\(O_{ij} - E_{ij}\)</span> differences. Set <code>correct = FALSE</code> to suppress Yates. The Yates continuity correction only applies to 2 x 2 tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_chisq.test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(exer_table, <span class="at">correct =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  exer_table
X-squared = 5.1948, df = 1, p-value = 0.02265</code></pre>
</div>
</div>
<p>Calculate the <em>G</em> test with <code>DescTools::GTest()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_g.test <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">GTest</span>(exer_table, <span class="at">correct =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Log likelihood ratio (G-test) test of independence without correction

data:  exer_table
G = 5.2947, X-squared df = 1, p-value = 0.02139</code></pre>
</div>
</div>
<p>As a side note, if the cell size &gt;5 condition is violated, you can use Monte Carlo simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(exer_table, <span class="at">correct =</span> <span class="cn">FALSE</span>, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with simulated p-value (based on 2000
    replicates)

data:  exer_table
X-squared = 5.1948, df = NA, p-value = 0.04498</code></pre>
</div>
</div>
</section>
<section id="fisher" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="fisher">Fisher</h5>
<p>The documentation for <code>fisher.test()</code> explains that the <em>p</em>-value is based on the the first element of the contingency table “<em>with non-centrality parameter given by the odds ratio.</em>” I don’t understand the odds ratio business and cannot figure out how it is calculated. It says in the documentation for the <code>estimate</code> value that “<em>Note that the conditional Maximum Likelihood Estimate (MLE) rather than the unconditional MLE (the sample odds ratio) is used.</em>”, so that may hold the answer.</p>
<p>At least the <em>p</em>-value I can calculate by hand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">phyper</span>(<span class="at">q =</span> exer_table[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>,  <span class="co"># k minus 1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">m =</span> <span class="fu">sum</span>(exer_table[<span class="dv">1</span>, ]),  <span class="co"># K</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">n =</span> <span class="fu">sum</span>(exer_table[<span class="dv">2</span>, ]),  <span class="co"># N - K</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">k =</span> <span class="fu">sum</span>(exer_table[, <span class="dv">1</span>]),  <span class="co"># n</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04500454</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_fisher.test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(exer_table))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  exer_table
p-value = 0.045
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  1.02531 15.01800
sample estimates:
odds ratio 
   3.74678 </code></pre>
</div>
</div>
</section>
<section id="post-test-phi-cramers-v" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="post-test-phi-cramers-v">Post-Test: Phi, Cramer’s V</h5>
<p>The problem with the chi-square test for association is that it does not measure the <em>strength</em> of any association. Two measures of associate are often calculated after the chi-squared or Fisher tests.</p>
<p>Cramer’s V is derived from the chi-square statistic. It restricts the statistic to a range of 0 to 1. <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> Values under .1 are considered poor evidence of association; &gt;.2 are “moderately strong” evidence.</p>
<p><span class="math display">\[V = \sqrt{\frac{\chi^2 / n}{\mathrm{min}(I, J) - 1}}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by hand</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(cs<span class="sc">$</span>or2x2_chisq.test<span class="sc">$</span>statistic <span class="sc">/</span> <span class="fu">sum</span>(exer_table) <span class="sc">/</span> (<span class="fu">min</span>(<span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="do">## X-squared </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.3223292</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from package</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_v <span class="ot">&lt;-</span> rcompanion<span class="sc">::</span><span class="fu">cramerV</span>(exer_table))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Cramer V </span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.3223</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Phi Coefficient is defined</p>
<p><span class="math display">\[\Phi = \sqrt{\frac{AD-BC}{(A+B)(C+D)(A+C)(B+D)}}\]</span></p>
<p>where A, B, C, and D are the four values of the 2 x 2 contingency table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"D"</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] "A"  "B" 
[2,] "C"  "D" </code></pre>
</div>
</div>
<p>Similar to a Pearson Correlation Coefficient, a Phi Coefficient takes on values between -1 and 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by hand</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(<span class="fu">matrix</span>(exer_table, <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">/</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">marginSums</span>(exer_table, <span class="dv">1</span>), <span class="fu">marginSums</span>(exer_table, <span class="dv">2</span>))))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3223292</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from package</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_phi <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">phi</span>(exer_table))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reporting" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="reporting">Reporting</h5>
<blockquote class="blockquote">
<p>A chi-square test for association was conducted between gender and preference for performing competitive sport. All expected cell frequencies were greater than five. There was a statistically significant association between gender and preference for performing competitive sport, (<span class="math inline">\(X^2\)</span>(1) = 5.195, <em>p</em> = 0.023. There was a moderately strong association between gender and preference for performing competitive sport, <em>V</em> = 0.322.</p>
</blockquote>
<blockquote class="blockquote">
<p>A Fisher’s Exact test was conducted between gender and preference for performing competitive sport. There was a statistically significant association between gender and preference for performing competitive sport, <em>p</em> = 0.045.</p>
</blockquote>
</section>
</section>
</section>
<section id="kruskals-lambda" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="kruskals-lambda"><span class="header-section-number">11.8</span> Kruskal’s Lambda</h2>
</section>
<section id="relative-risk" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="relative-risk"><span class="header-section-number">11.9</span> Relative Risk</h2>
</section>
<section id="odds-ratio" class="level2" data-number="11.10">
<h2 data-number="11.10" class="anchored" data-anchor-id="odds-ratio"><span class="header-section-number">11.10</span> Odds Ratio</h2>
<p>Calculate relative risks for <em>dichotomous</em> nominal, independent variables when one variable is independent, the other dependent. Relative risks are valid for <em>prospective</em> and <em>retrospective cohort designs</em>, <em>randomized controlled trials (RCTs)</em>, and some types of <em>cross-sectional studies</em>, but not with case-control studies.</p>
<p>Calculate odds ratios as an alternative to relative risk. It makes the same assumptions. Unlike relative risk, it is valid for <em>all</em> study designs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cs<span class="sc">$</span>or2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking vs Lung Cancer</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://statistics.laerd.com/premium/spss/rr2x2/relative-risk-2x2-in-spss.php</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>cs<span class="sc">$</span>rr2x2 <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"./input/relative-risk-2x2-individual-scores.sav"</span>, </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">to.data.frame =</span> <span class="cn">TRUE</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="partial-correlation" class="level2" data-number="11.11">
<h2 data-number="11.11" class="anchored" data-anchor-id="partial-correlation"><span class="header-section-number">11.11</span> Partial Correlation</h2>
<p>The <em>partial correlation</em> of <span class="math inline">\(\textbf{Y}_j\)</span> and <span class="math inline">\(\textbf{Y}_k\)</span> is their correlation <em>conditioned on sampling from a sub-population of</em> <span class="math inline">\(X\)</span>. Express the sub-population as <span class="math inline">\(\textbf{Z} = \begin{pmatrix}\textbf{X}_1 \\ \textbf{X}_2 \end{pmatrix}\)</span> with partitioned mean vector <span class="math inline">\(\boldsymbol{\bar{x}} = \begin{pmatrix}\boldsymbol{\bar{x}}_1 \\ \boldsymbol{\bar{x}}_2 \end{pmatrix}\)</span>. The variance-covariance matrix is complicated by the covariances between <span class="math inline">\(\textbf{X}_1\)</span> and <span class="math inline">\(\textbf{X}_1\)</span>, so the partition is a <em>matrix of matrices</em>, <span class="math inline">\(\boldsymbol{S} = \begin{pmatrix} \boldsymbol{S}_{11} &amp; \boldsymbol{S}_{12} \\ \boldsymbol{S}_{21} &amp; \boldsymbol{S}_{22} \end{pmatrix}\)</span>. <span class="math inline">\(\boldsymbol{S}_{11}\)</span> and <span class="math inline">\(\boldsymbol{S}_{22}\)</span> are the variance-covariance matrices of <span class="math inline">\(\textbf{X}_1\)</span> and <span class="math inline">\(\textbf{X}_2\)</span>, and <span class="math inline">\(\boldsymbol{S}_{12}\)</span> and <span class="math inline">\(\boldsymbol{S}_{21}\)</span> are the (identical) variance-covariance matrices between the variables in <span class="math inline">\(\textbf{X}_1\)</span> and the variables in <span class="math inline">\(\textbf{X}_2\)</span>.</p>
<p>Partitioning means you can express the mean, (<span class="math inline">\(\textbf{M}\)</span>, and variance-covariance matrix, <span class="math inline">\(\textbf{CV}\)</span> of <span class="math inline">\(Y\)</span> <em>conditioned</em> on <span class="math inline">\(\textbf{X} = \textbf{x}_2\)</span>.</p>
<p><span class="math display">\[
\begin{equation}
\textbf{M} = \boldsymbol{\bar{x}}_1 + \boldsymbol{S}_{12} \boldsymbol{S}_{22}^{-1} (\textbf{x}_2 - \boldsymbol{\bar{x}}_2)
\end{equation}
\]</span></p>
<p><span class="math display">\[
\begin{equation}
\textbf{CV} = \boldsymbol{S}_{11} - \boldsymbol{S}_{12} \boldsymbol{S}_{22}^{-1} \boldsymbol{S}_{21}
\end{equation}
(\#eq:s06-cond-cov)
\]</span></p>
<p>To see what this means, consider the bi-variate case. Suppose height and weight are distributed <span class="math inline">\(\mu = \begin{pmatrix} 175 \\ 71 \end{pmatrix}\)</span> with variance-covariance matrix <span class="math inline">\(\boldsymbol{\Sigma} = \begin{pmatrix} 550 &amp; 40 \\ 40 &amp; 8 \end{pmatrix}\)</span>. The mean of height, <span class="math inline">\(Y\)</span> given weight <span class="math inline">\(\textbf{X} = \textbf{x}_2\)</span> is <span class="math inline">\(\textbf{M}_{\textbf{Y.x}} = 175 + \frac{40}{8} (x_2 - 71)\)</span>. The variance is <span class="math inline">\(\textbf{v}_{\textbf{Y.x}} = 550 = \frac{40^2}{8}\)</span> (a constant).</p>
<p>The conditional mean of <span class="math inline">\(\textbf{Y}\)</span> given <span class="math inline">\(\textbf{X} = \textbf{x}\)</span> is <span class="math inline">\(\mu_{\textbf{Y.x}} = E(\textbf{Y|X=x})\)</span>. If the distribution is multivariate normal, then the conditional mean equals its overall mean plus an adjustment based how <span class="math inline">\(\textbf{Y}\)</span> varies with <span class="math inline">\(\textbf{X}\)</span> as a fraction of the variation of <span class="math inline">\(\textbf{X}\)</span> multiplied by the distance of <span class="math inline">\(\textbf{X}\)</span> from its mean.</p>
<p><span class="math display">\[
\begin{equation}
\mu_{\textbf{Y.x}} = E(\textbf{Y|X=x}) = \mu_\textbf{Y} + \boldsymbol{\Sigma}_\textbf{YX} \boldsymbol{\Sigma}_\textbf{X}^{-1} (\textbf{x} - \boldsymbol{\mu}_\textbf{X})
\end{equation}
(\#eq:s06-conditional-mean)
\]</span></p>
<p>Note how if <span class="math inline">\(\textbf{x} = \boldsymbol{\mu}_\textbf{X}\)</span> the conditional mean equals the overall mean. If the <span class="math inline">\(\textbf{X}\)</span>’s are generally positively correlated with the <span class="math inline">\(\textbf{Y}\)</span>’s, then <span class="math inline">\(\textbf{x} &gt; \boldsymbol{\mu}_\textbf{X}\)</span> results in a positive adjustment, and vice-versa.</p>
<p>https://online.stat.psu.edu/stat505/lesson/6/6.1</p>
<p>The conditional variance is <span class="math inline">\(\sigma_{\textbf{Y.x}}^2 =E\{ (\textbf{Y} - \boldsymbol{\mu}_{\textbf{Y.x}})^2 | \textbf{X = x} \}\)</span>. The conditional covariance between <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(Y_j\)</span> is <span class="math inline">\(\sigma_{i,j.\textbf{x}} =E\{ (Y_i - \mu_{Y_i.x})(Y_j - \mu_{Y_j.x}) | \textbf{X = x} \}\)</span>. The variances and covariances can be collected into a variance-covariance matrix.</p>
<p><span class="math display">\[
\boldsymbol{\Sigma}_{\textbf{Y}.\textbf{x}} = \begin{pmatrix}
\sigma_{Y_{1}.\textbf{X}} &amp; \sigma_{12.\textbf{X}} &amp; \cdots &amp; \sigma_{1p.\textbf{X}} \\
\sigma_{21.\textbf{X}} &amp; \sigma_{Y_{2}.\textbf{X}} &amp; \cdots &amp; \sigma_{2p.\textbf{X}} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\sigma_{p1.\textbf{X}} &amp; \sigma_{p2.\textbf{X}} &amp; \cdots &amp; \sigma_{Y_{p}.\textbf{X}}
\end{pmatrix}
\]</span></p>
<p>Divide the covariance of two variables by the product of their standard deviations to get the <em>unconditional correlation</em>, <span class="math inline">\(r_{jk} = \frac{s_{jk}}{s_j s_k}\)</span>. <span class="math inline">\(r_{jk}\)</span> estimates the population correlation, <span class="math inline">\(\rho_{jk} = \frac{\sigma_{jk}}{\sigma_j \sigma_k}\)</span>. The <em>partial correlation</em> is <span class="math inline">\(\rho_{jk.\textbf{X}} = \frac{\sigma_{jk.\textbf{X}}}{\sigma_{Y_j.\textbf{X}} \sigma_{Y_k.\textbf{X}}}\)</span></p>
<p>Test the null hypothesis that <span class="math inline">\(H_0: \rho_{jk} = 0\)</span> with a <em>t</em>-test where</p>
<p><span class="math display">\[
t = r_{jk}\sqrt{\frac{n-2}{1-r_{jk}^2}}
\]</span></p>
<p>is distributed with <span class="math inline">\(n - 2\)</span> degrees of freedom. The 95% CI is complicated by the [-1, 1] bounding of the data which creates skew. The 95% CI is formed from the <em>Fisher transformation</em> of the data,</p>
<p><span class="math display">\[
z_{jk} = \frac{1}{2} \log \frac{1 + r_{jk}}{1 - r_{jk}}
\]</span></p>
<p><span class="math inline">\(z_{jk}\)</span> is distributed normally with variance <span class="math inline">\(\frac{1}{n - 3}\)</span>.</p>
<p><strong>Quick Example</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 37x5 data set from [PSU STAT 505](https://online.stat.psu.edu/stat505/lesson/4/4.7).</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>wechsler <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_fwf</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"./input/wechsler.txt"</span>, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_positions =</span> readr<span class="sc">::</span><span class="fu">fwf_widths</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"Information"</span>, <span class="st">"Similarities"</span>, <span class="st">"Arithmetic"</span>, <span class="st">"PictureCompletion"</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between Information and Similarities</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(wechsler<span class="sc">$</span>Information, wechsler<span class="sc">$</span>Similarities)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.7715297</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># t.test with 95% CI.</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(wechsler<span class="sc">$</span>Information, wechsler<span class="sc">$</span>Similarities)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  Pearson's product-moment correlation</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  wechsler$Information and wechsler$Similarities</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="do">## t = 7.1746, df = 35, p-value = 2.277e-08</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 95 percent confidence interval:</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.5966733 0.8764458</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="do">##       cor </span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.7715297</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sum of the diagonal of any square matrix is called the <em>trace</em>. The trace of the covariance matrix is a single number that expresses the total dispersion of the data set.</p>
<p><span class="math display">\[\mathrm{Trace}(S) = \sum_p S_{pp}\]</span></p>
<p>The trace has the shortcoming of not taking the variable correlations into account. A data set can have a large trace, but really high correlations. Instead, the <em>generalized variance</em> expresses total variation with the <em>determinant</em>.</p>
<p><span class="math display">\[|S| = \sum_{j = 1}^p (-1)^{j+1} b_{1j} |B_{1j}|\]</span></p>
<p>Build your intuition with the bivariate case. If variables <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> have a multivariate normal distribution, the conditional distribution of <span class="math inline">\(Y|X = x\)</span> is normal with mean <span class="math inline">\(\mu_Y + \frac{\sigma_{YX}}{\sigma_{XX}}(x - \mu_X)\)</span> and variance <span class="math inline">\(\sigma_{YY} - \frac{\sigma_{YX}^2}{\sigma_{XX}}\)</span>. For example, suppose <span class="math inline">\(Y\)</span> = height (in) and <span class="math inline">\(X\)</span> = weight (lbs) are distributed <span class="math inline">\(\mu = \begin{pmatrix}175 \\ 71 \end{pmatrix}\)</span> with variance-covariance matrix <span class="math inline">\(\boldsymbol{\Sigma} = \begin{pmatrix} 550 &amp; 40 \\ 40 &amp; 8 \end{pmatrix}\)</span>. Conditioning on <span class="math inline">\(X = x\)</span>, <span class="math inline">\(\mu_{Y.x} = 175 + \frac{40}{8}(x - 71)\)</span> and <span class="math inline">\(\sigma_{Y.x} = 550 - \frac{40^2}{8}\)</span>.</p>
<p>Extend this to the multivariate case. Let <span class="math inline">\(\textbf{Y}\)</span> be a set of outcomes (e.g., blood pressure and cholesterol) and <span class="math inline">\(\textbf{X}\)</span> be a set of conditioning variables (e.g., age, height, and weight). The multivariate conditional mean, <span class="math inline">\(\mu_{\textbf{Y}.\textbf{x}}\)</span>, is</p>
<p><span class="math display">\[
\begin{equation}
E(\textbf{Y} | \textbf{X} = \textbf{x}) = \mu_{\textbf{Y}} + \boldsymbol{\Sigma}_{\textbf{YX}} \boldsymbol{\Sigma}_\textbf{X}^{-1}(\textbf{x} - \boldsymbol{\mu}_\textbf{X})
(\#eq:multivariate-conditional-mean)
\end{equation}
\]</span></p>
<p>The multivariate conditional variance-covariance matrix of <span class="math inline">\(\textbf{Y}\)</span>, <span class="math inline">\(\Sigma_{\textbf{Y}.\textbf{x}}\)</span>, is</p>
<p><span class="math display">\[
\begin{equation}
E(\textbf{Y} | \textbf{X} = \textbf{x}) = \mu_{\textbf{Y}} + \boldsymbol{\Sigma}_{\textbf{YX}} \boldsymbol{\Sigma}_\textbf{X}^{-1}(\textbf{x} - \boldsymbol{\mu}_\textbf{X})
(\#eq:multivariate-conditional-mean)
\end{equation}
\]</span></p>
<p>the mean of a set of outcomes, <span class="math inline">\(\textbf{Y}\)</span> (e.g., blood pressure and cholesterol) conditioned on a set of attributes, <span class="math inline">\(\textbf{X}\)</span> (e.g., age, height, and weight). Denote it as . Denote the conditional variance as <span class="math inline">\(\sigma_{\textbf{Y}.x}^2 = \text{var}(\textbf{Y}|\textbf{X}=\textbf{x})\)</span>. It is equal to conditional squared difference from the mean, <span class="math inline">\(E\{(\textbf{Y} - \boldsymbol{\mu}_{\textbf{Y}.\textbf{x}})^2|\textbf{X} = \textbf{x}\}\)</span>. Any two variables, <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(Y_j\)</span> have a conditional covariance <span class="math inline">\(\sigma_{i,j.\textbf{x}} = \text{cov}(Y_i,Y_j|\textbf{X} = \textbf{x})\)</span>. It is equal to <span class="math inline">\(E\{ (Y_i - \mu_{Y_{i.x}}) (Y_j - \mu_{Y_{j.x}}) | \textbf{X} = \textbf{x}\}\)</span>. The set of all covariances is a matrix.</p>


<!-- -->

</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>See https://www.statology.org/correlation-between-categorical-variables/<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The test is sometimes call the chi-square test for <em>association</em>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Independence is usually true by assumption and/or construction. It can be violated by, for example, a sample that includes spouses where one spouse’s status (e.g., preference for a vacation destination) may be related to the other spouse’s status.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>It doesn’t apply to just 2 x 2, so I need to figure out why.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>k-1 because it returns the probability of &gt;k and we want &gt;=k).<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>I don’t really know what that means. <a href="https://machinelearningmastery.com/what-is-maximum-likelihood-estimation-in-machine-learning/">Brownlee</a> might help.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><a href="https://methods.sagepub.com/base/download/DatasetStudentGuide/cramers-v-lfsp-2015-r">This tutorial</a> says both variables should have more than two levels, but doesn’t explain why.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./10-binomial-multinomial-pairwise.html" class="pagination-link" aria-label="Pairwise Discrete ~ Multinomial">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Pairwise Discrete ~ Multinomial</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12-matrix-algebra.html" class="pagination-link" aria-label="Matrix Algebra">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix Algebra</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb43" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Association</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="in">library(gtsummary)</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(foreign)</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="in">library(janitor)</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>Tests of association assess the strength of association between two variables. There are many variations on this theme.</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Pearson's correlation</span><span class="co">](#pearson)</span> assesses the strength of a linear relationship between two continuous variables. It applies when the relationship is linear with no outliers and the variables are bi-variate normal. There are two less restrictive alternatives, <span class="co">[</span><span class="ot">Spearman's rho</span><span class="co">](#spearman)</span> and <span class="co">[</span><span class="ot">Kendall's tau</span><span class="co">](#kendall)</span>, that assess the strength and direction of association.</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>A two-way frequency table is a frequency table for *two* categorical variables. You usually construct a two-way table to test whether the frequency counts in one categorical variable differ from the other categorical variable using the [chi-square test for independence or G-test](#chisq-independence), or [Fisher's exact test](#fisher-exact).  If there is a significant difference (i.e., the variables are related), then describe the relationship with an analysis of the residuals, calculations of measures of association (difference in proportions, **Phi** and **Cramer's V**, **Relative risks**, or **Odds Ratio**), and partition tests. </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>If one of the variables is bivariate categorical, use **point-biserial correlation**, a special case of Pearson's correlation. **Pearson's partial correlation** controls for one or more variables - linear regression?</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>If both variables are ordinal, use **Goodman and Kruskal's gamma**. **Somers' d** is an alternative if you want to distinguish between a dependent and independent variable (instead of linear regression?). The **Mantel-Haenszel** test of trend is used to determine whether there is a linear trend (i.e., a linear relationship/association) between two ordinal variables that are represented in a contingency table. The **Cochran-Armitage** test of trend is used to determine whether there is a linear trend (i.e., a linear relationship/association) between an ordinal independent variable and a dichotomous dependent variable.</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>**Goodman and Kruskal's λ** is a nonparametric measure of the strength of association between two nominal variables where a distinction is made between a dependent and independent variable</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>**Loglinear analysis** is used to understand (and model) associations between two or more categorical variables (i.e., nominal or ordinal variables). However, loglinear analysis is usually employed when dealing with three or more categorical variables, as opposed to two variables, where a chi-square test for association is usually conducted instead. </span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>There are three common correlation tests for categorical variables^<span class="co">[</span><span class="ot">See https://www.statology.org/correlation-between-categorical-variables/</span><span class="co">]</span>: Tetrachoric correlation for binary categorical variables; polychoric correlation for ordinal categorical variables; and Cramer’s V for nominal categorical variables.</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pearson's Correlation {#pearson}</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>The Pearson product-moment correlation measures the strength and direction of a linear relationship between two continuous variables, *x* and *y*. The Pearson correlation coefficient, *r*, ranges from -1 (perfect negative linear relationship) to +1 (perfect positive linear relationship). A value of 0 indicates no relationship between two variables.</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>$$r_{x,y} = \frac{\text{Cov}(x,y)}{\text{SD}(x) \text{SD}(y)}$$</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>The statistic can be used as an estimate of the population correlation, $\rho$, in a test of statistical significance from 0 (H0: $\rho$ = 0).</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>$$\rho_{X,Y} = \frac{\text{Cov}(X,Y)}{\text{SD}(X) \text{SD}(Y)}$$</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>As rule of thumb, $|r|$ &lt;.1 is _no correlation_, [.1, .3) is _small_, [.3, .5) is _moderate_, and [.5, 1.0] is _strong_. The test statistic follows a *t*-distribution with *n* − 2 degrees of freedom. </span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>$$t = r_{x,y} \sqrt{\frac{n - 2}{1 - r^2_{x,y}}}$$</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spearman's Rho {#spearman}</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>Spearman's ranked correlation (Spearman's rho) is a measure of the strength and direction of a monotonic relationship between two variables that are at least ordinal. Spearman's correlation is a non-parametric alternative to Pearson when one or more of its conditions are violated. Unlike Pearson, the relationship need not be linear (it only needs to be monotonic), and has no outliers or bivariate normality conditions.</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>Spearman's correlation is Pearson's correlation applied to the *ranks* of variables (for ordinal variables, their value already is a rank). However, there is also a second definition that gives the same result, at least when there are no ties in the ranks:</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>$$\rho = 1 - \frac{6 \sum_i d^2_i}{n(n^2 - 1)}$$</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>where $d_i$ is the difference in ranks of observation $i$.</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kendal's Tau {#kendall}</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>Kendal's tau is a second alternative to Pearson and is identical to Spearman's rho with regard to assumptions. Kendal's tau only differs from Spearman's rho in *how* it measures the relationship. Whereas Spearman measures the correlation of the ranks, Kendal's tau is a function of concordant (C), discordant (D) and tied (Tx and Ty) pairs of observations. Concordant means both X and Y in one observation of a pair are larger than in the other. Discordant means X is larger in one observation than the other while Y is smaller. Tied mean either both observations have the same X or both have the same Y.</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>$$\mathrm{Kendall's} \space \tau_b = \frac{C - D}{\sqrt{(C + D + T_x) \times (C + D + T_Y)}}$$</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## Case Study: Pearson, Spearman, Kendall</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a><span class="in">cs &lt;- list()</span></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a><span class="in"># Two continuous (c) vars</span></span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a><span class="in">cs$dat1 &lt;- read.spss("./input/pearson-correlation.sav", to.data.frame = TRUE)</span></span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a><span class="in"># Two continuous (c) vars, but violating normality/outlier assumption.</span></span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a><span class="in">cs$dat1b &lt;- read.spss("./input/spearmans-correlation.sav", to.data.frame = TRUE)</span></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a><span class="in"># Two ordinal (o) vars</span></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a><span class="in">cs$dat2 &lt;- read.spss("./input/kendalls-tau-b.sav", to.data.frame = TRUE)</span></span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>This case study works with two data sets. <span class="in">`dat1`</span> is composed of two continuous variables; <span class="in">`dat2`</span> is composed of two ordinal variables.  </span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>A researcher investigates the relationship between <span class="in">`cholesterol`</span> concentration and time spent watching TV, <span class="in">`time_tv`</span>, in *n* = <span class="in">`r cs$dat1 %&gt;% nrow()`</span> otherwise healthy 45 to 65 year old men (<span class="in">`dat1`</span>). This data set will meet the conditions for Pearson, so we try all three tests on it.</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>A researcher investigates the relationship between the level of agreement with the statement "*Taxes are too high*" (<span class="in">`tax_too_high`</span>, four level ordinal) and participant <span class="in">`income`</span> level (three level ordinal) (<span class="in">`dat2`</span>). The ordinal variables rule out Pearson, leaving Spearman and Kendall.</span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditions {-}</span></span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>Pearson's correlation applies when X and Y are continuous (interval or ratio) paired variables with 1) a linear relationship that 2) has no significant outliers, and 3) are bivariate normal. Spearman's rho and Kendall's tau only require that X and Y be at least ordinal with 1) a monotonically increasing or decreasing relationship.</span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Linearity** and **Monotonicity**. A visual inspection of a scatterplot should find a linear relationship (Pearson) or monotonic relationship (Spearman and Kendall).</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>Pearson's correlation additionall requires</span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**No Outliers**. Identify outliers with the scatterplot.</span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Normality**. Bivariate normality is difficult to assess. Instead, check that each variable is individually normally distributed. Use the Shapiro-Wilk test.</span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Linearity / Monotonicity {-}</span></span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>Assess linearity and monotonicity with a scatter plot. <span class="in">`dat1`</span> is plotted on the left in Figure \@ref(fig:ccscatter). A second version that fails the linearity test is shown to the right. If the linear relationship assumption fails, consider transforming the variable instead of reverting to Spearman or Kendall.</span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>``<span class="in">`{r ccscatter, echo=FALSE, fig.height=3.5, fig.width=7.5, fig.cap="The left scatter plot is `</span>dat1`. It meets Pearson's linearity condition. A second version at right illustrates what a failure might look like."}</span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>bind_rows(</span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>  <span class="in">`Linear`</span> = cs$dat1,</span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>  <span class="in">`Non-Linear`</span> = cs$dat1b,</span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>  .id = "set"</span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a>) %&gt;%</span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x = time_tv, y = cholesterol)) +</span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>  geom_point(color = "snow4", alpha = 0.6) +</span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "goldenrod", linetype = 2) +</span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a>  theme_minimal() +</span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a>  facet_wrap(vars(set)) +</span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a>  labs(</span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a>    title = "Scatter Plot of Cholesterol Concentration by Time Watching TV", </span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a>    subtitle = "Two data sets, only one meeting all conditions for parametric test.",</span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>    x = "Time (mins/d)",</span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a>    y = "Cholesterol (mmol/L)"</span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a><span class="in">The ordinal variable data set `dat2` is plotted in Figure \@ref(fig:ooscatter).</span></span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ooscatter, echo=FALSE, fig.height=3.5, fig.width=5.5, fig.cap="`dat2` meets the mononicity assumption for Spearman's rho and Kendall's tau."}</span></span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a><span class="in">cs$dat2 %&gt;%</span></span>
<span id="cb43-115"><a href="#cb43-115" aria-hidden="true" tabindex="-1"></a><span class="in">  count(income, tax_too_high) %&gt;%</span></span>
<span id="cb43-116"><a href="#cb43-116" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = income, y = tax_too_high, size = n)) +</span></span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(color = "snow4", alpha = 0.6) +</span></span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Scatter Plot of Tax Attitude by Income Level", </span></span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Income Level",</span></span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Taxes too high?"</span></span>
<span id="cb43-123"><a href="#cb43-123" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb43-124"><a href="#cb43-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a><span class="fu">##### No Outliers {-}</span></span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a>Pearson's correlation requires no outliers. Both plots in Figure \@ref(fig:ccscatter) are free of outliers. If there were outliers, check whether they are data entry errors or measurement errors and fix or discard them. If the outliers are genuine, leave them in if they do not affect the conclusion. You can also try tranforming the variable. Failing all that, revert to the Spearman's rho or Kendall's tau.</span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Bivariate Normality {-}</span></span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a>Bivariate normality is difficult to assess. If two variables are bivariate normal, they will each be individually normal as well. That's the best you can hope to check for. Use the Shapiro-Wilk test.</span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a><span class="in">shapiro.test(cs$dat1$time_tv)</span></span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a><span class="in">shapiro.test(cs$dat1$cholesterol)</span></span>
<span id="cb43-137"><a href="#cb43-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-138"><a href="#cb43-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-139"><a href="#cb43-139" aria-hidden="true" tabindex="-1"></a>If a variable is not normally distributed, you can transform it, carry on regardless since the Pearson correlation is fairly robust to deviations from normality, or revert to Spearman and Kendall.</span>
<span id="cb43-140"><a href="#cb43-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-141"><a href="#cb43-141" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Test {-}</span></span>
<span id="cb43-142"><a href="#cb43-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-143"><a href="#cb43-143" aria-hidden="true" tabindex="-1"></a>Calculate Pearson's correlation, Spearman's rho, or Kendall's tau. <span class="in">`dat`</span> meets the assumptions for Pearson's correlation, but try Spearman's rho and Kendall's tau too, just to see how close they come to Pearson. <span class="in">`dat2`</span> only meets the assumptions for Spearman and Kendall.</span>
<span id="cb43-144"><a href="#cb43-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-145"><a href="#cb43-145" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Pearson's Correlation {-}</span></span>
<span id="cb43-146"><a href="#cb43-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-147"><a href="#cb43-147" aria-hidden="true" tabindex="-1"></a><span class="in">`dat1`</span> met the conditions for Pearson's correlation.</span>
<span id="cb43-148"><a href="#cb43-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-151"><a href="#cb43-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-152"><a href="#cb43-152" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>cc_pearson <span class="ot">&lt;-</span> </span>
<span id="cb43-153"><a href="#cb43-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(cs<span class="sc">$</span>dat1<span class="sc">$</span>cholesterol, cs<span class="sc">$</span>dat1<span class="sc">$</span>time_tv, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb43-154"><a href="#cb43-154" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-155"><a href="#cb43-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-156"><a href="#cb43-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-157"><a href="#cb43-157" aria-hidden="true" tabindex="-1"></a>*r* = `r cs$cc_pearson$estimate %&gt;% scales::number(accuracy = .01)` falls in the range of a "moderate" linear relationship. $r^2$ = `r scales::percent(cs$cc_pearson$estimate^2, accuracy = 1)` is the coefficient of determination. Interpret it as the percent of variability in one variable that is explained by the other. If you are not testing a hypothesis (HO: $\rho \ne 0$), you can report just report *r*. Otherwise, include the *p*-value. Report your results like this:</span>
<span id="cb43-158"><a href="#cb43-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-159"><a href="#cb43-159" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;A Pearson's product-moment correlation was run to assess the relationship between cholesterol concentration and daily time spent watching TV in males aged 45 to 65 years. One hundred participants were recruited.</span></span>
<span id="cb43-160"><a href="#cb43-160" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb43-161"><a href="#cb43-161" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;Preliminary analyses showed the relationship to be linear with both variables normally distributed, as assessed by Shapiro-Wilk's test (p &gt; .05), and there were no outliers.</span></span>
<span id="cb43-162"><a href="#cb43-162" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb43-163"><a href="#cb43-163" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;There was a statistically significant, moderate positive correlation between daily time spent watching TV and cholesterol concentration, *r*(</span><span class="in">`r cs$cc_pearson$parameter`</span><span class="at">) = </span><span class="in">`r cs$cc_pearson$estimate %&gt;% scales::number(accuracy = .01)`</span><span class="at">, p &lt; .0005, with time spent watching TV explaining </span><span class="in">`r scales::percent(cs$cc_pearson$estimate^2, accuracy = 1)`</span><span class="at"> of the variation in cholesterol concentration.</span></span>
<span id="cb43-164"><a href="#cb43-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-165"><a href="#cb43-165" aria-hidden="true" tabindex="-1"></a>You wouldn't use Spearman's rho or Kendall's tau here since the more precise Pearson's correlation is available. But just out of curiosity, here are the correlations using those two measures.</span>
<span id="cb43-166"><a href="#cb43-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-167"><a href="#cb43-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb43-168"><a href="#cb43-168" aria-hidden="true" tabindex="-1"></a><span class="in">cor(cs$dat1$cholesterol, cs$dat1$time_tv, method = "kendall")</span></span>
<span id="cb43-169"><a href="#cb43-169" aria-hidden="true" tabindex="-1"></a><span class="in">cor(cs$dat1$cholesterol, cs$dat1$time_tv, method = "spearman")</span></span>
<span id="cb43-170"><a href="#cb43-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-171"><a href="#cb43-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-172"><a href="#cb43-172" aria-hidden="true" tabindex="-1"></a>Both Kendall and Spearman produced more conservative estimates of the strength of the relationship - Kendall especially so.</span>
<span id="cb43-173"><a href="#cb43-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-174"><a href="#cb43-174" aria-hidden="true" tabindex="-1"></a>You probably wouldn't use linear regression here either because it describes the linear relationship between a *response* variable and changes to an independent *explanatory* variable. Even though we are reluctant to interpret a regression model in terms of causality, that is what is implied the formulation <span class="in">`y ~ x`</span> and independence assumption in of X. Nevertheless, correlation and regression are related. The slope term in a simple linear regression of the normalized values equals the Pearson correlation.</span>
<span id="cb43-175"><a href="#cb43-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-178"><a href="#cb43-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-179"><a href="#cb43-179" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(</span>
<span id="cb43-180"><a href="#cb43-180" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> x, </span>
<span id="cb43-181"><a href="#cb43-181" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> cs<span class="sc">$</span>dat1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">scale</span>(cholesterol), <span class="at">x =</span> <span class="fu">scale</span>(time_tv))</span>
<span id="cb43-182"><a href="#cb43-182" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-183"><a href="#cb43-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-184"><a href="#cb43-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-185"><a href="#cb43-185" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Spearman's Rho {-}</span></span>
<span id="cb43-186"><a href="#cb43-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-187"><a href="#cb43-187" aria-hidden="true" tabindex="-1"></a>Data set <span class="in">`dat2`</span> did not meet the conditions for Pearson's correlation, so use Spearman's rho and/or Kendall's tau.</span>
<span id="cb43-188"><a href="#cb43-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-189"><a href="#cb43-189" aria-hidden="true" tabindex="-1"></a>Start with Spearman's rho. Recall that Spearman's rho is just the Pearson correlation applied to the ranks. Recall also that the Pearson's correlation is just the covariance divided by the product of the standard deviations. You can quickly calculate it by hand.</span>
<span id="cb43-190"><a href="#cb43-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-193"><a href="#cb43-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-194"><a href="#cb43-194" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(<span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income), <span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high)) <span class="sc">/</span></span>
<span id="cb43-195"><a href="#cb43-195" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">sd</span>(<span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income)) <span class="sc">*</span> <span class="fu">sd</span>(<span class="fu">rank</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high)))</span>
<span id="cb43-196"><a href="#cb43-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-197"><a href="#cb43-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-198"><a href="#cb43-198" aria-hidden="true" tabindex="-1"></a>Use the function though. I don't get why <span class="in">`cor.test`</span> requires <span class="in">`x`</span> and <span class="in">`y`</span> be numeric.</span>
<span id="cb43-199"><a href="#cb43-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-202"><a href="#cb43-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-203"><a href="#cb43-203" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>spearman <span class="ot">&lt;-</span> </span>
<span id="cb43-204"><a href="#cb43-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(</span>
<span id="cb43-205"><a href="#cb43-205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high), </span>
<span id="cb43-206"><a href="#cb43-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income), </span>
<span id="cb43-207"><a href="#cb43-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb43-208"><a href="#cb43-208" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-209"><a href="#cb43-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-210"><a href="#cb43-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-211"><a href="#cb43-211" aria-hidden="true" tabindex="-1"></a>Interpret the statistic using the same rule of thumb as for Pearson's correlation. A rho over .5 is a strong correlation.</span>
<span id="cb43-212"><a href="#cb43-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-213"><a href="#cb43-213" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;A Spearman's rank-order correlation was run to assess the relationship between income level and views towards income taxes in 24 participants. Preliminary analysis showed the relationship to be monotonic, as assessed by visual inspection of a scatterplot. There was a statistically significant, strong positive correlation between income level and views towards income taxes, $r_s$ = </span><span class="in">`r cs$spearman$estimate %&gt;% scales::number(accuracy = .001)`</span><span class="at">, *p* = </span><span class="in">`r cs$spearman$p.value %&gt;% scales::number(accuracy = .001)`</span><span class="at">.</span></span>
<span id="cb43-214"><a href="#cb43-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-215"><a href="#cb43-215" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Kendall's Tau {-}</span></span>
<span id="cb43-216"><a href="#cb43-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-217"><a href="#cb43-217" aria-hidden="true" tabindex="-1"></a>Recall that Kendall's tau is a function of concordant (C), discordant (D) and tied (Tx and Ty) pairs of observations. The manual calculation is a little more involved. Here is the function instead.</span>
<span id="cb43-218"><a href="#cb43-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-221"><a href="#cb43-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-222"><a href="#cb43-222" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>kendall <span class="ot">&lt;-</span> </span>
<span id="cb43-223"><a href="#cb43-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(</span>
<span id="cb43-224"><a href="#cb43-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>tax_too_high), </span>
<span id="cb43-225"><a href="#cb43-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(cs<span class="sc">$</span>dat2<span class="sc">$</span>income), </span>
<span id="cb43-226"><a href="#cb43-226" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb43-227"><a href="#cb43-227" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-228"><a href="#cb43-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-229"><a href="#cb43-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-230"><a href="#cb43-230" aria-hidden="true" tabindex="-1"></a>As with the case study on cholesterol and television, Kendall's tau was more conservative than Spearman's rho. $\tau_b$ = <span class="in">`r cs$kendall$estimate %&gt;% scales::number(accuracy = .001)`</span> is still in the "strong" range, though just barely.</span>
<span id="cb43-231"><a href="#cb43-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-232"><a href="#cb43-232" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;A Kendall's tau-b correlation was run to assess the relationship between income level and views towards income taxes amongst 24 participants. Preliminary analysis showed the relationship to be monotonic, as assessed by visual inspection of a scatterplot. There was a statistically significant, strong positive correlation between income level and the view that taxes were too high, $\tau_b$ = </span><span class="in">`r cs$kendall$estimate %&gt;% scales::number(accuracy = .001)`</span><span class="at">, *p* = </span><span class="in">`r cs$kendall$p.value %&gt;% scales::number(accuracy = .001)`</span><span class="at">.</span></span>
<span id="cb43-233"><a href="#cb43-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-234"><a href="#cb43-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chi-Square Test of Independence {#chisq-independence}</span></span>
<span id="cb43-235"><a href="#cb43-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-236"><a href="#cb43-236" aria-hidden="true" tabindex="-1"></a>The **chi-square test of independence** tests whether two categorical variables are associated, or are instead *independent*^[The test is sometimes call the chi-square test for *association*.]. It tests whether the observed joint frequency counts $O_{ij}$ differ from expected frequency counts $E_{ij}$ under the *independence model* (the model of independent explanatory variables, $\pi_{ij} = \pi_{i+} \pi_{+j}$. The null hypothesis is $O_{ij} = E_{ij}$. The test assumes the two variables are independent^<span class="co">[</span><span class="ot">Independence is usually true by assumption and/or construction. It can be violated by, for example, a sample that includes spouses where one spouse's status (e.g., preference for a vacation destination) may be related to the other spouse's status.</span><span class="co">]</span> and that all cell counts are at least 5.</span>
<span id="cb43-237"><a href="#cb43-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-238"><a href="#cb43-238" aria-hidden="true" tabindex="-1"></a>Choose from two test statistics, Pearson $X^2$ (and the continuity adjusted $X^2$), and deviance *G*. As $n \rightarrow \infty$ their sampling distributions approach $\chi^2(df)$ with degrees of freedom (df) equal to the saturated model df $I \times J - 1$ minus the independence model df $(I - 1) + (J - 1)$, which you can algebraically solve for $df = (I - 1)(J - 1)$.</span>
<span id="cb43-239"><a href="#cb43-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-240"><a href="#cb43-240" aria-hidden="true" tabindex="-1"></a>The Pearson goodness-of-fit statistic is</span>
<span id="cb43-241"><a href="#cb43-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-242"><a href="#cb43-242" aria-hidden="true" tabindex="-1"></a>$$X^2 = \sum \frac{(O_{ij} - E_{ij})^2}{E_{ij}}$$</span>
<span id="cb43-243"><a href="#cb43-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-244"><a href="#cb43-244" aria-hidden="true" tabindex="-1"></a>where $O_{ij}$ is the observed count, and $E_{ij}$ is the product of the row and column marginal probabilities. The deviance statistic is </span>
<span id="cb43-245"><a href="#cb43-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-246"><a href="#cb43-246" aria-hidden="true" tabindex="-1"></a>$$G = 2 \sum_{ij} O_{ij} \log \left( \frac{O_{ij}}{E_{ij}} \right)$$</span>
<span id="cb43-247"><a href="#cb43-247" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb43-248"><a href="#cb43-248" aria-hidden="true" tabindex="-1"></a>$X^2$ and *G* increase with the disagreement between the saturated model proportions $p_{ij}$ and the independence model proportions $\pi_{ij}$.</span>
<span id="cb43-249"><a href="#cb43-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-250"><a href="#cb43-250" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fisher's Exact Test {#fisher-exact}</span></span>
<span id="cb43-251"><a href="#cb43-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-252"><a href="#cb43-252" aria-hidden="true" tabindex="-1"></a>Whereas the chi-squared and *G*-test rely on the approximation that the test statistic distribution approaches $\chi^2$ as $n \rightarrow \infty$, Fisher's exact test is an "exact test" in that the *p*-value is calculated exactly from the [hypergeometric distribution](https://bookdown.org/mpfoley1973/probability/hypergeometric.html). Therefore Fisher's test *should* only apply only to 2 x 2 tables. For some reason, it doesn't.^<span class="co">[</span><span class="ot">It doesn't apply to just 2 x 2, so I need to figure out why.</span><span class="co">]</span></span>
<span id="cb43-253"><a href="#cb43-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-254"><a href="#cb43-254" aria-hidden="true" tabindex="-1"></a>The test assumes the row totals $n_{i+}$ and the column totals $n_{+j}$ are fixed by study design, and the expected values of at least 20% of cells in the table have expected cell count &gt;5, and no expected cell count is 0.</span>
<span id="cb43-255"><a href="#cb43-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-256"><a href="#cb43-256" aria-hidden="true" tabindex="-1"></a>The famous example of the Fisher exact test is the "Lady tea testing" example. A lady claims she can guess whether the milk was poured into the cup before or after the tea. The experiment consists of 8 cups, 4 with milk poured first, 4 with milk poured second. The lady guesses correctly in 6 of the 8 cups.</span>
<span id="cb43-257"><a href="#cb43-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-260"><a href="#cb43-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-261"><a href="#cb43-261" aria-hidden="true" tabindex="-1"></a>(tea <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb43-262"><a href="#cb43-262" aria-hidden="true" tabindex="-1"></a>       <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">Guess =</span> <span class="fu">c</span>(<span class="st">"Milk"</span>, <span class="st">"Tea"</span>),</span>
<span id="cb43-263"><a href="#cb43-263" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Truth =</span> <span class="fu">c</span>(<span class="st">"Milk"</span>, <span class="st">"Tea"</span>))))</span>
<span id="cb43-264"><a href="#cb43-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-265"><a href="#cb43-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-266"><a href="#cb43-266" aria-hidden="true" tabindex="-1"></a>This is a hypergeometric distribution question because you want to know the probability of 3 or 4 successes in a sample of 4. If $X = k$ is the count of successful events in a sample of size $n$ *without replacement* from a population of size $N$ containing $K$ successes, then $X$ is a random variable with a hypergeometric distribution</span>
<span id="cb43-267"><a href="#cb43-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-268"><a href="#cb43-268" aria-hidden="true" tabindex="-1"></a>$$f_X(k|N, K, n) = \frac{{{K}\choose{k}}{{N-K}\choose{n-k}}}{{N}\choose{n}}.$$</span>
<span id="cb43-269"><a href="#cb43-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-270"><a href="#cb43-270" aria-hidden="true" tabindex="-1"></a>The formula follows from the frequency table of the possible outcomes. ${K}\choose{k}$ is the number of ways to get *k* successes in *K* draws. ${N-K}\choose{n-k}$ is the number of ways to fail to get *k* successes in *K* draws. And the denominator ${N}\choose{n}$ is the total of all ways to succeed and fail.</span>
<span id="cb43-271"><a href="#cb43-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-274"><a href="#cb43-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-275"><a href="#cb43-275" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb43-276"><a href="#cb43-276" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">`</span><span class="at"> </span><span class="st">`</span>, <span class="sc">~</span>Sampled, <span class="sc">~</span><span class="st">`</span><span class="at">Not Sampled</span><span class="st">`</span>,  <span class="sc">~</span>Total,</span>
<span id="cb43-277"><a href="#cb43-277" aria-hidden="true" tabindex="-1"></a>  <span class="st">"success"</span>, <span class="st">"k"</span>, <span class="st">"K-k"</span>, <span class="st">"K"</span>,</span>
<span id="cb43-278"><a href="#cb43-278" aria-hidden="true" tabindex="-1"></a>  <span class="st">"non-success"</span>, <span class="st">"n-k"</span>, <span class="st">"(N-K)-(n-k)"</span>, <span class="st">"N-K"</span>,</span>
<span id="cb43-279"><a href="#cb43-279" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Total"</span>, <span class="st">"n"</span>, <span class="st">"N-n"</span>, <span class="st">"N"</span></span>
<span id="cb43-280"><a href="#cb43-280" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb43-281"><a href="#cb43-281" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-282"><a href="#cb43-282" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">autofit</span>()</span>
<span id="cb43-283"><a href="#cb43-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-284"><a href="#cb43-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-285"><a href="#cb43-285" aria-hidden="true" tabindex="-1"></a>Function <span class="in">`choose()`</span> returns the binomial coefficient ${{n}\choose{k}} = \frac{n!}{k!(n-k)!}$. The probability of choosing correctly at least 3 times out of 4 is the number of combinations of *k* = 3 plus the number with *k* = 4 divided by the number of combinations of *any* outcome.</span>
<span id="cb43-286"><a href="#cb43-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-289"><a href="#cb43-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-290"><a href="#cb43-290" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>; n <span class="ot">&lt;-</span> <span class="dv">4</span>; K <span class="ot">&lt;-</span> <span class="dv">4</span>; N <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb43-291"><a href="#cb43-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-292"><a href="#cb43-292" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(K, k) <span class="sc">*</span> <span class="fu">choose</span>(N<span class="sc">-</span>K, n<span class="sc">-</span>k) <span class="sc">/</span> <span class="fu">choose</span>(N, n) <span class="sc">+</span></span>
<span id="cb43-293"><a href="#cb43-293" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(K, k<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">choose</span>(N<span class="sc">-</span>K, n<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">/</span> <span class="fu">choose</span>(N, n)</span>
<span id="cb43-294"><a href="#cb43-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-295"><a href="#cb43-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-296"><a href="#cb43-296" aria-hidden="true" tabindex="-1"></a><span class="in">`phyper()`</span> does this.^<span class="co">[</span><span class="ot">k-1 because it returns the probability of &gt;k and we want &gt;=k).</span><span class="co">]</span></span>
<span id="cb43-297"><a href="#cb43-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-300"><a href="#cb43-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-301"><a href="#cb43-301" aria-hidden="true" tabindex="-1"></a>(pi <span class="ot">&lt;-</span> <span class="fu">phyper</span>(<span class="at">q =</span> k<span class="dv">-1</span>, <span class="at">m =</span> K, <span class="at">n =</span> N<span class="sc">-</span>K, <span class="at">k =</span> n, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb43-302"><a href="#cb43-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-303"><a href="#cb43-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-304"><a href="#cb43-304" aria-hidden="true" tabindex="-1"></a>The *p*-value from Fisher's exact test is calculated this way.</span>
<span id="cb43-305"><a href="#cb43-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-308"><a href="#cb43-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-309"><a href="#cb43-309" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(tea, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb43-310"><a href="#cb43-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-311"><a href="#cb43-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-312"><a href="#cb43-312" aria-hidden="true" tabindex="-1"></a>The odds ratio at the bottom is the odds of success divided by the odds of non-success. The sample odds ratio is (3/1) / (1/3) = <span class="in">`r (3/1) / (1/3)`</span>, but the documentation for <span class="in">`fisher.test()`</span> explains that this it calculates the *conditional maximum likelihood estimate*.^<span class="co">[</span><span class="ot">I don't really know what that means. [Brownlee](https://machinelearningmastery.com/what-is-maximum-likelihood-estimation-in-machine-learning/) might help.</span><span class="co">]</span></span>
<span id="cb43-313"><a href="#cb43-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-314"><a href="#cb43-314" aria-hidden="true" tabindex="-1"></a><span class="fu">## Case Study: Chi-Square, Fisher</span></span>
<span id="cb43-315"><a href="#cb43-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-316"><a href="#cb43-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb43-317"><a href="#cb43-317" aria-hidden="true" tabindex="-1"></a><span class="in"># Gender vs Competition</span></span>
<span id="cb43-318"><a href="#cb43-318" aria-hidden="true" tabindex="-1"></a><span class="in"># https://statistics.laerd.com/premium/spss/or2x2/odds-ratio-2x2-in-spss.php</span></span>
<span id="cb43-319"><a href="#cb43-319" aria-hidden="true" tabindex="-1"></a><span class="in">cs$or2x2 &lt;- read.spss("./input/odds-ratio-2x2-individual-scores.sav", to.data.frame = TRUE)</span></span>
<span id="cb43-320"><a href="#cb43-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-321"><a href="#cb43-321" aria-hidden="true" tabindex="-1"></a><span class="in"># Same data, already summarized! Do no use this.</span></span>
<span id="cb43-322"><a href="#cb43-322" aria-hidden="true" tabindex="-1"></a><span class="in"># https://statistics.laerd.com/premium/spss/cstfa/chi-square-test-for-association-in-spss.php</span></span>
<span id="cb43-323"><a href="#cb43-323" aria-hidden="true" tabindex="-1"></a><span class="in">cs$cstfa &lt;- read.spss("./input/chi-square-test-for-association-frequencies.sav", to.data.frame = TRUE)</span></span>
<span id="cb43-324"><a href="#cb43-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-325"><a href="#cb43-325" aria-hidden="true" tabindex="-1"></a><span class="in"># Gender vs Competition again, but this time with small cell counts</span></span>
<span id="cb43-326"><a href="#cb43-326" aria-hidden="true" tabindex="-1"></a><span class="in"># https://statistics.laerd.com/premium/spss/fet2x2/fishers-exact-test-in-spss.php</span></span>
<span id="cb43-327"><a href="#cb43-327" aria-hidden="true" tabindex="-1"></a><span class="in">cs$fet2x2 &lt;- read.spss("./input/fishers-exact-test-2x2-individual-scores.sav", to.data.frame = TRUE)</span></span>
<span id="cb43-328"><a href="#cb43-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-329"><a href="#cb43-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-330"><a href="#cb43-330" aria-hidden="true" tabindex="-1"></a>A researcher investigates whether males and females enrolled in an Exercise Science degree course differ in the type of exercise then engage, competitive or non-competitive. They survey 25 males and 25 females. </span>
<span id="cb43-331"><a href="#cb43-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-334"><a href="#cb43-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-335"><a href="#cb43-335" aria-hidden="true" tabindex="-1"></a>cs<span class="sc">$</span>or2x2 <span class="sc">%&gt;%</span> </span>
<span id="cb43-336"><a href="#cb43-336" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb43-337"><a href="#cb43-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"row"</span>,</span>
<span id="cb43-338"><a href="#cb43-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(comp <span class="sc">~</span> <span class="st">"Competitive"</span>)</span>
<span id="cb43-339"><a href="#cb43-339" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-340"><a href="#cb43-340" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">add_p</span>()</span>
<span id="cb43-341"><a href="#cb43-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-342"><a href="#cb43-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-343"><a href="#cb43-343" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditions {-}</span></span>
<span id="cb43-344"><a href="#cb43-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-345"><a href="#cb43-345" aria-hidden="true" tabindex="-1"></a>Use the Chi-Square test of independence for nominal, independent variables. The test requires all cell counts to be greater than 5. If your data does not meet this condition, consider collapsing some levels. If you collapse all the way to a 2 x 2 cross-tabulation and still do not have at least 5 counts per cell, use Fisher's exact test.</span>
<span id="cb43-346"><a href="#cb43-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-347"><a href="#cb43-347" aria-hidden="true" tabindex="-1"></a>Use Fisher's exact test for *dichotomous* nominal, independent variables. The test is valid for *cross-sectional* samples, but not for prospective or retrospective samples.</span>
<span id="cb43-348"><a href="#cb43-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-349"><a href="#cb43-349" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Test {-}</span></span>
<span id="cb43-350"><a href="#cb43-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-351"><a href="#cb43-351" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Chi-Square {-}</span></span>
<span id="cb43-352"><a href="#cb43-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-353"><a href="#cb43-353" aria-hidden="true" tabindex="-1"></a>To see what's going on, here is chi-square test done by hand. The expected values are the joint probabilities from the independence model (e.g., $E(\mathrm{male}, {\mathrm{yes}}) = \pi_{\mathrm{male}} \times \pi_{\mathrm{yes}} \times n$).</span>
<span id="cb43-354"><a href="#cb43-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-355"><a href="#cb43-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb43-356"><a href="#cb43-356" aria-hidden="true" tabindex="-1"></a><span class="in">exer_table &lt;- cs$or2x2 %&gt;% table()</span></span>
<span id="cb43-357"><a href="#cb43-357" aria-hidden="true" tabindex="-1"></a><span class="in">expected &lt;- marginSums(exer_table, 1) %*% t(marginSums(exer_table, 2)) / sum(exer_table)</span></span>
<span id="cb43-358"><a href="#cb43-358" aria-hidden="true" tabindex="-1"></a><span class="in">(X2 &lt;- sum((exer_table - expected)^2 / expected))</span></span>
<span id="cb43-359"><a href="#cb43-359" aria-hidden="true" tabindex="-1"></a><span class="in">(df &lt;- (2 - 1) * (2 - 1))</span></span>
<span id="cb43-360"><a href="#cb43-360" aria-hidden="true" tabindex="-1"></a><span class="in">pchisq(X2, df, lower.tail = FALSE)</span></span>
<span id="cb43-361"><a href="#cb43-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-362"><a href="#cb43-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-363"><a href="#cb43-363" aria-hidden="true" tabindex="-1"></a>And the *G* test.</span>
<span id="cb43-364"><a href="#cb43-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-365"><a href="#cb43-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb43-366"><a href="#cb43-366" aria-hidden="true" tabindex="-1"></a><span class="in">(G &lt;- 2 * sum(exer_table * log(exer_table / expected)))</span></span>
<span id="cb43-367"><a href="#cb43-367" aria-hidden="true" tabindex="-1"></a><span class="in">pchisq(G, df, lower.tail = FALSE)</span></span>
<span id="cb43-368"><a href="#cb43-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-369"><a href="#cb43-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-370"><a href="#cb43-370" aria-hidden="true" tabindex="-1"></a>The <span class="in">`chisq.test()`</span> function applies the Yates continuity correction by default to correct for situations with small cell counts.  The Yates continuity correction  subtracts 0.5 from the $O_{ij} - E_{ij}$ differences.  Set <span class="in">`correct = FALSE`</span> to suppress Yates. The Yates continuity correction only applies to 2 x 2 tables.</span>
<span id="cb43-371"><a href="#cb43-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-374"><a href="#cb43-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-375"><a href="#cb43-375" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_chisq.test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(exer_table, <span class="at">correct =</span> <span class="cn">FALSE</span>))</span>
<span id="cb43-376"><a href="#cb43-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-377"><a href="#cb43-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-378"><a href="#cb43-378" aria-hidden="true" tabindex="-1"></a>Calculate the *G* test with <span class="in">`DescTools::GTest()`</span>.</span>
<span id="cb43-379"><a href="#cb43-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-382"><a href="#cb43-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-383"><a href="#cb43-383" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_g.test <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">GTest</span>(exer_table, <span class="at">correct =</span> <span class="st">"none"</span>))</span>
<span id="cb43-384"><a href="#cb43-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-385"><a href="#cb43-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-386"><a href="#cb43-386" aria-hidden="true" tabindex="-1"></a>As a side note, if the cell size &gt;5 condition is violated, you can use Monte Carlo simulation.</span>
<span id="cb43-387"><a href="#cb43-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-390"><a href="#cb43-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-391"><a href="#cb43-391" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(exer_table, <span class="at">correct =</span> <span class="cn">FALSE</span>, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-392"><a href="#cb43-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-393"><a href="#cb43-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-394"><a href="#cb43-394" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fisher {-}</span></span>
<span id="cb43-395"><a href="#cb43-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-396"><a href="#cb43-396" aria-hidden="true" tabindex="-1"></a>The documentation for <span class="in">`fisher.test()`</span> explains that the *p*-value is based on the the first element of the contingency table "*with non-centrality parameter given by the odds ratio.*" I don't understand the odds ratio business and cannot figure out how it is calculated. It says in the documentation for the `estimate` value that "*Note that the conditional Maximum Likelihood Estimate (MLE) rather than the unconditional MLE (the sample odds ratio) is used.*", so that may hold the answer.</span>
<span id="cb43-397"><a href="#cb43-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-398"><a href="#cb43-398" aria-hidden="true" tabindex="-1"></a>At least the *p*-value I can calculate by hand.</span>
<span id="cb43-399"><a href="#cb43-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-402"><a href="#cb43-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-403"><a href="#cb43-403" aria-hidden="true" tabindex="-1"></a><span class="fu">phyper</span>(<span class="at">q =</span> exer_table[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>,  <span class="co"># k minus 1</span></span>
<span id="cb43-404"><a href="#cb43-404" aria-hidden="true" tabindex="-1"></a>       <span class="at">m =</span> <span class="fu">sum</span>(exer_table[<span class="dv">1</span>, ]),  <span class="co"># K</span></span>
<span id="cb43-405"><a href="#cb43-405" aria-hidden="true" tabindex="-1"></a>       <span class="at">n =</span> <span class="fu">sum</span>(exer_table[<span class="dv">2</span>, ]),  <span class="co"># N - K</span></span>
<span id="cb43-406"><a href="#cb43-406" aria-hidden="true" tabindex="-1"></a>       <span class="at">k =</span> <span class="fu">sum</span>(exer_table[, <span class="dv">1</span>]),  <span class="co"># n</span></span>
<span id="cb43-407"><a href="#cb43-407" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb43-408"><a href="#cb43-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-409"><a href="#cb43-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-412"><a href="#cb43-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-413"><a href="#cb43-413" aria-hidden="true" tabindex="-1"></a>(cs<span class="sc">$</span>or2x2_fisher.test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(exer_table))</span>
<span id="cb43-414"><a href="#cb43-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-415"><a href="#cb43-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-416"><a href="#cb43-416" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Post-Test: Phi, Cramer's V {-}</span></span>
<span id="cb43-417"><a href="#cb43-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-418"><a href="#cb43-418" aria-hidden="true" tabindex="-1"></a>The problem with the chi-square test for association is that it does not measure the *strength* of any association. Two measures of associate are often calculated after the chi-squared or Fisher tests.</span>
<span id="cb43-419"><a href="#cb43-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-420"><a href="#cb43-420" aria-hidden="true" tabindex="-1"></a>Cramer's V is derived from the chi-square statistic. It restricts the statistic to a range of 0 to 1. ^[<span class="co">[</span><span class="ot">This tutorial</span><span class="co">](https://methods.sagepub.com/base/download/DatasetStudentGuide/cramers-v-lfsp-2015-r)</span> says both variables should have more than two levels, but doesn't explain why.] Values under .1 are considered poor evidence of association; &gt;.2 are "moderately strong" evidence.</span>
<span id="cb43-421"><a href="#cb43-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-422"><a href="#cb43-422" aria-hidden="true" tabindex="-1"></a>$$V = \sqrt{\frac{\chi^2 / n}{\mathrm{min}(I, J) - 1}}$$</span>
<span id="cb43-423"><a href="#cb43-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-424"><a href="#cb43-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb43-425"><a href="#cb43-425" aria-hidden="true" tabindex="-1"></a><span class="in"># by hand</span></span>
<span id="cb43-426"><a href="#cb43-426" aria-hidden="true" tabindex="-1"></a><span class="in">sqrt(cs$or2x2_chisq.test$statistic / sum(exer_table) / (min(2, 2) - 1))</span></span>
<span id="cb43-427"><a href="#cb43-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-428"><a href="#cb43-428" aria-hidden="true" tabindex="-1"></a><span class="in"># from package</span></span>
<span id="cb43-429"><a href="#cb43-429" aria-hidden="true" tabindex="-1"></a><span class="in">(cs$or2x2_v &lt;- rcompanion::cramerV(exer_table))</span></span>
<span id="cb43-430"><a href="#cb43-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-431"><a href="#cb43-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-432"><a href="#cb43-432" aria-hidden="true" tabindex="-1"></a>The Phi Coefficient is defined</span>
<span id="cb43-433"><a href="#cb43-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-434"><a href="#cb43-434" aria-hidden="true" tabindex="-1"></a>$$\Phi = \sqrt{\frac{AD-BC}{(A+B)(C+D)(A+C)(B+D)}}$$</span>
<span id="cb43-435"><a href="#cb43-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-436"><a href="#cb43-436" aria-hidden="true" tabindex="-1"></a>where A, B, C, and D are the four values of the 2 x 2 contingency table. </span>
<span id="cb43-437"><a href="#cb43-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-440"><a href="#cb43-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-441"><a href="#cb43-441" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"D"</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb43-442"><a href="#cb43-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-443"><a href="#cb43-443" aria-hidden="true" tabindex="-1"></a>Similar to a Pearson Correlation Coefficient, a Phi Coefficient takes on values between -1 and 1.</span>
<span id="cb43-444"><a href="#cb43-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-445"><a href="#cb43-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb43-446"><a href="#cb43-446" aria-hidden="true" tabindex="-1"></a><span class="in"># by hand</span></span>
<span id="cb43-447"><a href="#cb43-447" aria-hidden="true" tabindex="-1"></a><span class="in">det(matrix(exer_table, nrow = 2)) / </span></span>
<span id="cb43-448"><a href="#cb43-448" aria-hidden="true" tabindex="-1"></a><span class="in">  sqrt(prod(c(marginSums(exer_table, 1), marginSums(exer_table, 2))))</span></span>
<span id="cb43-449"><a href="#cb43-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-450"><a href="#cb43-450" aria-hidden="true" tabindex="-1"></a><span class="in"># from package</span></span>
<span id="cb43-451"><a href="#cb43-451" aria-hidden="true" tabindex="-1"></a><span class="in">(cs$or2x2_phi &lt;- psych::phi(exer_table))</span></span>
<span id="cb43-452"><a href="#cb43-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-453"><a href="#cb43-453" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Reporting {-}</span></span>
<span id="cb43-454"><a href="#cb43-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-455"><a href="#cb43-455" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;A chi-square test for association was conducted between gender and preference for performing competitive sport. All expected cell frequencies were greater than five. There was a statistically significant association between gender and preference for performing competitive sport, ($X^2$(1) = </span><span class="in">`r number(cs$or2x2_chisq.test$statistic, .001)`</span><span class="at">, *p* = `r number(cs$or2x2_chisq.test$p.value, .001)`. There was a moderately strong association between gender and preference for performing competitive sport, *V* = </span><span class="in">`r number(cs$or2x2_v, .001)`</span><span class="at">.</span></span>
<span id="cb43-456"><a href="#cb43-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-457"><a href="#cb43-457" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A Fisher's Exact test was conducted between gender and preference for performing competitive sport. There was a statistically significant association between gender and preference for performing competitive sport, *p* = </span><span class="in">`r number(cs$or2x2_fisher.test$p.value, .001)`</span><span class="at">.</span></span>
<span id="cb43-458"><a href="#cb43-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-459"><a href="#cb43-459" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kruskal's Lambda</span></span>
<span id="cb43-460"><a href="#cb43-460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relative Risk</span></span>
<span id="cb43-461"><a href="#cb43-461" aria-hidden="true" tabindex="-1"></a><span class="fu">## Odds Ratio</span></span>
<span id="cb43-462"><a href="#cb43-462" aria-hidden="true" tabindex="-1"></a>Calculate relative risks for *dichotomous* nominal, independent variables when one variable is independent, the other dependent. Relative risks are valid for *prospective* and *retrospective cohort designs*, *randomized controlled trials (RCTs)*, and some types of *cross-sectional studies*, but not with case-control studies.</span>
<span id="cb43-463"><a href="#cb43-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-464"><a href="#cb43-464" aria-hidden="true" tabindex="-1"></a>Calculate odds ratios as an alternative to relative risk. It makes the same assumptions. Unlike relative risk, it is valid for *all* study designs.</span>
<span id="cb43-465"><a href="#cb43-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-466"><a href="#cb43-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-469"><a href="#cb43-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-470"><a href="#cb43-470" aria-hidden="true" tabindex="-1"></a>cs<span class="sc">$</span>or2</span>
<span id="cb43-471"><a href="#cb43-471" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking vs Lung Cancer</span></span>
<span id="cb43-472"><a href="#cb43-472" aria-hidden="true" tabindex="-1"></a><span class="co"># https://statistics.laerd.com/premium/spss/rr2x2/relative-risk-2x2-in-spss.php</span></span>
<span id="cb43-473"><a href="#cb43-473" aria-hidden="true" tabindex="-1"></a>cs<span class="sc">$</span>rr2x2 <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(</span>
<span id="cb43-474"><a href="#cb43-474" aria-hidden="true" tabindex="-1"></a>  <span class="st">"./input/relative-risk-2x2-individual-scores.sav"</span>, </span>
<span id="cb43-475"><a href="#cb43-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">to.data.frame =</span> <span class="cn">TRUE</span></span>
<span id="cb43-476"><a href="#cb43-476" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-477"><a href="#cb43-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-478"><a href="#cb43-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-479"><a href="#cb43-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-480"><a href="#cb43-480" aria-hidden="true" tabindex="-1"></a><span class="fu">## Partial Correlation</span></span>
<span id="cb43-481"><a href="#cb43-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-482"><a href="#cb43-482" aria-hidden="true" tabindex="-1"></a>The _partial correlation_ of $\textbf{Y}_j$ and $\textbf{Y}_k$ is their correlation _conditioned on sampling from a sub-population of_ $X$. Express the sub-population as $\textbf{Z} = \begin{pmatrix}\textbf{X}_1 \\ \textbf{X}_2 \end{pmatrix}$ with partitioned mean vector $\boldsymbol{\bar{x}} = \begin{pmatrix}\boldsymbol{\bar{x}}_1 \\ \boldsymbol{\bar{x}}_2 \end{pmatrix}$. The variance-covariance matrix is complicated by the covariances between $\textbf{X}_1$ and $\textbf{X}_1$, so the partition is a _matrix of matrices_, $\boldsymbol{S} = \begin{pmatrix} \boldsymbol{S}_{11} &amp; \boldsymbol{S}_{12} \\ \boldsymbol{S}_{21} &amp; \boldsymbol{S}_{22} \end{pmatrix}$. $\boldsymbol{S}_{11}$ and $\boldsymbol{S}_{22}$ are the variance-covariance matrices of $\textbf{X}_1$ and $\textbf{X}_2$, and $\boldsymbol{S}_{12}$ and $\boldsymbol{S}_{21}$ are the (identical) variance-covariance matrices between the variables in $\textbf{X}_1$ and the variables in $\textbf{X}_2$.</span>
<span id="cb43-483"><a href="#cb43-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-484"><a href="#cb43-484" aria-hidden="true" tabindex="-1"></a>Partitioning means you can express the mean, ($\textbf{M}$, and variance-covariance matrix, $\textbf{CV}$ of $Y$ _conditioned_ on $\textbf{X} = \textbf{x}_2$.</span>
<span id="cb43-485"><a href="#cb43-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-486"><a href="#cb43-486" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-487"><a href="#cb43-487" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb43-488"><a href="#cb43-488" aria-hidden="true" tabindex="-1"></a>\textbf{M} = \boldsymbol{\bar{x}}_1 + \boldsymbol{S}_{12} \boldsymbol{S}_{22}^{-1} (\textbf{x}_2 - \boldsymbol{\bar{x}}_2)</span>
<span id="cb43-489"><a href="#cb43-489" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb43-490"><a href="#cb43-490" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-491"><a href="#cb43-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-492"><a href="#cb43-492" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-493"><a href="#cb43-493" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb43-494"><a href="#cb43-494" aria-hidden="true" tabindex="-1"></a>\textbf{CV} = \boldsymbol{S}_{11} - \boldsymbol{S}_{12} \boldsymbol{S}_{22}^{-1} \boldsymbol{S}_{21}</span>
<span id="cb43-495"><a href="#cb43-495" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb43-496"><a href="#cb43-496" aria-hidden="true" tabindex="-1"></a>(<span class="sc">\#</span>eq:s06-cond-cov)</span>
<span id="cb43-497"><a href="#cb43-497" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-498"><a href="#cb43-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-499"><a href="#cb43-499" aria-hidden="true" tabindex="-1"></a>To see what this means, consider the bi-variate case. Suppose height and weight are distributed $\mu = \begin{pmatrix} 175 <span class="sc">\\</span> 71 \end{pmatrix}$ with variance-covariance matrix $\boldsymbol{\Sigma} = \begin{pmatrix} 550 &amp; 40 <span class="sc">\\</span> 40 &amp; 8 \end{pmatrix}$. The mean of height, $Y$ given weight $\textbf{X} = \textbf{x}_2$ is $\textbf{M}_{\textbf{Y.x}} = 175 + \frac{40}{8} (x_2 - 71)$. The variance is $\textbf{v}_{\textbf{Y.x}} = 550 = \frac{40^2}{8}$ (a constant).</span>
<span id="cb43-500"><a href="#cb43-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-501"><a href="#cb43-501" aria-hidden="true" tabindex="-1"></a>The conditional mean of $\textbf{Y}$ given $\textbf{X} = \textbf{x}$ is $\mu_{\textbf{Y.x}} = E(\textbf{Y|X=x})$. If the distribution is multivariate normal, then the conditional mean equals its overall mean plus an adjustment based how $\textbf{Y}$ varies with $\textbf{X}$ as a fraction of the variation of $\textbf{X}$ multiplied by the distance of $\textbf{X}$ from its mean.</span>
<span id="cb43-502"><a href="#cb43-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-503"><a href="#cb43-503" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-504"><a href="#cb43-504" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb43-505"><a href="#cb43-505" aria-hidden="true" tabindex="-1"></a>\mu_{\textbf{Y.x}} = E(\textbf{Y|X=x}) = \mu_\textbf{Y} + \boldsymbol{\Sigma}_\textbf{YX} \boldsymbol{\Sigma}_\textbf{X}^{-1} (\textbf{x} - \boldsymbol{\mu}_\textbf{X})</span>
<span id="cb43-506"><a href="#cb43-506" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb43-507"><a href="#cb43-507" aria-hidden="true" tabindex="-1"></a>(<span class="sc">\#</span>eq:s06-conditional-mean)</span>
<span id="cb43-508"><a href="#cb43-508" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-509"><a href="#cb43-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-510"><a href="#cb43-510" aria-hidden="true" tabindex="-1"></a>Note how if $\textbf{x} = \boldsymbol{\mu}_\textbf{X}$ the conditional mean equals the overall mean. If the $\textbf{X}$'s are generally positively correlated with the $\textbf{Y}$'s, then $\textbf{x} &gt; \boldsymbol{\mu}_\textbf{X}$ results in a positive adjustment, and vice-versa.</span>
<span id="cb43-511"><a href="#cb43-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-512"><a href="#cb43-512" aria-hidden="true" tabindex="-1"></a>https://online.stat.psu.edu/stat505/lesson/6/6.1</span>
<span id="cb43-513"><a href="#cb43-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-514"><a href="#cb43-514" aria-hidden="true" tabindex="-1"></a>The conditional variance is $\sigma_{\textbf{Y.x}}^2 =E<span class="sc">\{</span> (\textbf{Y} - \boldsymbol{\mu}_{\textbf{Y.x}})^2 | \textbf{X = x} \}$. The conditional covariance between $Y_i$ and $Y_j$ is $\sigma_{i,j.\textbf{x}} =E\{ (Y_i - \mu_{Y_i.x})(Y_j - \mu_{Y_j.x}) | \textbf{X = x} <span class="sc">\}</span>$. The variances and covariances can be collected into a variance-covariance matrix.</span>
<span id="cb43-515"><a href="#cb43-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-516"><a href="#cb43-516" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-517"><a href="#cb43-517" aria-hidden="true" tabindex="-1"></a>\boldsymbol{\Sigma}_{\textbf{Y}.\textbf{x}} = \begin{pmatrix} </span>
<span id="cb43-518"><a href="#cb43-518" aria-hidden="true" tabindex="-1"></a>\sigma_{Y_{1}.\textbf{X}} &amp; \sigma_{12.\textbf{X}} &amp; \cdots &amp; \sigma_{1p.\textbf{X}} <span class="sc">\\</span></span>
<span id="cb43-519"><a href="#cb43-519" aria-hidden="true" tabindex="-1"></a>\sigma_{21.\textbf{X}} &amp; \sigma_{Y_{2}.\textbf{X}} &amp; \cdots &amp; \sigma_{2p.\textbf{X}} <span class="sc">\\</span></span>
<span id="cb43-520"><a href="#cb43-520" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span></span>
<span id="cb43-521"><a href="#cb43-521" aria-hidden="true" tabindex="-1"></a>\sigma_{p1.\textbf{X}} &amp; \sigma_{p2.\textbf{X}} &amp; \cdots &amp; \sigma_{Y_{p}.\textbf{X}} </span>
<span id="cb43-522"><a href="#cb43-522" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb43-523"><a href="#cb43-523" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-524"><a href="#cb43-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-525"><a href="#cb43-525" aria-hidden="true" tabindex="-1"></a>Divide the covariance of two variables by the product of their standard deviations to get the _unconditional correlation_, $r_{jk} = \frac{s_{jk}}{s_j s_k}$. $r_{jk}$ estimates the population correlation, $\rho_{jk} = \frac{\sigma_{jk}}{\sigma_j \sigma_k}$. The _partial correlation_ is $\rho_{jk.\textbf{X}} = \frac{\sigma_{jk.\textbf{X}}}{\sigma_{Y_j.\textbf{X}} \sigma_{Y_k.\textbf{X}}}$</span>
<span id="cb43-526"><a href="#cb43-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-527"><a href="#cb43-527" aria-hidden="true" tabindex="-1"></a>Test the null hypothesis that $H_0: \rho_{jk} = 0$ with a *t*-test where</span>
<span id="cb43-528"><a href="#cb43-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-529"><a href="#cb43-529" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-530"><a href="#cb43-530" aria-hidden="true" tabindex="-1"></a>t = r_{jk}\sqrt{\frac{n-2}{1-r_{jk}^2}}</span>
<span id="cb43-531"><a href="#cb43-531" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-532"><a href="#cb43-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-533"><a href="#cb43-533" aria-hidden="true" tabindex="-1"></a>is distributed with $n - 2$ degrees of freedom. The 95% CI is complicated by the <span class="co">[</span><span class="ot">-1, 1</span><span class="co">]</span> bounding of the data which creates skew. The 95% CI is formed from the _Fisher transformation_ of the data,</span>
<span id="cb43-534"><a href="#cb43-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-535"><a href="#cb43-535" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-536"><a href="#cb43-536" aria-hidden="true" tabindex="-1"></a>z_{jk} = \frac{1}{2} \log \frac{1 + r_{jk}}{1 - r_{jk}}</span>
<span id="cb43-537"><a href="#cb43-537" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-538"><a href="#cb43-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-539"><a href="#cb43-539" aria-hidden="true" tabindex="-1"></a>$z_{jk}$ is distributed normally with variance $\frac{1}{n - 3}$.</span>
<span id="cb43-540"><a href="#cb43-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-541"><a href="#cb43-541" aria-hidden="true" tabindex="-1"></a>**Quick Example**. </span>
<span id="cb43-542"><a href="#cb43-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-543"><a href="#cb43-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb43-544"><a href="#cb43-544" aria-hidden="true" tabindex="-1"></a><span class="in"># 37x5 data set from [PSU STAT 505](https://online.stat.psu.edu/stat505/lesson/4/4.7).</span></span>
<span id="cb43-545"><a href="#cb43-545" aria-hidden="true" tabindex="-1"></a><span class="in">wechsler &lt;- readr::read_fwf(</span></span>
<span id="cb43-546"><a href="#cb43-546" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "./input/wechsler.txt", </span></span>
<span id="cb43-547"><a href="#cb43-547" aria-hidden="true" tabindex="-1"></a><span class="in">  col_positions = readr::fwf_widths(</span></span>
<span id="cb43-548"><a href="#cb43-548" aria-hidden="true" tabindex="-1"></a><span class="in">    c(2, 3, 3, 3, 3),</span></span>
<span id="cb43-549"><a href="#cb43-549" aria-hidden="true" tabindex="-1"></a><span class="in">    col_names = c("ID", "Information", "Similarities", "Arithmetic", "PictureCompletion")</span></span>
<span id="cb43-550"><a href="#cb43-550" aria-hidden="true" tabindex="-1"></a><span class="in">  ),</span></span>
<span id="cb43-551"><a href="#cb43-551" aria-hidden="true" tabindex="-1"></a><span class="in">  show_col_types = FALSE</span></span>
<span id="cb43-552"><a href="#cb43-552" aria-hidden="true" tabindex="-1"></a><span class="in">) </span></span>
<span id="cb43-553"><a href="#cb43-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-554"><a href="#cb43-554" aria-hidden="true" tabindex="-1"></a><span class="in"># Correlation between Information and Similarities</span></span>
<span id="cb43-555"><a href="#cb43-555" aria-hidden="true" tabindex="-1"></a><span class="in">cor(wechsler$Information, wechsler$Similarities)</span></span>
<span id="cb43-556"><a href="#cb43-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-557"><a href="#cb43-557" aria-hidden="true" tabindex="-1"></a><span class="in"># t.test with 95% CI.</span></span>
<span id="cb43-558"><a href="#cb43-558" aria-hidden="true" tabindex="-1"></a><span class="in">cor.test(wechsler$Information, wechsler$Similarities)</span></span>
<span id="cb43-559"><a href="#cb43-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-560"><a href="#cb43-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-561"><a href="#cb43-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-562"><a href="#cb43-562" aria-hidden="true" tabindex="-1"></a>The sum of the diagonal of any square matrix is called the _trace_. The trace of the covariance matrix is a single number that expresses the total dispersion of the data set.</span>
<span id="cb43-563"><a href="#cb43-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-564"><a href="#cb43-564" aria-hidden="true" tabindex="-1"></a>$$\mathrm{Trace}(S) = \sum_p S_{pp}$$</span>
<span id="cb43-565"><a href="#cb43-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-566"><a href="#cb43-566" aria-hidden="true" tabindex="-1"></a>The trace has the shortcoming of not taking the variable correlations into account. A data set can have a large trace, but really high correlations. Instead, the _generalized variance_ expresses total variation with the _determinant_.</span>
<span id="cb43-567"><a href="#cb43-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-568"><a href="#cb43-568" aria-hidden="true" tabindex="-1"></a>$$|S| = \sum_{j = 1}^p (-1)^{j+1} b_{1j} |B_{1j}|$$</span>
<span id="cb43-569"><a href="#cb43-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-570"><a href="#cb43-570" aria-hidden="true" tabindex="-1"></a>Build your intuition with the bivariate case. If variables $Y$ and $X$ have a multivariate normal distribution, the conditional distribution of $Y|X = x$ is normal with mean $\mu_Y + \frac{\sigma_{YX}}{\sigma_{XX}}(x - \mu_X)$ and variance $\sigma_{YY} - \frac{\sigma_{YX}^2}{\sigma_{XX}}$. For example, suppose $Y$ = height (in) and $X$ = weight (lbs) are distributed $\mu = \begin{pmatrix}175 <span class="sc">\\</span> 71 \end{pmatrix}$ with variance-covariance matrix $\boldsymbol{\Sigma} = \begin{pmatrix} 550 &amp; 40 <span class="sc">\\</span> 40 &amp; 8 \end{pmatrix}$. Conditioning on $X = x$, $\mu_{Y.x} = 175 + \frac{40}{8}(x - 71)$ and $\sigma_{Y.x} = 550 - \frac{40^2}{8}$.</span>
<span id="cb43-571"><a href="#cb43-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-572"><a href="#cb43-572" aria-hidden="true" tabindex="-1"></a>Extend this to the multivariate case. Let $\textbf{Y}$ be a set of outcomes (e.g., blood pressure and cholesterol) and $\textbf{X}$ be a set of conditioning variables (e.g., age, height, and weight). The multivariate conditional mean, $\mu_{\textbf{Y}.\textbf{x}}$, is </span>
<span id="cb43-573"><a href="#cb43-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-574"><a href="#cb43-574" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-575"><a href="#cb43-575" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb43-576"><a href="#cb43-576" aria-hidden="true" tabindex="-1"></a>E(\textbf{Y} | \textbf{X} = \textbf{x}) = \mu_{\textbf{Y}} + \boldsymbol{\Sigma}_{\textbf{YX}} \boldsymbol{\Sigma}_\textbf{X}^{-1}(\textbf{x} - \boldsymbol{\mu}_\textbf{X})</span>
<span id="cb43-577"><a href="#cb43-577" aria-hidden="true" tabindex="-1"></a>(<span class="sc">\#</span>eq:multivariate-conditional-mean)</span>
<span id="cb43-578"><a href="#cb43-578" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb43-579"><a href="#cb43-579" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-580"><a href="#cb43-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-581"><a href="#cb43-581" aria-hidden="true" tabindex="-1"></a>The multivariate conditional variance-covariance matrix of $\textbf{Y}$, $\Sigma_{\textbf{Y}.\textbf{x}}$, is</span>
<span id="cb43-582"><a href="#cb43-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-583"><a href="#cb43-583" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-584"><a href="#cb43-584" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb43-585"><a href="#cb43-585" aria-hidden="true" tabindex="-1"></a>E(\textbf{Y} | \textbf{X} = \textbf{x}) = \mu_{\textbf{Y}} + \boldsymbol{\Sigma}_{\textbf{YX}} \boldsymbol{\Sigma}_\textbf{X}^{-1}(\textbf{x} - \boldsymbol{\mu}_\textbf{X})</span>
<span id="cb43-586"><a href="#cb43-586" aria-hidden="true" tabindex="-1"></a>(<span class="sc">\#</span>eq:multivariate-conditional-mean)</span>
<span id="cb43-587"><a href="#cb43-587" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb43-588"><a href="#cb43-588" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-589"><a href="#cb43-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-590"><a href="#cb43-590" aria-hidden="true" tabindex="-1"></a> the mean of a set of outcomes, $\textbf{Y}$ (e.g., blood pressure and cholesterol) conditioned on a set of attributes, $\textbf{X}$ (e.g., age, height, and weight). Denote it as . Denote the conditional variance as $\sigma_{\textbf{Y}.x}^2 = \text{var}(\textbf{Y}|\textbf{X}=\textbf{x})$. It is equal to conditional squared difference from the mean, $E<span class="sc">\{</span>(\textbf{Y} - \boldsymbol{\mu}_{\textbf{Y}.\textbf{x}})^2|\textbf{X} = \textbf{x}\}$. Any two variables, $Y_i$ and $Y_j$ have a conditional covariance $\sigma_{i,j.\textbf{x}} = \text{cov}(Y_i,Y_j|\textbf{X} = \textbf{x})$. It is equal to $E\{ (Y_i - \mu_{Y_{i.x}}) (Y_j - \mu_{Y_{j.x}}) | \textbf{X} = \textbf{x}<span class="sc">\}</span>$. The set of all covariances is a matrix.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>