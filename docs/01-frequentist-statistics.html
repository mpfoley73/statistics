<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Frequentist Statistics – Statistical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-likelihood-statistics.html" rel="next">
<link href="./index.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-frequentist-statistics.html">Statistics</a></li><li class="breadcrumb-item"><a href="./01-frequentist-statistics.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Frequentist Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Inference</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-frequentist-statistics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Frequentist Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-likelihood-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Likelihood Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-bayesian-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Point Estimates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-one-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One-Sample</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pt1-group-differences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Group Differences</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-continuous-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Continuous ~ Binomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-continuous-binomial-pairwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Paired Samples t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-continuous-multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous ~ Multnomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-binomial-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binomial ~ Binomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-multinomial-multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multinomial ~ Multinomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-binomial-multinomial-pairwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Pairwise Discrete ~ Multinomial</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Association</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-association.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Association</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Reference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-matrix-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix Algebra</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#central-tendancy-and-dispersion" id="toc-central-tendancy-and-dispersion" class="nav-link active" data-scroll-target="#central-tendancy-and-dispersion"><span class="header-section-number">1.1</span> Central Tendancy and Dispersion</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing"><span class="header-section-number">1.2</span> Hypothesis Testing</a></li>
  <li><a href="#type-i-and-ii-errors" id="toc-type-i-and-ii-errors" class="nav-link" data-scroll-target="#type-i-and-ii-errors"><span class="header-section-number">1.3</span> Type I and II Errors</a></li>
  <li><a href="#statistical-power" id="toc-statistical-power" class="nav-link" data-scroll-target="#statistical-power"><span class="header-section-number">1.4</span> Statistical Power</a></li>
  <li><a href="#power-analyses" id="toc-power-analyses" class="nav-link" data-scroll-target="#power-analyses"><span class="header-section-number">1.5</span> Power Analyses</a>
  <ul>
  <li><a href="#one-sample-prop-test-greater" id="toc-one-sample-prop-test-greater" class="nav-link" data-scroll-target="#one-sample-prop-test-greater">One-Sample Prop Test (greater)</a></li>
  <li><a href="#one-sample-prop-test-two-sided" id="toc-one-sample-prop-test-two-sided" class="nav-link" data-scroll-target="#one-sample-prop-test-two-sided">One-Sample Prop Test (two-sided)</a></li>
  <li><a href="#two-sample-prop-test-greater" id="toc-two-sample-prop-test-greater" class="nav-link" data-scroll-target="#two-sample-prop-test-greater">Two-Sample Prop Test (greater)</a></li>
  <li><a href="#two-sample-prop-test-two-sided" id="toc-two-sample-prop-test-two-sided" class="nav-link" data-scroll-target="#two-sample-prop-test-two-sided">Two-Sample Prop Test (two-sided)</a></li>
  <li><a href="#one-sample-t-test-greater" id="toc-one-sample-t-test-greater" class="nav-link" data-scroll-target="#one-sample-t-test-greater">One-sample t-test (greater)</a></li>
  <li><a href="#one-sample-t-test-two-sided" id="toc-one-sample-t-test-two-sided" class="nav-link" data-scroll-target="#one-sample-t-test-two-sided">One-sample t-test (two-sided)</a></li>
  <li><a href="#indep-samples-t-test-greater" id="toc-indep-samples-t-test-greater" class="nav-link" data-scroll-target="#indep-samples-t-test-greater">Indep Samples t-test (greater)</a></li>
  <li><a href="#indep-samples-t-test-two-sided" id="toc-indep-samples-t-test-two-sided" class="nav-link" data-scroll-target="#indep-samples-t-test-two-sided">Indep Samples t-test (two-sided)</a></li>
  </ul></li>
  <li><a href="#p-value-intuition" id="toc-p-value-intuition" class="nav-link" data-scroll-target="#p-value-intuition"><span class="header-section-number">1.6</span> p-value Intuition</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-frequentist-statistics.html">Statistics</a></li><li class="breadcrumb-item"><a href="./01-frequentist-statistics.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Frequentist Statistics</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Frequentist Statistics</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="central-tendancy-and-dispersion" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="central-tendancy-and-dispersion"><span class="header-section-number">1.1</span> Central Tendancy and Dispersion</h2>
<p>Suppose you have a data set with <span class="math inline">\(j = [1 .. p]\)</span> variables. Each variable will have a distribution that can be characterized by its mean and variance. If you consider them together, you can see how variance and covariance are related. For the matrix algebra that follows, assume the data are organized in <em>rows</em>, so <span class="math inline">\(X_j\)</span> is a <em>row vector</em> of <span class="math inline">\(n\)</span> observations. <span class="math inline">\(X_{ij}\)</span> refers to column <span class="math inline">\(i\)</span> of row <span class="math inline">\(j\)</span>.</p>
<p>The mean of row vector <span class="math inline">\(X_j\)</span> is <span class="math inline">\(\bar{x}_j = \frac{1}{n} \sum_{i = 1}^n X_{ij}\)</span>. <span class="math inline">\(\bar{x}_j\)</span> estimates the population mean, <span class="math inline">\(\mu_j = E(X_j)\)</span>. The collection of means are a column vector.</p>
<p><span class="math display">\[\boldsymbol{\bar{x}} = \begin{pmatrix} \bar{x}_1 \\ \bar{x}_2 \\ \cdots \\ \bar{x}_p  \end{pmatrix}\]</span></p>
<p>The variance of row vector <span class="math inline">\(X_j\)</span> is the average squared difference from the mean, <span class="math inline">\(s_j^2 = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j)^2\)</span>. <span class="math inline">\(s_j^2\)</span> estimates the population variance, <span class="math inline">\(\sigma_j^2 = E(X_j - \mu_j)^2\)</span>. Again, the collection is represented as a column vector,</p>
<p><span class="math display">\[\boldsymbol{s}^2 = \begin{pmatrix} s_1^2 \\ s_2^2 \\ \cdots \\ s_p^2  \end{pmatrix}\]</span></p>
<p>The square root of <span class="math inline">\(s^2\)</span> is called the standard deviation. The concept of variance can be extended to pairs of variables, <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>. The covariance of <span class="math inline">\(X_j\)</span> and <span class="math inline">\(X_k\)</span> is the average product of differences from their respective means, <span class="math inline">\(s_{jk} = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j) (X_{ik} - \bar{x}_k)\)</span>. <span class="math inline">\(s_{jk}\)</span> estimates the population covariance, <span class="math inline">\(\sigma_{jk} = E\{ (X_{ij} - \mu_j) (X_{ik} - \mu_k)\}\)</span>. Notice how the sign of <span class="math inline">\(s_{jk}\)</span> tells you how the variables relate. It’s positive if when one variable is larger than its mean, so is the other. It’s zero if the value of one variable tells you nothing about the other. It can be shown that <span class="math inline">\(s_{jk}\)</span> is equivalently expressed as</p>
<p><span class="math display">\[
s_{jk} = \frac{1}{n-1} \left[ \sum_{i=1}^n X_{ij}X_{ik} - \frac{\sum_{i = 1}^n X_{ij} \sum_{i = 1}^n X_{ik}}{n} \right]
\]</span></p>
<p>This is how it is actually calculated. The first term is dot product, <span class="math inline">\(X_j \cdot X_k\)</span>. The second term is the product of the averages. Use matrix algebra to generalize across all <span class="math inline">\(p\)</span> variables to form the <em>variance-covariance matrix</em>.</p>
<p><span class="math display">\[
\begin{align}
S &amp;= \frac{1}{n-1} \sum_{i=1}^n (X_i - \bar{x}) (X_i - \bar{x})' \\
&amp;= \frac{1}{n-1} \left[ \sum_{i=1}^n X_i X_i^{'} - \frac{\sum_{i = 1}^n X_i \sum_{i = 1}^n X_i}{n} \right]
\end{align}
\]</span></p>
<p><span class="math inline">\(S\)</span> estimates the population variance-covariance matrix, <span class="math inline">\(\boldsymbol{\Sigma}\)</span>. Divide the covariances by their product of their standard deviations to get their <em>correlation</em>, <span class="math inline">\(r_{jk} = \frac{s_{jk}}{s_j s_k}\)</span>. <span class="math inline">\(r_{jk}\)</span> estimates the population correlation, <span class="math inline">\(\rho_{jk} = \frac{\sigma_{jk}}{\sigma_j \sigma_k}\)</span>.</p>
</section>
<section id="hypothesis-testing" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="hypothesis-testing"><span class="header-section-number">1.2</span> Hypothesis Testing</h2>
<p><em>P</em>-values express how surprising a summary measure is given the null hypothesis (H0). Suppose you hypothesize that IQs have increased from their intended mean of <span class="math inline">\(\mu\)</span> = 100, <span class="math inline">\(\sigma\)</span> = 15. H0 is <span class="math inline">\(\mu_0\)</span> = 100 with alternative H1 that <span class="math inline">\(\mu\)</span> &gt; 100. Suppose also that you are <em>right</em>: <span class="math inline">\(\mu\)</span> is actually 106. The presumed and actual distribution of IQs would look like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>According to the Central Limit Theorem (CLM), repeated samples of size <em>n</em> from a large population will yield <span class="math inline">\(\bar{x}\)</span> values that approach a normal distribution centered at <span class="math inline">\(\mu\)</span> with a standard deviation equal to the the <em>standard error</em>, <span class="math inline">\(SE = \frac{\sigma}{\sqrt{n}} = \frac{15}{\sqrt{30}}\)</span> = 2.7. Repeated samples would be distributed <span class="math inline">\(\sim N(100, 2.7^2).\)</span></p>
<p>Suppose you take a random sample of <em>n</em> = 30 IQs from the population and measure <span class="math inline">\(\bar{x}\)</span> = 104, SD = 15.2. How surprising is this if H0 is true? I.e., what is the <em>probability</em> of observing an <span class="math inline">\(\bar{x}\)</span> of 104 if <span class="math inline">\(\mu\)</span> is 100 and <span class="math inline">\(\sigma\)</span> is 15? The situation looks like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <span class="math inline">\(\alpha\)</span> region starts at <code>qnorm(.05, 100, 2.7, lower.tail = FALSE)</code> = 104.5. <span class="math inline">\(\bar{x}\)</span> would have had to be at least that large to reject H0. The probability of measuring <span class="math inline">\(\bar{x} \ge 104\)</span> is derived from the <em>z</em> score, <span class="math inline">\(z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}} = \frac{104 - 100}{2.7}\)</span> = 1.5. The probability of measuring a <em>z</em> score that high given H0 is <span class="math inline">\(P(z \ge 1.5)\)</span> = 0.072, meaning 7.2% of the area under the null distribution is to the right of 104. Therefore, do not reject H0 at the <span class="math inline">\(\alpha\)</span> = .05 level of significance.</p>
</section>
<section id="type-i-and-ii-errors" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="type-i-and-ii-errors"><span class="header-section-number">1.3</span> Type I and II Errors</h2>
<p>Either H0 (<span class="math inline">\(\mu = 106\)</span>) or H1 (<span class="math inline">\(\mu \ge 106\)</span>) is correct. You must choose to either reject or not reject H0. That means there are four possible states at the end of your analysis. If your summary measure is extreme enough for you to declare a “positive” result and reject H0, you are either correct (true positive) or incorrect (false positive). False positives are called <em>Type I errors</em>. Alternatively, if it is <em>not</em> extreme enough, you are either correct (true negative) or incorrect (false negative). False negatives are called <em>Type II errors</em>.</p>
<p>The probabilities of landing in these four states depend on your chosen significance level, <span class="math inline">\(\alpha\)</span>, and on the statistical power of the study, 1 - <span class="math inline">\(\beta\)</span>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 36%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>H0 True</th>
<th>H0 False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Positive test, reject H0.</td>
<td>False Positive <br>Type I Error<br> Probability = <span class="math inline">\(\alpha\)</span></td>
<td>True Positive <br>Good Call! <br> Probability = 1 - <span class="math inline">\(\beta\)</span></td>
</tr>
<tr class="even">
<td>Negative test, do <em>not</em> reject H0.</td>
<td>True Negative <br> Good Call!<br> Probability = (<span class="math inline">\(1 - \alpha\)</span>)</td>
<td>False Negative <br>Type II Error <br>Probability = <span class="math inline">\(\beta\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\alpha\)</span> is the expected Type I error rate - extreme summary measures occurring by chance when there is no effect to measure. <span class="math inline">\(\beta\)</span> is the expected Type II error rate - summary measures that by chance were not extreme enough to reject H0 even though there is an actual effect.</p>
<p>If the population mean really was <span class="math inline">\(\mu\)</span> = 100, any sample mean greater than 104.5 would mistakenly reject H0 at the <span class="math inline">\(\alpha\)</span> = .05 significance level, a Type I error. However, the population mean is actually <span class="math inline">\(\mu\)</span> = 106, and our measured <span class="math inline">\(\bar{x}\)</span> = 104 only achieved a <em>p</em>-value of 0.072, so we failed to reject H0, a Type II error.</p>
<p>Had the sample size been larger, the study would have had the power to reject H0. Here’s the plot with <em>n</em> = 50. The null and actual distributions are tighter, and the <span class="math inline">\(\alpha\)</span> region starts at 103.5.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The area under the actual distribution to the left of <span class="math inline">\(alpha\)</span> is labeled <span class="math inline">\(\beta\)</span>. It’s the Type II error zone. You don’t usually see much discussion of <span class="math inline">\(\beta\)</span> in reports because <span class="math inline">\(\beta\)</span> is based on the unknown actual population distribution. <span class="math inline">\(\beta\)</span> is relevant at the <em>design</em> stage. It informs how large your sample needs to be in order to reject H0 given some expected <span class="math inline">\(\bar{x}\)</span>. Interestingly, you can see how there can be such a thing as too much power. If <em>n</em> is large enough, you can reject H0 with even a trivial effect size.</p>
</section>
<section id="statistical-power" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="statistical-power"><span class="header-section-number">1.4</span> Statistical Power</h2>
<p>The ability to detect a difference when it exists (the true positive) is called the power of the test. It’s measured by the area outside of <span class="math inline">\(\beta\)</span>. Changing <em>n</em> from 30 to 50 reduced the area in the <span class="math inline">\(\beta\)</span> region, increasing the power of the test.</p>
<p>Statistical power is an increasing function of sample size, effect size, and significance level. The positive association with significance level means there is a trade-off between Type I and Type II error rates. A small <span class="math inline">\(\alpha\)</span> sets a high bar for rejecting H0, but you run the risk of failing to appreciate a <em>real</em> difference. On the other hand, a large <span class="math inline">\(\alpha\)</span> sets a low bar for rejecting H0, but you run the risk of mistaking a random difference as real.</p>
<p>The 1 - <span class="math inline">\(\beta\)</span> statistical power threshold is usually set at .80, similar to the <span class="math inline">\(\alpha\)</span> = .05 level of significance threshold convention. Given a real effect, a study with a statistical power of .80 will only find a positive test result 80% of the time. You may think more power is better, but beware that with a large enough sample size, even trivial effect sizes may yield a positive test result. You need to consider both sides of this coin.</p>
<p>A <em>power analysis</em> determines the sample size required to detect a threshold effect size given an <span class="math inline">\(\alpha\)</span> level of significance. A power analysis expresses the relationship among four components. If you know any three, it tells you the fourth: The components are <em>n</em>, <span class="math inline">\(\alpha\)</span>, , 1 - <span class="math inline">\(\beta\)</span>, and Cohen’s <em>d</em> = <span class="math inline">\((\bar{x} - \mu_0)/\sigma\)</span>.</p>
<p>Suppose you set power at .80, significance level at .05, and <em>n</em> = 30. What effect size will this design detect?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 30
              d = 0.464949
      sig.level = 0.05
          power = 0.8
    alternative = greater</code></pre>
</div>
</div>
<p>An effect size of <em>d</em> = 0.465 will fall in the <span class="math inline">\(\alpha\)</span> = .05 region with probability 1 - <span class="math inline">\(\beta\)</span> = .80 if the sample size is <em>n</em> = 30. Multiply <em>d</em> = 0.465 by <span class="math inline">\(\sigma\)</span> = 15 to convert to the IQ units, 7.0. More likely, you will use the power test to detect the required sample size. Suppose you set <span class="math inline">\(1 - \beta\)</span> = .8 and <span class="math inline">\(\alpha\)</span> = .05, and want to detect an effect size of <span class="math inline">\(5 / 15\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 57.02048
              d = 0.3333333
      sig.level = 0.05
          power = 0.8
    alternative = greater</code></pre>
</div>
</div>
<p>You need a larger sample, <em>n</em> = 58. You can use the power test formula for various <em>n</em> sizes to see the relationship with effect size. <em>Note: the y-axis multiplies Cohen’s d by <span class="math inline">\(\sigma\)</span> to get the effect size in original units</em>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The dashed lines show a sample size of 30 is required to detect an effect size of 7 at a .05 significance level with 80% probability.</p>
</section>
<section id="power-analyses" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="power-analyses"><span class="header-section-number">1.5</span> Power Analyses</h2>
<section id="one-sample-prop-test-greater" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="one-sample-prop-test-greater">One-Sample Prop Test (greater)</h3>
<p>How many people would you need to survey to detect a clear majority of support for an issue? <span class="math inline">\(H_0\)</span> is 50% (no majority) and <span class="math inline">\(H_a\)</span> is &gt;= 50%. By “clear majority”, you might mean “at least 10 percentage points”. If the majority is there, but it’s less than 60%, you are okay with not rejecting <span class="math inline">\(H_0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.p.test</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.2013579
              n = 152.4863
      sig.level = 0.05
          power = 0.8
    alternative = greater</code></pre>
</div>
</div>
<p>If you repeatedly survey random samples of 153 people from a population where 60% support the topic, you should expect to reject H0 80% of the time. I.e., you expect at least 87 (57%) approvals 80% of the time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 87</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>(crit_pct <span class="ot">&lt;-</span> crit_val <span class="sc">/</span> n)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.5686275</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see this in a plot of the theoretical distributions for samples of size 153 from populations centered at 50% and 60%. ~20% of the 60% curve is to the left of the critical value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> crit_val, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2381819</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="one-sample-prop-test-two-sided" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="one-sample-prop-test-two-sided">One-Sample Prop Test (two-sided)</h3>
<p>How many people would you need to survey to detect a clear preference either way? Set an effect size that detects the difference from 50% (no preference) to 40% or 60%. This is a two-sided test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.p.test</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.2013579
              n = 193.5839
      sig.level = 0.05
          power = 0.8
    alternative = two.sided</code></pre>
</div>
</div>
<p>You need more people for a two-sided test, 194, and the critical values are further from 50%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>(crit_val1 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">025</span>, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 83</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>(crit_pct1 <span class="ot">&lt;-</span> crit_val1 <span class="sc">/</span> n)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.4278351</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>(crit_val2 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">975</span>, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 111</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>(crit_pct2 <span class="ot">&lt;-</span> crit_val2 <span class="sc">/</span> n)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.5721649</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here are the theoretical distributions.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\beta\)</span> ~20% of the area of <em>Actual = .4</em> is to the right of 43% and <span class="math inline">\(\beta\)</span> ~20% of the area of <em>Actual = .6</em> is to the left of 57%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> crit_val1, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1932935</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> crit_val2, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2356584</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="two-sample-prop-test-greater" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="two-sample-prop-test-greater">Two-Sample Prop Test (greater)</h3>
<p>How many people would you need to survey to detect a clear difference in support for an issue between two groups? <span class="math inline">\(H_0\)</span> is that groups <em>A</em> and <em>B</em> have the same support rate. As before, you set a minimum effect size of 10 percentage points. A one-sided test assesses whether <em>A</em> has a higher (lower) support rate than <em>B</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.2p.test</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Difference of proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.2013579
              n = 304.9725
      sig.level = 0.05
          power = 0.8
    alternative = greater

NOTE: same sample sizes</code></pre>
</div>
</div>
<p>Whoa, we need twice as many people <em>for each group</em>! Why is that? Recall from <a href="https://mpfoley73.github.io/statistics/08-binomial-binomial.html">your notes</a> that the two proportions test is a test on the distribution of proportion difference, <span class="math inline">\(d = p_1 - p_2\)</span>. The sampling distribution of <span class="math inline">\(d\)</span> has a standard error <span class="math inline">\(SE = \sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}}\)</span>. The test statistic is <span class="math inline">\(Z = (d-d_0) / SE\)</span>.</p>
<p>There is a similar test that allows for unequal group sample sizes. If the first group is 305, so will be the second group. If the first group is 400, the second needs to be 247. The minimum sample size is always going to be for equal sample sizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.2p2n.test</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">400</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     difference of proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.2013579
             n1 = 400
             n2 = 246.4288
      sig.level = 0.05
          power = 0.8
    alternative = greater

NOTE: different sample sizes</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">5</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">5</span>) <span class="sc">/</span> n <span class="sc">+</span> .<span class="dv">6</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">6</span>) <span class="sc">/</span> n)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.06592883</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="two-sample-prop-test-two-sided" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="two-sample-prop-test-two-sided">Two-Sample Prop Test (two-sided)</h3>
<p>How many people would you need to survey to detect a clear difference in support for an issue between two groups? <span class="math inline">\(H_0\)</span> is that groups <em>A</em> and <em>B</em> have the same support rate. Again, suppose you care about a difference of at least a 10 percentage points. In the two-sided test, group <em>A</em> can be a higher <em>or lower</em> than <em>B</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.2p.test</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Difference of proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.2013579
              n = 387.1677
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: same sample sizes</code></pre>
</div>
</div>
<p>The two-sided test requires a larger sample and the critical values are a little further from zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">5</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">5</span>) <span class="sc">/</span> n <span class="sc">+</span> .<span class="dv">6</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">6</span>) <span class="sc">/</span> n)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>(crit_val1 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">025</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.06965147</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>(crit_val2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">025</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.06965147</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="one-sample-t-test-greater" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="one-sample-t-test-greater">One-sample t-test (greater)</h3>
<p>How many people would you need to survey to detect a clear level of agreement for an item measured in a 7-level Likert scale? This is an ordinal variable, but you can treat it as continuous. <span class="math inline">\(H_0\)</span> is 4 (middle value) and <span class="math inline">\(H_a\)</span> is &gt;4. By “clear agreement”, you might mean “at least .5 points”. If true average is &gt;4, but less than 4.5, you are okay with not rejecting <span class="math inline">\(H_0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> sd</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 26.13753
              d = 0.5
      sig.level = 0.05
          power = 0.8
    alternative = greater</code></pre>
</div>
</div>
<p>If you repeatedly survey random samples of 27 people from a population where the average preference is level is 4.5 of 7, you should expect to reject H0 80% of the time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.705618</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>(crit_rating <span class="ot">&lt;-</span> crit_val <span class="sc">*</span> se <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.328246</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see this in a plot of the theoretical distributions for samples of size 27 from populations centered at 4 and 4.5. ~20% of the mean 4.5 curve is to the left of the critical value.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="one-sample-t-test-two-sided" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="one-sample-t-test-two-sided">One-sample t-test (two-sided)</h3>
<p>How many people would you need to survey to detect a clear level of preference for an item measured in a 7-level Likert scale? Treating the ordinal variable as continuous. <span class="math inline">\(H_0\)</span> is 4 (middle value) and <span class="math inline">\(H_a\)</span> is &lt;&gt;4. “Clear agreement” might mean “at least .5 points” either direction. If true average is between 3.5 and 4.5, you are okay with not rejecting <span class="math inline">\(H_0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> sd</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 33.36713
              d = 0.5
      sig.level = 0.05
          power = 0.8
    alternative = two.sided</code></pre>
</div>
</div>
<p>The sample size increased from 27 to 34. If you repeatedly survey random samples of 34 people from a population where the average preference is level is 3.5 or 4.5 of 7, you should expect to reject H0 80% of the time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>(crit_val1 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -1.69236</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>(crit_val2 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.69236</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>(crit_rating1 <span class="ot">&lt;-</span> crit_val1 <span class="sc">*</span> se <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.709763</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>(crit_rating2 <span class="ot">&lt;-</span> crit_val2 <span class="sc">*</span> se <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.290237</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see this in a plot of the theoretical distributions for samples of size 34 from populations centered at 3.5, 4 and 4.5. ~20% of the mean 4.5 curve and mean 3.5 curve is to the left of the critical value.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="indep-samples-t-test-greater" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="indep-samples-t-test-greater">Indep Samples t-test (greater)</h3>
<p>How many people would you need to survey to detect a clear group difference in agreement for an item measured in a 7-level Likert scale? <span class="math inline">\(H_0\)</span> is that groups <em>A</em> and <em>B</em> have the same average rating. As before, you set a minimum effect size of .5 points. The one-sided test assesses whether <em>A</em> has a higher (lower) average than <em>B</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> s1</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t2n.test</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">54</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     t test power calculation 

             n1 = 54
             n2 = 46.80756
              d = 0.5
      sig.level = 0.05
          power = 0.8
    alternative = greater</code></pre>
</div>
</div>
<p>We need about twice as many people <em>for each group</em>! Recall from <a href="https://mpfoley73.github.io/statistics/05-continuous-binomial.html">your notes</a> that the independent samples t-test is a test on the distribution of the difference in means, <span class="math inline">\(\hat{d} = \bar{x}_1 - \bar{x}_2\)</span>. The sampling distribution of <span class="math inline">\(d\)</span> has a standard error <span class="math inline">\(SE = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\)</span>. The test statistic is <span class="math inline">\(T = (\hat{d}-d_0) / SE\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">54</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n2)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> ((n1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sp2) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.660391</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>(crit_diff <span class="ot">&lt;-</span> crit_val <span class="sc">*</span> SE)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3312267</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="indep-samples-t-test-two-sided" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="indep-samples-t-test-two-sided">Indep Samples t-test (two-sided)</h3>
<p>How many people would you need to survey to detect a clear group difference in agreement for an item measured in a 7-level Likert scale? <span class="math inline">\(H_0\)</span> is that groups <em>A</em> and <em>B</em> have the same average rating. As before, you set a minimum effect size of .5 points. The two-sided test assesses whether <em>A</em> has a different average than <em>B</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> s1</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t2n.test</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">54</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     t test power calculation 

             n1 = 54
             n2 = 77.74746
              d = 0.5
      sig.level = 0.05
          power = 0.8
    alternative = two.sided</code></pre>
</div>
</div>
<p>If <span class="math inline">\(n_1\)</span> is 54, then <span class="math inline">\(n_2\)</span> needs to be 78 - higher than the one-sided test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">54</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n2)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> ((n1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sp2) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>(crit_val_l <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -1.656659</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>(crit_val_u <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.656659</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>(crit_diff_l <span class="ot">&lt;-</span> crit_val_l <span class="sc">*</span> SE)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.2932757</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>(crit_diff_u <span class="ot">&lt;-</span> crit_val_u <span class="sc">*</span> SE)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2932757</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="p-value-intuition" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="p-value-intuition"><span class="header-section-number">1.6</span> p-value Intuition</h2>
<p>What distribution of p-values would you expect if there <em>is</em> a true effect and you repeated the study many times? What if there is <em>no</em> true effect? The answer is completely determined by the statistical power of the study.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>To see this, run 100,000 simulations of an experiment measuring the average IQ from a sample of size <em>n</em> = 26. The samples will be 26 random values from the normal distribution centered at 106 with a standard deviation of 15. H0 is <span class="math inline">\(\mu\)</span> = 100.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 100,000 random samples of IQ simulations from a normal distribution where</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SIGMA = 15. True population value is 100, but we'll try other values.</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="fl">1E5</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>SIGMA <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>run_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">MU_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">26</span>) {</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n_sims) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">map</span>(i, <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> MU_0, <span class="at">sd =</span> SIGMA)),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">z =</span> <span class="fu">map</span>(x, <span class="sc">~</span> <span class="fu">t.test</span>(., <span class="at">mu =</span> mu)),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">p =</span> <span class="fu">map_dbl</span>(z, <span class="sc">~</span> .x<span class="sc">$</span>p.value),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">x_bar =</span> <span class="fu">map_dbl</span>(x, mean)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(x_bar, p)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The null hypothesis is that the average IQ is 100. Our rigged simulation finds an average IQ of 106 - an effect size of 6.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sim_106_26 <span class="ot">&lt;-</span> <span class="fu">run_sim</span>(<span class="at">MU_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">26</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sim_106_26)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Rows: 100,000</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Columns: 2</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="do">## $ x_bar &lt;dbl&gt; 112.4862, 101.5958, 104.4396, 106.2315, 102.1960, 108.6005, 104.…</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $ p     &lt;dbl&gt; 0.0001718698, 0.6059147572, 0.0985672856, 0.0428457450, 0.443911…</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sim_106_26<span class="sc">$</span>x_bar)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 105.9953</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The statistical power achieved by the simulations is 50%. That is, the typical simulation detected the effect size of 6 at the .05 significance level about 50% of the time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">26</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> (<span class="dv">106</span> <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 26
              d = 0.4
      sig.level = 0.05
          power = 0.5004646
    alternative = two.sided</code></pre>
</div>
</div>
<p>That means that given a population with an average IQ of 106, a two-sided hypothesis test of H0: <span class="math inline">\(\mu\)</span> = 100 from a sample of size 26 will measure an <span class="math inline">\(\bar{x}\)</span> with a <em>p</em>-value under .05 only 50% of the time. You can see that in this histogram of <em>p</em>-values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sim_106_26 <span class="sc">%&gt;%</span> <span class="fu">plot_sim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Had there been no effect to observe, you’d expect all <em>p</em>-values to be equally likely, so the 20 bins would all have been 5% of the number of simulations – i.e., <em>uniformly distributed under the null</em>. This is called “0 power”, although 5% of the <em>p</em>-values will still be significant at the .05 level. The 5% of <em>p</em>-values &lt; .05 is the Type II error rate - that probability of a positive test result when there is no actual effect to observe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">MU_0 =</span> <span class="dv">100</span>, <span class="at">n =</span> <span class="dv">26</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_sim</span>(<span class="at">MU_0 =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If you want a higher powered study that would detect the effect at least 80% of the time (the normal standard), you’ll need a higher sample size. How high? Conduct the power analysis again, but specify the power while leaving out the sample size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> (<span class="dv">106</span> <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 51.00945
              d = 0.4
      sig.level = 0.05
          power = 0.8
    alternative = two.sided</code></pre>
</div>
</div>
<p>You need 51 people (technically, you might want to round up to 52). Here’s what that looks like. 80% of <em>p</em>-values are below .05 now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">MU_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_sim</span>(<span class="at">MU_0 =</span> <span class="dv">106</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-frequentist-statistics_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>So far, we’ve discovered that when there <em>is</em> an effect, the probability that the measure <em>p</em>-value is under the <span class="math inline">\(\alpha\)</span> significance level equals the <em>power of the study</em>, 1 - <span class="math inline">\(\beta\)</span> - the <em>true positive</em> rate, and <span class="math inline">\(\beta\)</span> will be above the <span class="math inline">\(\alpha\)</span> level - the <em>false negative</em> rate. We’ve also discovered that when there is <em>no</em> effect, all <em>p</em>-values are equally likely, so <span class="math inline">\(\alpha\)</span> of them will be below the <span class="math inline">\(alpha\)</span> level of significance - the <em>false positive</em> rate, and 1 - <span class="math inline">\(\alpha\)</span> will be above <span class="math inline">\(\alpha\)</span> - the <em>true negative</em> rate.</p>
<p>It’s not the case that all p-values below 0.05 are support for the alternative hypothesis. If the statistical power is high enough, a <em>p</em>-value just under .05 can be even <em>less</em> likely under the null hypothesis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">MU_0 =</span> <span class="dv">108</span>, <span class="at">n =</span> <span class="dv">51</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bin =</span> <span class="fu">case_when</span>(p <span class="sc">&lt;</span> .<span class="dv">01</span> <span class="sc">~</span> <span class="st">"0.00 - 0.01"</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">02</span> <span class="sc">~</span> <span class="st">"0.01 - 0.02"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">03</span> <span class="sc">~</span> <span class="st">"0.02 - 0.03"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">04</span> <span class="sc">~</span> <span class="st">"0.03 - 0.04"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">05</span> <span class="sc">~</span> <span class="st">"0.04 - 0.05"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(bin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         bin     n percent
 0.00 - 0.01 86544 0.86544
 0.01 - 0.02  5044 0.05044
 0.02 - 0.03  2340 0.02340
 0.03 - 0.04  1308 0.01308
 0.04 - 0.05   908 0.00908
       other  3856 0.03856</code></pre>
</div>
</div>
<p>(Recall that under H0, all <em>p</em>-values are equally likely, so each of the percentile bins would contain 1% of <em>p</em>-values.)</p>
<p>In fact, at best, a <em>p</em>-value between .04 and .05 can only be about four times as likely under the alternative hypothesis as the null hypothesis. If your <em>p</em>-value is just under .05, it is at best weak support for the alternative hypothesis.</p>


<!-- -->

</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This section is based on ideas I learned from homework assignment 1 in Daniel Lakens’s Coursera class <a href="https://www.coursera.org/learn/statistical-inferences/home/welcome">Improving your statistical inferences</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-likelihood-statistics.html" class="pagination-link" aria-label="Likelihood Statistics">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Likelihood Statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Frequentist Statistics</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="in">library(glue)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(pwr)</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales)</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123456)</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="in">source("setup.R")</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Central Tendancy and Dispersion</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>Suppose you have a data set with $j = <span class="co">[</span><span class="ot">1 .. p</span><span class="co">]</span>$ variables. Each variable will have a distribution that can be characterized by its mean and variance. If you consider them together, you can see how variance and covariance are related. For the matrix algebra that follows, assume the data are organized in _rows_, so $X_j$ is a _row vector_ of $n$ observations. $X_{ij}$ refers to column $i$ of row $j$.</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>The mean of row vector $X_j$ is $\bar{x}_j = \frac{1}{n} \sum_{i = 1}^n X_{ij}$. $\bar{x}_j$ estimates the population mean, $\mu_j = E(X_j)$. The collection of means are a column vector.</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>$$\boldsymbol{\bar{x}} = \begin{pmatrix} \bar{x}_1 <span class="sc">\\</span> \bar{x}_2 <span class="sc">\\</span> \cdots <span class="sc">\\</span> \bar{x}_p  \end{pmatrix}$$</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>The variance of row vector $X_j$ is the average squared difference from the mean, $s_j^2 = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j)^2$. $s_j^2$ estimates the population variance, $\sigma_j^2 = E(X_j - \mu_j)^2$. Again, the collection is represented as a column vector,</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>$$\boldsymbol{s}^2 = \begin{pmatrix} s_1^2 <span class="sc">\\</span> s_2^2 <span class="sc">\\</span> \cdots <span class="sc">\\</span> s_p^2  \end{pmatrix}$$</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>The square root of $s^2$ is called the standard deviation. The concept of variance can be extended to pairs of variables, $j$ and $k$. The covariance of $X_j$ and $X_k$ is the average product of differences from their respective means, $s_{jk} = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j) (X_{ik} - \bar{x}_k)$. $s_{jk}$ estimates the population covariance, $\sigma_{jk} = E\{ (X_{ij} - \mu_j) (X_{ik} - \mu_k)\}$. Notice how the sign of $s_{jk}$ tells you how the variables relate. It's positive if when one variable is larger than its mean, so is the other. It's zero if the value of one variable tells you nothing about the other. It can be shown that $s_{jk}$ is equivalently expressed as </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>s_{jk} = \frac{1}{n-1} \left<span class="co">[</span><span class="ot"> \sum_{i=1}^n X_{ij}X_{ik} - \frac{\sum_{i = 1}^n X_{ij} \sum_{i = 1}^n X_{ik}}{n} \right</span><span class="co">]</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>This is how it is actually calculated. The first term is dot product, $X_j \cdot X_k$. The second term is the product of the averages. Use matrix algebra to generalize across all $p$ variables to form the _variance-covariance matrix_.</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>S &amp;= \frac{1}{n-1} \sum_{i=1}^n (X_i - \bar{x}) (X_i - \bar{x})' <span class="sc">\\</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n-1} \left<span class="co">[</span><span class="ot"> \sum_{i=1}^n X_i X_i^{'} - \frac{\sum_{i = 1}^n X_i \sum_{i = 1}^n X_i}{n} \right</span><span class="co">]</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>$S$ estimates the population variance-covariance matrix, $\boldsymbol{\Sigma}$. Divide the covariances by their product of their standard deviations to get their _correlation_, $r_{jk} = \frac{s_{jk}}{s_j s_k}$. $r_{jk}$ estimates the population correlation, $\rho_{jk} = \frac{\sigma_{jk}}{\sigma_j \sigma_k}$.</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis Testing</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>MU_0 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>SIGMA <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>MU <span class="ot">&lt;-</span> <span class="dv">106</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>X_BAR <span class="ot">&lt;-</span> <span class="dv">104</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>SD <span class="ot">&lt;-</span> <span class="fl">15.2</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>iq_crit_30 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">95</span>, <span class="at">mean =</span> MU_0, <span class="at">sd  =</span> SIGMA <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>))</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>iq_crit_50 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">95</span>, <span class="at">mean =</span> MU_0, <span class="at">sd  =</span> SIGMA <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">50</span>))</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>iq_pop <span class="ot">&lt;-</span> </span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">iq =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">200</span>, .<span class="dv">01</span>)) <span class="sc">|&gt;</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">MU_0 =</span> <span class="fu">map_dbl</span>(iq, \(iq) <span class="fu">dnorm</span>(iq, <span class="at">mean =</span> MU_0, <span class="at">sd =</span> SIGMA)),</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">MU =</span> <span class="fu">map_dbl</span>(iq, \(iq) <span class="fu">dnorm</span>(iq, <span class="at">mean =</span> MU, <span class="at">sd =</span> SIGMA))</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(MU_0, MU), <span class="at">names_to =</span> <span class="st">"dist"</span>, <span class="at">values_to =</span> <span class="st">"dens"</span>)</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>iq_sample <span class="ot">&lt;-</span> </span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(<span class="at">iq =</span> <span class="fu">seq</span>(<span class="dv">90</span>, <span class="dv">115</span>, .<span class="dv">01</span>), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">50</span>), <span class="at">grp =</span> <span class="fu">c</span>(<span class="st">"presumed"</span>, <span class="st">"actual"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu =</span> <span class="fu">if_else</span>(grp <span class="sc">==</span> <span class="st">"presumed"</span>, MU_0, MU),</span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">pmap_dbl</span>(<span class="fu">list</span>(iq, n, mu), \(iq, n, mu) <span class="fu">dnorm</span>(iq, <span class="at">mean =</span> mu, <span class="at">sd =</span> SIGMA <span class="sc">/</span> <span class="fu">sqrt</span>(n))),</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">iq_crit =</span> <span class="fu">if_else</span>(n <span class="sc">==</span> <span class="dv">30</span>, iq_crit_30, iq_crit_50)</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>*P*-values express how surprising a summary measure is given the null hypothesis (H0). Suppose you hypothesize that IQs have increased from their intended mean of $\mu$ = `r MU_0`, $\sigma$ = `r SIGMA`. H0 is $\mu_0$ = `r MU_0` with alternative H1 that $\mu$ &gt; 100. Suppose also that you are *right*: $\mu$ is actually <span class="in">`r MU`</span>. The presumed and actual distribution of IQs would look like this:</span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>iq_pop <span class="sc">|&gt;</span></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_lbl =</span> <span class="fu">glue</span>(<span class="st">"mu = {if_else(dist == 'MU', MU, MU_0)}, SD = {SIGMA}"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> iq)) <span class="sc">+</span></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> dens, <span class="at">color =</span> dist_lbl)) <span class="sc">+</span></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MU_0, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MU, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"IQ"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgoldenrod"</span>, <span class="st">"gray30"</span>)) <span class="sc">+</span></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Presumed and actual population distributions, centered at 100 and 106."</span></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>)</span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a>According to the Central Limit Theorem (CLM), repeated samples of size *n* from a large population will yield $\bar{x}$ values that approach a normal distribution centered at $\mu$ with a standard deviation equal to the the *standard error*, $SE = \frac{\sigma}{\sqrt{n}} = \frac{<span class="in">`r SIGMA`</span>}{\sqrt{<span class="in">`r n`</span>}}$ = <span class="in">`r comma(SIGMA / sqrt(n), .1)`</span>. Repeated samples would be distributed $\sim N(<span class="in">`r comma(MU_0, 1)`</span>, <span class="in">`r comma(SIGMA/sqrt(n), .1)`</span>^2).$ </span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a>Suppose you take a random sample of *n* = 30 IQs from the population and measure $\bar{x}$ = `r X_BAR`, SD = `r SD`. How surprising is this if H0 is true? I.e., what is the *probability* of observing an $\bar{x}$ of <span class="in">`r comma(X_BAR, 1)`</span> if $\mu$ is <span class="in">`r comma(MU_0, 1)`</span> and $\sigma$ is <span class="in">`r comma(SIGMA)`</span>? The situation looks like this:</span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a>lbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">grp =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"presumed"</span>, <span class="st">"actual"</span>), <span class="dv">2</span>),</span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">50</span>),</span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">iq =</span> <span class="fu">c</span>(<span class="fl">102.5</span>, <span class="fl">105.2</span>, <span class="fl">102.5</span>, <span class="dv">104</span>),</span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">lbl =</span> <span class="fu">c</span>(<span class="st">"beta"</span>, <span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"alpha"</span>)</span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a>iq_sample <span class="sc">|&gt;</span></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> iq, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">if_else</span>(iq <span class="sc">&gt;=</span> iq_crit <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"presumed"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">if_else</span>(iq <span class="sc">&lt;=</span> iq_crit <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"actual"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> lbl[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, ], <span class="fu">aes</span>(<span class="at">y =</span> .<span class="dv">015</span>, <span class="at">label =</span> lbl), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MU_0, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MU, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> X_BAR, <span class="at">color =</span> <span class="st">"forestgreen"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"IQ"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">90</span>, <span class="dv">110</span>, <span class="dv">10</span>), MU, X_BAR, iq_crit_30),</span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Distributions of mean IQ from repeated sampling of n = 30 from "</span>,</span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a>      <span class="st">"distributions centered at 100 and 106."</span></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>)</span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a>(z <span class="ot">&lt;-</span> (X_BAR <span class="sc">-</span> MU_0) <span class="sc">/</span> (SIGMA <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a>(p.value <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a>(critical_value <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">95</span>, MU_0, SIGMA <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a>The $\alpha$ region starts at <span class="in">`qnorm(.05, 100, 2.7, lower.tail = FALSE)`</span> = <span class="in">`r comma(critical_value, .1)`</span>. $\bar{x}$ would have had to be at least that large to reject H0. The probability of measuring $\bar{x} \ge <span class="in">`r comma(X_BAR, 1)`</span>$ is derived from the *z* score, $z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}} = \frac{`r X_BAR` - 100}{2.7}$ = `r comma((X_BAR - MU_0) / (SIGMA / sqrt(n)), .1)`. The probability of measuring a *z* score that high given H0 is $P(z \ge 1.5)$ = <span class="in">`r comma(p.value, .001)`</span>, meaning <span class="in">`r percent(pnorm(z, lower.tail = FALSE), .1)`</span> of the area under the null distribution is to the right of <span class="in">`r comma(X_BAR, 1)`</span>. Therefore, do not reject H0 at the $\alpha$ = .05 level of significance. </span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type I and II Errors</span></span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a>Either H0 ($\mu = <span class="in">`r MU`</span>$) or H1 ($\mu \ge <span class="in">`r MU`</span>$) is correct. You must choose to either reject or not reject H0. That means there are four possible states at the end of your analysis. If your summary measure is extreme enough for you to declare a "positive" result and reject H0, you are either correct (true positive) or incorrect (false positive). False positives are called *Type I errors*. Alternatively, if it is *not* extreme enough, you are either correct (true negative) or incorrect (false negative). False negatives are called *Type II errors*.</span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a>The probabilities of landing in these four states depend on your chosen significance level, $\alpha$, and on the statistical power of the study, 1 - $\beta$.</span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a>|                        |H0 True                       |H0 False                      |</span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a>|------------------------|------------------------------|-----------------------------|</span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a>|Positive test, reject H0.| False Positive &lt;br&gt;Type I Error&lt;br&gt; Probability = $\alpha$    | True Positive &lt;br&gt;Good Call! &lt;br&gt; Probability = 1 - $\beta$ |</span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a>|Negative test, do *not* reject H0.   | True Negative &lt;br&gt; Good Call!&lt;br&gt; Probability = ($1 - \alpha$)    | False Negative &lt;br&gt;Type II Error &lt;br&gt;Probability = $\beta$ |</span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a>$\alpha$ is the expected Type I error rate - extreme summary measures occurring by chance when there is no effect to measure. $\beta$ is the expected Type II error rate - summary measures that by chance were not extreme enough to reject H0 even though there is an actual effect. </span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a>If the population mean really was $\mu$ = <span class="in">`r MU_0`</span>, any sample mean greater than <span class="in">`r qnorm(.95, MU_0, SIGMA / sqrt(n)) |&gt; comma(.1)`</span> would mistakenly reject H0 at the $\alpha$ = .05 significance level, a Type I error. However, the population mean is actually $\mu$ = <span class="in">`r MU`</span>, and our measured $\bar{x}$ = <span class="in">`r comma(X_BAR, 1)`</span> only achieved a *p*-value of <span class="in">`r comma(pnorm(z, lower.tail = FALSE), .001)`</span>, so we failed to reject H0, a Type II error.</span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a>Had the sample size been larger, the study would have had the power to reject H0. Here's the plot with *n* = 50. The null and actual distributions are tighter, and the $\alpha$ region starts at <span class="in">`r comma(iq_crit_50, .1)`</span>.</span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a>lbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a>  <span class="at">grp =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"presumed"</span>, <span class="st">"actual"</span>), <span class="dv">2</span>),</span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">50</span>),</span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a>  <span class="at">iq =</span> <span class="fu">c</span>(<span class="fl">102.5</span>, <span class="fl">105.2</span>, <span class="fl">102.5</span>, <span class="dv">104</span>),</span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a>  <span class="at">lbl =</span> <span class="fu">c</span>(<span class="st">"beta"</span>, <span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"alpha"</span>)</span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a>iq_sample <span class="sc">|&gt;</span></span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> iq, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">if_else</span>(iq <span class="sc">&gt;=</span> iq_crit <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"presumed"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">if_else</span>(iq <span class="sc">&lt;=</span> iq_crit <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"actual"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> lbl[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, ], <span class="fu">aes</span>(<span class="at">y =</span> .<span class="dv">015</span>, <span class="at">label =</span> lbl), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MU_0, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MU, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> X_BAR, <span class="at">color =</span> <span class="st">"forestgreen"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"IQ"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">90</span>, <span class="dv">110</span>, <span class="dv">10</span>), MU, X_BAR, iq_crit_50),</span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Distributions of mean IQ from repeated sampling of n = 50 from "</span>,</span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a>      <span class="st">"distributions centered at 100 and 106."</span></span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>)</span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a>The area under the actual distribution to the left of $alpha$ is labeled $\beta$. It's the Type II error zone. You don't usually see much discussion of $\beta$ in reports because $\beta$ is based on the unknown actual population distribution. $\beta$ is relevant at the _design_ stage. It informs how large your sample needs to be in order to reject H0 given some expected $\bar{x}$. Interestingly, you can see how there can be such a thing as too much power. If *n* is large enough, you can reject H0 with even a trivial effect size.</span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Statistical Power</span></span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a>The ability to detect a difference when it exists (the true positive) is called the power of the test. It's measured by the area outside of $\beta$. Changing *n* from 30 to 50 reduced the area in the $\beta$ region, increasing the power of the test.</span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a>Statistical power is an increasing function of sample size, effect size, and significance level. The positive association with significance level means there is a trade-off between Type I and Type II error rates. A small $\alpha$ sets a high bar for rejecting H0, but you run the risk of failing to appreciate a *real* difference. On the other hand, a large $\alpha$ sets a low bar for rejecting H0, but you run the risk of mistaking a random difference as real.</span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a>The 1 - $\beta$ statistical power threshold is usually set at .80, similar to the $\alpha$ = .05 level of significance threshold convention. Given a real effect, a study with a statistical power of .80 will only find a positive test result 80% of the time. You may think more power is better, but beware that with a large enough sample size, even trivial effect sizes may yield a positive test result. You need to consider both sides of this coin.</span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a>A *power analysis* determines the sample size required to detect a threshold effect size given an $\alpha$ level of significance. A power analysis expresses the relationship among four components. If you know any three, it tells you the fourth: The components are *n*, $\alpha$, , 1 - $\beta$, and Cohen's *d* = $(\bar{x} - \mu_0)/\sigma$.</span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a>Suppose you set power at .80, significance level at .05, and *n* = 30. What effect size will this design detect?</span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span>,</span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a>An effect size of *d* = `r comma(pwr$d, .001)` will fall in the $\alpha$ = .05 region with probability 1 - $\beta$ = .80 if the sample size is *n* = 30. Multiply *d* = <span class="in">`r comma(pwr$d, .001)`</span> by $\sigma$ = <span class="in">`r SIGMA`</span> to convert to the IQ units, <span class="in">`r comma(pwr$d * SIGMA, .1)`</span>. More likely, you will use the power test to detect the required sample size. Suppose you set $1 - \beta$ = .8 and $\alpha$ = .05, and want to detect an effect size of $5 / 15$.</span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a>You need a larger sample, *n* = `r comma(ceiling(pwr$n), 1)`. You can use the power test formula for various *n* sizes to see the relationship with effect size. *Note: the y-axis multiplies Cohen's d by $\sigma$ to get the effect size in original units*.</span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(n = rep(10:150, 2),</span></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a><span class="in">           power = c(rep(.80, 141), rep(.60, 141))) %&gt;%</span></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d = map2_dbl(n, power, ~ pwr.t.test(n = .x, </span></span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a><span class="in">                                     sig.level = .05, </span></span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a><span class="in">                                     power = .y, </span></span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a><span class="in">                                     type = "one.sample", </span></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a><span class="in">                                     alternative = "greater") %&gt;% pluck("d")),</span></span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a><span class="in">         delta = d * SIGMA</span></span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = n, y = delta, group = as.factor(power), color = as.factor(power))) +</span></span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line() +</span></span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("segment", x = 30, xend = 30, y = 0, yend = 7, linetype = 2, size = 1, color = "steelblue") +</span></span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("segment", x = 0, xend = 30, y = 7, yend = 7, linetype = 2, size = 1, color = "steelblue") +</span></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(limits = c(0, NA), breaks = 1:100, expand = c(0, 0)) +</span></span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0, 155), breaks = seq(0, 150, 10), expand = c(0, 0)) +</span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = c("0.6" = "gray80", "0.8" = "steelblue")) +</span></span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(panel.grid.minor = element_blank(), legend.position = "right") +</span></span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = paste("A sample size of 30 is required to detect an effect size",</span></span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a><span class="in">                     "of 7 at a .05 significance \nlevel with 80% probability."),</span></span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Power analysis with power = .80 vs .60 and significance = .05.",</span></span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a><span class="in">       color = "Power")</span></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a>The dashed lines show a sample size of 30 is required to detect an effect size of 7 at a .05 significance level with 80% probability.</span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a><span class="fu">## Power Analyses</span></span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-Sample Prop Test (greater) {-}</span></span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear majority of support for an issue? $H_0$ is 50% (no majority) and $H_a$ is &gt;= 50%. By "clear majority", you might mean "at least 10 percentage points". If the majority is there, but it's less than 60%, you are okay with not rejecting $H_0$.</span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.p.test</span>(</span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a>If you repeatedly survey random samples of <span class="in">`r comma(ceiling(pwr$n))`</span> people from a population where 60% support the topic, you should expect to reject H0 80% of the time. I.e., you expect at least 87 (57%) approvals 80% of the time.</span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a>(crit_pct <span class="ot">&lt;-</span> crit_val <span class="sc">/</span> n)</span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a>You can see this in a plot of the theoretical distributions for samples of size <span class="in">`r n`</span> from populations centered at 50% and 60%. ~20% of the 60% curve is to the left of the critical value.</span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> crit_val, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"H0 = .5"</span>, n), <span class="fu">rep</span>(<span class="st">"Actual = .6"</span>, n)), </span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"H0 = .5"</span>, <span class="st">"Actual = .6"</span>)),</span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">cnt =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="dv">1</span>), <span class="dv">2</span>),</span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> n,</span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fu">rep</span>(.<span class="dv">5</span>, n), <span class="fu">rep</span>(.<span class="dv">6</span>, n)),</span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">pmap_dbl</span>(<span class="fu">list</span>(cnt, n, prob), \(cnt, n, prob) <span class="fu">dbinom</span>(cnt, n, prob)),</span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> cnt <span class="sc">/</span> size</span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(cnt <span class="sc">&gt;=</span> crit_val <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = .5"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(cnt <span class="sc">&lt;=</span> crit_val <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = .6"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">55</span>, <span class="at">y =</span> .<span class="dv">005</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">58</span>, <span class="at">y =</span> .<span class="dv">005</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">6</span>, crit_val <span class="sc">/</span> n), <span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(.<span class="dv">4</span>, .<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Approve"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for One Proportion, One-sided"</span>,</span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size h = .2 (10 pct pts), 80% power, Sample size n = {comma(n)}. "</span>,</span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Proportions &gt; {percent(crit_val / n, 1)} reject H0 at alpha = .05."</span></span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">95</span>)</span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-Sample Prop Test (two-sided) {-}</span></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear preference either way? Set an effect size that detects the difference from 50% (no preference) to 40% or 60%. This is a two-sided test.</span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.p.test</span>(</span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a>You need more people for a two-sided test, <span class="in">`r comma(ceiling(pwr$n))`</span>, and the critical values are further from 50%.</span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a>(crit_val1 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">025</span>, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a>(crit_pct1 <span class="ot">&lt;-</span> crit_val1 <span class="sc">/</span> n)</span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a>(crit_val2 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="at">p =</span> .<span class="dv">975</span>, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a>(crit_pct2 <span class="ot">&lt;-</span> crit_val2 <span class="sc">/</span> n)</span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a>Here are the theoretical distributions.</span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"H0 = .5"</span>, n), <span class="fu">rep</span>(<span class="st">"Actual = .4"</span>, n), <span class="fu">rep</span>(<span class="st">"Actual = .6"</span>, n)),</span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"H0 = .5"</span>, <span class="st">"Actual = .4"</span>, <span class="st">"Actual = .6"</span>)),</span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">cnt =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="dv">1</span>), <span class="dv">3</span>),</span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> n,</span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fu">rep</span>(.<span class="dv">5</span>, n), <span class="fu">rep</span>(.<span class="dv">4</span>, n), <span class="fu">rep</span>(.<span class="dv">6</span>, n)),</span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">pmap_dbl</span>(<span class="fu">list</span>(cnt, n, prob), \(cnt, n, prob) <span class="fu">dbinom</span>(cnt, n, prob)),</span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> cnt <span class="sc">/</span> size</span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(cnt <span class="sc">&lt;=</span> crit_val1 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = .5"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(cnt <span class="sc">&gt;=</span> crit_val2 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = .5"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(cnt <span class="sc">&gt;=</span> crit_val1 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = .4"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(cnt <span class="sc">&lt;=</span> crit_val2 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = .6"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">55</span>, <span class="at">y =</span> .<span class="dv">005</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">45</span>, <span class="at">y =</span> .<span class="dv">005</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">58</span>, <span class="at">y =</span> .<span class="dv">0025</span>, <span class="at">label =</span> <span class="st">"alpha / 2"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">3.0</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">42</span>, <span class="at">y =</span> .<span class="dv">0025</span>, <span class="at">label =</span> <span class="st">"alpha / 2"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">3.0</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"darkgoldenrod"</span>, <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(.<span class="dv">4</span>, .<span class="dv">5</span>, .<span class="dv">6</span>, crit_val1 <span class="sc">/</span> n, crit_val2 <span class="sc">/</span> n),</span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Approve"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for One Proportion, Two-sided"</span>,</span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size h = .2 (10 pct pts), 80% power, Sample size n = {comma(n)}. "</span>,</span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Proportions &lt; {percent(crit_val1 / n, 1)} and &gt; {percent(crit_val2 / n, 1)} "</span>,</span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a>      <span class="st">"reject H0 at alpha = .05."</span></span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">95</span>)</span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a>$\beta$ ~20% of the area of *Actual = .4* is to the right of `r percent(crit_val1 / n, 1)` and $\beta$ ~20% of the area of *Actual = .6* is to the left of <span class="in">`r percent(crit_val2 / n, 1)`</span>.</span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> crit_val1, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> crit_val2, <span class="at">size =</span> n, <span class="at">prob =</span> .<span class="dv">6</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two-Sample Prop Test (greater) {-}</span></span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear difference in support for an issue between two groups? $H_0$ is that groups *A* and *B* have the same support rate. As before, you set a minimum effect size of 10 percentage points. A one-sided test assesses whether *A* has a higher (lower) support rate than *B*.</span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.2p.test</span>(</span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a>Whoa, we need twice as many people *for each group*! Why is that? Recall from <span class="co">[</span><span class="ot">your notes</span><span class="co">](https://mpfoley73.github.io/statistics/08-binomial-binomial.html)</span> that the two proportions test is a test on the distribution of proportion difference, $d = p_1 - p_2$. The sampling distribution of $d$ has a standard error $SE = \sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}}$. The test statistic is $Z = (d-d_0) / SE$.</span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a>There is a similar test that allows for unequal group sample sizes. If the first group is 305, so will be the second group. If the first group is 400, the second needs to be 247. The minimum sample size is always going to be for equal sample sizes.</span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.2p2n.test</span>(</span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">400</span>,</span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">5</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">5</span>) <span class="sc">/</span> n <span class="sc">+</span> .<span class="dv">6</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">6</span>) <span class="sc">/</span> n)</span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"d = 0"</span>, <span class="dv">1001</span>), <span class="fu">rep</span>(<span class="st">"d = .1"</span>, <span class="dv">1001</span>))),</span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">0005</span>), <span class="dv">2</span>),</span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1001</span>), <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">1001</span>)),</span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">pmap_dbl</span>(<span class="fu">list</span>(p, d), \(p, d) <span class="fu">dnorm</span>(p, <span class="at">mean =</span> d, <span class="at">sd =</span> SE)),</span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&gt;=</span> crit_val <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"d = 0"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&lt;=</span> crit_val <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"d = .1"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">03</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">1</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"d = 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"d = .1"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"d = 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"d = .1"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(.<span class="dv">0</span>, .<span class="dv">1</span>, crit_val), <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">01</span>)) <span class="sc">+</span></span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, .<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Difference"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for Two Proportions, Equal Sample Sizes, One-sided Test"</span>,</span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size h = .2 (10 pct pts), 80% power, Sample size n = {comma(n)} "</span>,</span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a>      <span class="st">"for each group. Differences &gt;= {comma(crit_val, .01)} reject H0 at alpha = .05."</span></span>
<span id="cb44-545"><a href="#cb44-545" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">100</span>)</span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two-Sample Prop Test (two-sided) {-}</span></span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear difference in support for an issue between two groups? $H_0$ is that groups *A* and *B* have the same support rate. Again, suppose you care about a difference of at least a 10 percentage points. In the two-sided test, group *A* can be a higher *or lower* than *B*.</span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">ES.h</span>(<span class="at">p1 =</span> .<span class="dv">60</span>, <span class="at">p2 =</span> .<span class="dv">50</span>)</span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.2p.test</span>(</span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a>  <span class="at">h =</span> h, </span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a>The two-sided test requires a larger sample and the critical values are a little further from zero.</span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">5</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">5</span>) <span class="sc">/</span> n <span class="sc">+</span> .<span class="dv">6</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">6</span>) <span class="sc">/</span> n)</span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a>(crit_val1 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">025</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a>(crit_val2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> .<span class="dv">025</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"d = 0"</span>, <span class="dv">1001</span>), <span class="fu">rep</span>(<span class="st">"d = .1"</span>, <span class="dv">1001</span>), <span class="fu">rep</span>(<span class="st">"d = -.1"</span>, <span class="dv">1001</span>))),</span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">25</span>, .<span class="dv">25</span>, .<span class="dv">0005</span>), <span class="dv">3</span>),</span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1001</span>), <span class="fu">rep</span>(.<span class="dv">1</span>, <span class="dv">1001</span>), <span class="fu">rep</span>(<span class="sc">-</span>.<span class="dv">1</span>, <span class="dv">1001</span>)),</span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">pmap_dbl</span>(<span class="fu">list</span>(p, d), \(p, d) <span class="fu">dnorm</span>(p, <span class="at">mean =</span> d, <span class="at">sd =</span> SE)),</span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-597"><a href="#cb44-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&gt;=</span> crit_val1 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"d = 0"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&lt;=</span> crit_val2 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"d = 0"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&lt;=</span> crit_val1 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"d = .1"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&gt;=</span> crit_val2 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"d = -.1"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">04</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">04</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">08</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">1</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"d - 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"d = .1"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>, <span class="st">"d = -.1"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"d - 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"d = .1"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>, <span class="st">"d = -.1"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(.<span class="dv">0</span>, .<span class="dv">1</span>, crit_val1, crit_val2), <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">01</span>)) <span class="sc">+</span></span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">25</span>, .<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-618"><a href="#cb44-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Difference"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-619"><a href="#cb44-619" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for Two Proportions, Equal Sample Sizes, Two-sided Test"</span>,</span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size h = .2 (10 pct pts), 80% power, Sample size n = {comma(n)} "</span>,</span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a>      <span class="st">"for each group. Differences&lt;= {comma(crit_val2, .01)} or "</span>,</span>
<span id="cb44-625"><a href="#cb44-625" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&gt;= {comma(crit_val1, .01)} reject H0 at alpha = .05."</span></span>
<span id="cb44-626"><a href="#cb44-626" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">100</span>)</span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-630"><a href="#cb44-630" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-sample t-test (greater) {-}</span></span>
<span id="cb44-631"><a href="#cb44-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear level of agreement for an item measured in a 7-level Likert scale? This is an ordinal variable, but you can treat it as continuous. $H_0$ is 4 (middle value) and $H_a$ is &gt;4. By "clear agreement", you might mean "at least .5 points". If true average is &gt;4, but less than 4.5, you are okay with not rejecting $H_0$.</span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-636"><a href="#cb44-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-637"><a href="#cb44-637" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> sd</span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-647"><a href="#cb44-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-648"><a href="#cb44-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a>If you repeatedly survey random samples of <span class="in">`r comma(ceiling(pwr$n))`</span> people from a population where the average preference is level is 4.5 of 7, you should expect to reject H0 80% of the time.</span>
<span id="cb44-650"><a href="#cb44-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-654"><a href="#cb44-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-655"><a href="#cb44-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb44-658"><a href="#cb44-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-659"><a href="#cb44-659" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a>(crit_rating <span class="ot">&lt;-</span> crit_val <span class="sc">*</span> se <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a>You can see this in a plot of the theoretical distributions for samples of size <span class="in">`r n`</span> from populations centered at 4 and 4.5. ~20% of the mean 4.5 curve is to the left of the critical value.</span>
<span id="cb44-665"><a href="#cb44-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-668"><a href="#cb44-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-669"><a href="#cb44-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-670"><a href="#cb44-670" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-671"><a href="#cb44-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-672"><a href="#cb44-672" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-673"><a href="#cb44-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-674"><a href="#cb44-674" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"H0 = 4"</span>, <span class="dv">201</span>), <span class="fu">rep</span>(<span class="st">"Actual = 4.5"</span>, <span class="dv">201</span>)), </span>
<span id="cb44-675"><a href="#cb44-675" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"H0 = 4"</span>, <span class="st">"Actual = 4.5"</span>)),</span>
<span id="cb44-676"><a href="#cb44-676" aria-hidden="true" tabindex="-1"></a>    <span class="at">rating =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">5</span>, .<span class="dv">01</span>), <span class="dv">2</span>),</span>
<span id="cb44-677"><a href="#cb44-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> (rating <span class="sc">-</span> <span class="fu">if_else</span>(grp <span class="sc">==</span> <span class="st">"H0 = 4"</span>, <span class="dv">4</span>, <span class="fl">4.5</span>)) <span class="sc">/</span> se,</span>
<span id="cb44-678"><a href="#cb44-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">map_dbl</span>(x, \(x) <span class="fu">dt</span>(x, <span class="at">df =</span> n <span class="sc">-</span> x))</span>
<span id="cb44-679"><a href="#cb44-679" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-680"><a href="#cb44-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-681"><a href="#cb44-681" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-682"><a href="#cb44-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-683"><a href="#cb44-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-684"><a href="#cb44-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-685"><a href="#cb44-685" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating <span class="sc">&gt;=</span> crit_rating <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = 4"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-686"><a href="#cb44-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-687"><a href="#cb44-687" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating <span class="sc">&lt;=</span> crit_rating <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = 4.5"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-688"><a href="#cb44-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">4.2</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-689"><a href="#cb44-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">4.4</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-690"><a href="#cb44-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">4.0</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-691"><a href="#cb44-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-692"><a href="#cb44-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 4"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"Actual = 4.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-693"><a href="#cb44-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 4"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"Actual = 4.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-694"><a href="#cb44-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, crit_rating), <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-695"><a href="#cb44-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-696"><a href="#cb44-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-697"><a href="#cb44-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-698"><a href="#cb44-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-699"><a href="#cb44-699" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Average Likert Rating (1-7)"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-700"><a href="#cb44-700" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-701"><a href="#cb44-701" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for One Sample t-Test, One-sided"</span>,</span>
<span id="cb44-702"><a href="#cb44-702" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-703"><a href="#cb44-703" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-704"><a href="#cb44-704" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size d = .5, 80% power, Sample size n = {comma(n)}. "</span>,</span>
<span id="cb44-705"><a href="#cb44-705" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Average ratings &gt; {comma(crit_rating, .1)} reject H0 at alpha = .05."</span></span>
<span id="cb44-706"><a href="#cb44-706" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">95</span>)</span>
<span id="cb44-707"><a href="#cb44-707" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-708"><a href="#cb44-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-709"><a href="#cb44-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-710"><a href="#cb44-710" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-sample t-test (two-sided) {-}</span></span>
<span id="cb44-711"><a href="#cb44-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-712"><a href="#cb44-712" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear level of preference for an item measured in a 7-level Likert scale? Treating the ordinal variable as continuous. $H_0$ is 4 (middle value) and $H_a$ is &lt;&gt;4. "Clear agreement" might mean "at least .5 points" either direction. If true average is between 3.5 and 4.5, you are okay with not rejecting $H_0$.</span>
<span id="cb44-713"><a href="#cb44-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-716"><a href="#cb44-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-717"><a href="#cb44-717" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb44-718"><a href="#cb44-718" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> sd</span>
<span id="cb44-719"><a href="#cb44-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-720"><a href="#cb44-720" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb44-721"><a href="#cb44-721" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb44-722"><a href="#cb44-722" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-723"><a href="#cb44-723" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-724"><a href="#cb44-724" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb44-725"><a href="#cb44-725" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb44-726"><a href="#cb44-726" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-727"><a href="#cb44-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-728"><a href="#cb44-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-729"><a href="#cb44-729" aria-hidden="true" tabindex="-1"></a>The sample size increased from <span class="in">`r ceiling(n)`</span> to <span class="in">`r ceiling(pwr$n)`</span>. If you repeatedly survey random samples of <span class="in">`r comma(ceiling(pwr$n))`</span> people from a population where the average preference is level is 3.5 or 4.5 of 7, you should expect to reject H0 80% of the time.</span>
<span id="cb44-730"><a href="#cb44-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-733"><a href="#cb44-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-734"><a href="#cb44-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-735"><a href="#cb44-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-736"><a href="#cb44-736" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n)</span>
<span id="cb44-737"><a href="#cb44-737" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb44-738"><a href="#cb44-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-739"><a href="#cb44-739" aria-hidden="true" tabindex="-1"></a>(crit_val1 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb44-740"><a href="#cb44-740" aria-hidden="true" tabindex="-1"></a>(crit_val2 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-741"><a href="#cb44-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-742"><a href="#cb44-742" aria-hidden="true" tabindex="-1"></a>(crit_rating1 <span class="ot">&lt;-</span> crit_val1 <span class="sc">*</span> se <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb44-743"><a href="#cb44-743" aria-hidden="true" tabindex="-1"></a>(crit_rating2 <span class="ot">&lt;-</span> crit_val2 <span class="sc">*</span> se <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb44-744"><a href="#cb44-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-745"><a href="#cb44-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-746"><a href="#cb44-746" aria-hidden="true" tabindex="-1"></a>You can see this in a plot of the theoretical distributions for samples of size <span class="in">`r n`</span> from populations centered at 3.5, 4 and 4.5. ~20% of the mean 4.5 curve and mean 3.5 curve is to the left of the critical value.</span>
<span id="cb44-747"><a href="#cb44-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-750"><a href="#cb44-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-751"><a href="#cb44-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-752"><a href="#cb44-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-753"><a href="#cb44-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-754"><a href="#cb44-754" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-755"><a href="#cb44-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-756"><a href="#cb44-756" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"H0 = 4"</span>, <span class="dv">201</span>), <span class="fu">rep</span>(<span class="st">"Actual = 3.5"</span>, <span class="dv">201</span>), <span class="fu">rep</span>(<span class="st">"Actual = 4.5"</span>, <span class="dv">201</span>)), </span>
<span id="cb44-757"><a href="#cb44-757" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Actual = 3.5"</span>, <span class="st">"H0 = 4"</span>, <span class="st">"Actual = 4.5"</span>)),</span>
<span id="cb44-758"><a href="#cb44-758" aria-hidden="true" tabindex="-1"></a>    <span class="at">rating =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">5</span>, .<span class="dv">01</span>), <span class="dv">3</span>),</span>
<span id="cb44-759"><a href="#cb44-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> (rating <span class="sc">-</span> <span class="fu">case_when</span>(grp <span class="sc">==</span> <span class="st">"H0 = 4"</span> <span class="sc">~</span> <span class="dv">4</span>, grp <span class="sc">==</span> <span class="st">"Actual = 3.5"</span> <span class="sc">~</span> <span class="fl">3.5</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fl">4.5</span>)) <span class="sc">/</span> se,</span>
<span id="cb44-760"><a href="#cb44-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">map_dbl</span>(x, \(x) <span class="fu">dt</span>(x, <span class="at">df =</span> n <span class="sc">-</span> x))</span>
<span id="cb44-761"><a href="#cb44-761" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-762"><a href="#cb44-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-763"><a href="#cb44-763" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-764"><a href="#cb44-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-765"><a href="#cb44-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-766"><a href="#cb44-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-767"><a href="#cb44-767" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating <span class="sc">&lt;=</span> crit_rating1 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = 4"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-768"><a href="#cb44-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-769"><a href="#cb44-769" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating <span class="sc">&gt;=</span> crit_rating1 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = 3.5"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-770"><a href="#cb44-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-771"><a href="#cb44-771" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating <span class="sc">&gt;=</span> crit_rating2 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = 4"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-772"><a href="#cb44-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-773"><a href="#cb44-773" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating <span class="sc">&lt;=</span> crit_rating2 <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = 4.5"</span>, dens, <span class="cn">NA_real_</span>)), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-774"><a href="#cb44-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">4.2</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-775"><a href="#cb44-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">4.35</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-776"><a href="#cb44-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.8</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-777"><a href="#cb44-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.65</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-778"><a href="#cb44-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">4.0</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-779"><a href="#cb44-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-780"><a href="#cb44-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 4"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"Actual = 3.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>, </span>
<span id="cb44-781"><a href="#cb44-781" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Actual = 4.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-782"><a href="#cb44-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 4"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"Actual = 3.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>, </span>
<span id="cb44-783"><a href="#cb44-783" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Actual = 4.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-784"><a href="#cb44-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">3.5</span>, <span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, crit_rating1, crit_rating2), <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-785"><a href="#cb44-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-786"><a href="#cb44-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-787"><a href="#cb44-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-788"><a href="#cb44-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-789"><a href="#cb44-789" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Average Likert Rating (1-7)"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-790"><a href="#cb44-790" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-791"><a href="#cb44-791" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for One Sample t-Test, One-sided"</span>,</span>
<span id="cb44-792"><a href="#cb44-792" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-793"><a href="#cb44-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-794"><a href="#cb44-794" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size d = .5, 80% power, Sample size n = {comma(n)}. "</span>,</span>
<span id="cb44-795"><a href="#cb44-795" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Average ratings between {comma(crit_rating1, .1)} and "</span>,</span>
<span id="cb44-796"><a href="#cb44-796" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{comma(crit_rating2, .1)} reject H0 at alpha = .05."</span></span>
<span id="cb44-797"><a href="#cb44-797" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">95</span>)</span>
<span id="cb44-798"><a href="#cb44-798" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-799"><a href="#cb44-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-800"><a href="#cb44-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-801"><a href="#cb44-801" aria-hidden="true" tabindex="-1"></a><span class="fu">### Indep Samples t-test (greater) {-}</span></span>
<span id="cb44-802"><a href="#cb44-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-803"><a href="#cb44-803" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear group difference in agreement for an item measured in a 7-level Likert scale? $H_0$ is that groups *A* and *B* have the same average rating. As before, you set a minimum effect size of .5 points. The one-sided test assesses whether *A* has a higher (lower) average than *B*.</span>
<span id="cb44-804"><a href="#cb44-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-807"><a href="#cb44-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-808"><a href="#cb44-808" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb44-809"><a href="#cb44-809" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb44-810"><a href="#cb44-810" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> s1</span>
<span id="cb44-811"><a href="#cb44-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-812"><a href="#cb44-812" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t2n.test</span>(</span>
<span id="cb44-813"><a href="#cb44-813" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">54</span>,</span>
<span id="cb44-814"><a href="#cb44-814" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb44-815"><a href="#cb44-815" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-816"><a href="#cb44-816" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-817"><a href="#cb44-817" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb44-818"><a href="#cb44-818" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-819"><a href="#cb44-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-820"><a href="#cb44-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-821"><a href="#cb44-821" aria-hidden="true" tabindex="-1"></a>We need about twice as many people *for each group*! Recall from <span class="co">[</span><span class="ot">your notes</span><span class="co">](https://mpfoley73.github.io/statistics/05-continuous-binomial.html)</span> that the independent samples t-test is a test on the distribution of the difference in means, $\hat{d} = \bar{x}_1 - \bar{x}_2$. The sampling distribution of $d$ has a standard error $SE = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}$. The test statistic is $T = (\hat{d}-d_0) / SE$.</span>
<span id="cb44-822"><a href="#cb44-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-825"><a href="#cb44-825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-826"><a href="#cb44-826" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-827"><a href="#cb44-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-828"><a href="#cb44-828" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">54</span></span>
<span id="cb44-829"><a href="#cb44-829" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n2)</span>
<span id="cb44-830"><a href="#cb44-830" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> ((n1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb44-831"><a href="#cb44-831" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sp2) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)</span>
<span id="cb44-832"><a href="#cb44-832" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb44-833"><a href="#cb44-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-834"><a href="#cb44-834" aria-hidden="true" tabindex="-1"></a>(crit_val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-835"><a href="#cb44-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-836"><a href="#cb44-836" aria-hidden="true" tabindex="-1"></a>(crit_diff <span class="ot">&lt;-</span> crit_val <span class="sc">*</span> SE)</span>
<span id="cb44-837"><a href="#cb44-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-838"><a href="#cb44-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-841"><a href="#cb44-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-842"><a href="#cb44-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-843"><a href="#cb44-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-844"><a href="#cb44-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-845"><a href="#cb44-845" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-846"><a href="#cb44-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-847"><a href="#cb44-847" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"H0 = 0"</span>, <span class="dv">201</span>), <span class="fu">rep</span>(<span class="st">"Actual = 0.5"</span>, <span class="dv">201</span>)), </span>
<span id="cb44-848"><a href="#cb44-848" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"H0 = 0"</span>, <span class="st">"Actual = 0.5"</span>)),</span>
<span id="cb44-849"><a href="#cb44-849" aria-hidden="true" tabindex="-1"></a>    <span class="at">rating_diff =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">01</span>), <span class="dv">2</span>),</span>
<span id="cb44-850"><a href="#cb44-850" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> (rating_diff <span class="sc">-</span> <span class="fu">if_else</span>(grp <span class="sc">==</span> <span class="st">"H0 = 0"</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="sc">/</span> SE,</span>
<span id="cb44-851"><a href="#cb44-851" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">map_dbl</span>(x, \(x) <span class="fu">dt</span>(x, <span class="at">df =</span> df))</span>
<span id="cb44-852"><a href="#cb44-852" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-853"><a href="#cb44-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-854"><a href="#cb44-854" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-855"><a href="#cb44-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-856"><a href="#cb44-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-857"><a href="#cb44-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-858"><a href="#cb44-858" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating_diff <span class="sc">&gt;=</span> crit_diff <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = 0"</span>, dens, <span class="cn">NA_real_</span>)), </span>
<span id="cb44-859"><a href="#cb44-859" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-860"><a href="#cb44-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-861"><a href="#cb44-861" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating_diff <span class="sc">&lt;=</span> crit_diff <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = 0.5"</span>, dens, <span class="cn">NA_real_</span>)),</span>
<span id="cb44-862"><a href="#cb44-862" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-863"><a href="#cb44-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"beta"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-864"><a href="#cb44-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">40</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-865"><a href="#cb44-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-866"><a href="#cb44-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-867"><a href="#cb44-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"Actual = 0.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-868"><a href="#cb44-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, <span class="st">"Actual = 0.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-869"><a href="#cb44-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, crit_diff), <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-870"><a href="#cb44-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-871"><a href="#cb44-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-872"><a href="#cb44-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-873"><a href="#cb44-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-874"><a href="#cb44-874" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Difference in Likert Rating Average"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-875"><a href="#cb44-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-876"><a href="#cb44-876" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for Independent Sample t-Test, One-sided"</span>,</span>
<span id="cb44-877"><a href="#cb44-877" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-878"><a href="#cb44-878" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-879"><a href="#cb44-879" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size d = .5, 80% power, Sample sizes n1 = {comma(n1)}, "</span>,</span>
<span id="cb44-880"><a href="#cb44-880" aria-hidden="true" tabindex="-1"></a>      <span class="st">"n2 = {comma(n2)}. "</span>,</span>
<span id="cb44-881"><a href="#cb44-881" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Diff in averages &gt; {comma(crit_diff, .1)} reject H0 at alpha = .05."</span></span>
<span id="cb44-882"><a href="#cb44-882" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">95</span>)</span>
<span id="cb44-883"><a href="#cb44-883" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-884"><a href="#cb44-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-885"><a href="#cb44-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-886"><a href="#cb44-886" aria-hidden="true" tabindex="-1"></a><span class="fu">### Indep Samples t-test (two-sided) {-}</span></span>
<span id="cb44-887"><a href="#cb44-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-888"><a href="#cb44-888" aria-hidden="true" tabindex="-1"></a>How many people would you need to survey to detect a clear group difference in agreement for an item measured in a 7-level Likert scale? $H_0$ is that groups *A* and *B* have the same average rating. As before, you set a minimum effect size of .5 points. The two-sided test assesses whether *A* has a different average than *B*.</span>
<span id="cb44-889"><a href="#cb44-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-892"><a href="#cb44-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-893"><a href="#cb44-893" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb44-894"><a href="#cb44-894" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># assumption</span></span>
<span id="cb44-895"><a href="#cb44-895" aria-hidden="true" tabindex="-1"></a>cohen.d <span class="ot">&lt;-</span> (<span class="fl">4.5</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">/</span> s1</span>
<span id="cb44-896"><a href="#cb44-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-897"><a href="#cb44-897" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t2n.test</span>(</span>
<span id="cb44-898"><a href="#cb44-898" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">54</span>,</span>
<span id="cb44-899"><a href="#cb44-899" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> cohen.d, </span>
<span id="cb44-900"><a href="#cb44-900" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, </span>
<span id="cb44-901"><a href="#cb44-901" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">80</span>, </span>
<span id="cb44-902"><a href="#cb44-902" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb44-903"><a href="#cb44-903" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-904"><a href="#cb44-904" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-905"><a href="#cb44-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-906"><a href="#cb44-906" aria-hidden="true" tabindex="-1"></a>If $n_1$ is <span class="in">`r n1`</span>, then $n_2$ needs to be <span class="in">`r ceiling(pwr$n2)`</span> - higher than the one-sided test.</span>
<span id="cb44-907"><a href="#cb44-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-910"><a href="#cb44-910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-911"><a href="#cb44-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb44-912"><a href="#cb44-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-913"><a href="#cb44-913" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">54</span></span>
<span id="cb44-914"><a href="#cb44-914" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(pwr<span class="sc">$</span>n2)</span>
<span id="cb44-915"><a href="#cb44-915" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> ((n1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>s2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb44-916"><a href="#cb44-916" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sp2) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)</span>
<span id="cb44-917"><a href="#cb44-917" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb44-918"><a href="#cb44-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-919"><a href="#cb44-919" aria-hidden="true" tabindex="-1"></a>(crit_val_l <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))</span>
<span id="cb44-920"><a href="#cb44-920" aria-hidden="true" tabindex="-1"></a>(crit_val_u <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> .<span class="dv">05</span>, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-921"><a href="#cb44-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-922"><a href="#cb44-922" aria-hidden="true" tabindex="-1"></a>(crit_diff_l <span class="ot">&lt;-</span> crit_val_l <span class="sc">*</span> SE)</span>
<span id="cb44-923"><a href="#cb44-923" aria-hidden="true" tabindex="-1"></a>(crit_diff_u <span class="ot">&lt;-</span> crit_val_u <span class="sc">*</span> SE)</span>
<span id="cb44-924"><a href="#cb44-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-925"><a href="#cb44-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-928"><a href="#cb44-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-929"><a href="#cb44-929" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-930"><a href="#cb44-930" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-931"><a href="#cb44-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-932"><a href="#cb44-932" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="ot">&lt;-</span> </span>
<span id="cb44-933"><a href="#cb44-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb44-934"><a href="#cb44-934" aria-hidden="true" tabindex="-1"></a>    <span class="at">grp =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Actual = -0.5"</span>, <span class="dv">201</span>), <span class="fu">rep</span>(<span class="st">"H0 = 0"</span>, <span class="dv">201</span>), <span class="fu">rep</span>(<span class="st">"Actual = +0.5"</span>, <span class="dv">201</span>)), </span>
<span id="cb44-935"><a href="#cb44-935" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Actual = -0.5"</span>, <span class="st">"H0 = 0"</span>, <span class="st">"Actual = +0.5"</span>)),</span>
<span id="cb44-936"><a href="#cb44-936" aria-hidden="true" tabindex="-1"></a>    <span class="at">rating_diff =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">01</span>), <span class="dv">3</span>),</span>
<span id="cb44-937"><a href="#cb44-937" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> (rating_diff <span class="sc">-</span> <span class="fu">case_when</span>(grp <span class="sc">==</span> <span class="st">"H0 = 0"</span> <span class="sc">~</span> <span class="dv">0</span>, </span>
<span id="cb44-938"><a href="#cb44-938" aria-hidden="true" tabindex="-1"></a>                                 grp <span class="sc">==</span> <span class="st">"Actual = -0.5"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb44-939"><a href="#cb44-939" aria-hidden="true" tabindex="-1"></a>                                 grp <span class="sc">==</span> <span class="st">"Actual = +0.5"</span> <span class="sc">~</span> <span class="fl">0.5</span>)) <span class="sc">/</span> SE,</span>
<span id="cb44-940"><a href="#cb44-940" aria-hidden="true" tabindex="-1"></a>    <span class="at">dens =</span> <span class="fu">map_dbl</span>(x, \(x) <span class="fu">dt</span>(x, <span class="at">df =</span> df))</span>
<span id="cb44-941"><a href="#cb44-941" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-942"><a href="#cb44-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-943"><a href="#cb44-943" aria-hidden="true" tabindex="-1"></a>sampling_dist <span class="sc">|&gt;</span></span>
<span id="cb44-944"><a href="#cb44-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-945"><a href="#cb44-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">y =</span> dens, <span class="at">color =</span> grp, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb44-946"><a href="#cb44-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-947"><a href="#cb44-947" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating_diff <span class="sc">&lt;=</span> crit_diff_l <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = 0"</span>, dens, <span class="cn">NA_real_</span>)), </span>
<span id="cb44-948"><a href="#cb44-948" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-949"><a href="#cb44-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-950"><a href="#cb44-950" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating_diff <span class="sc">&gt;=</span> crit_diff_u <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"H0 = 0"</span>, dens, <span class="cn">NA_real_</span>)), </span>
<span id="cb44-951"><a href="#cb44-951" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-952"><a href="#cb44-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-953"><a href="#cb44-953" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating_diff <span class="sc">&gt;=</span> crit_diff_l <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = -0.5"</span>, dens, <span class="cn">NA_real_</span>)),</span>
<span id="cb44-954"><a href="#cb44-954" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-955"><a href="#cb44-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> rating_diff, <span class="at">color =</span> grp, <span class="at">fill =</span> grp, </span>
<span id="cb44-956"><a href="#cb44-956" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">if_else</span>(rating_diff <span class="sc">&lt;=</span> crit_diff_u <span class="sc">&amp;</span> grp <span class="sc">==</span> <span class="st">"Actual = +0.5"</span>, dens, <span class="cn">NA_real_</span>)),</span>
<span id="cb44-957"><a href="#cb44-957" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-958"><a href="#cb44-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"beta"</span>), </span>
<span id="cb44-959"><a href="#cb44-959" aria-hidden="true" tabindex="-1"></a>            <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-960"><a href="#cb44-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> .<span class="dv">35</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), </span>
<span id="cb44-961"><a href="#cb44-961" aria-hidden="true" tabindex="-1"></a>            <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-962"><a href="#cb44-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"beta"</span>), </span>
<span id="cb44-963"><a href="#cb44-963" aria-hidden="true" tabindex="-1"></a>            <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod4"</span>) <span class="sc">+</span></span>
<span id="cb44-964"><a href="#cb44-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">35</span>, <span class="at">y =</span> .<span class="dv">03</span>, <span class="at">label =</span> <span class="st">"alpha"</span>), </span>
<span id="cb44-965"><a href="#cb44-965" aria-hidden="true" tabindex="-1"></a>            <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb44-966"><a href="#cb44-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-967"><a href="#cb44-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-968"><a href="#cb44-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">+</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"darkgoldenrod"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-969"><a href="#cb44-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, </span>
<span id="cb44-970"><a href="#cb44-970" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Actual = -0.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>, </span>
<span id="cb44-971"><a href="#cb44-971" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Actual = +0.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-972"><a href="#cb44-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"H0 = 0"</span> <span class="ot">=</span> <span class="st">"gray30"</span>, </span>
<span id="cb44-973"><a href="#cb44-973" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Actual = -0.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>,</span>
<span id="cb44-974"><a href="#cb44-974" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Actual = +0.5"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod"</span>)) <span class="sc">+</span></span>
<span id="cb44-975"><a href="#cb44-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, crit_diff_l, crit_diff_u), <span class="at">labels =</span> <span class="fu">comma_format</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-976"><a href="#cb44-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-977"><a href="#cb44-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb44-978"><a href="#cb44-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb44-979"><a href="#cb44-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-980"><a href="#cb44-980" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Difference in Likert Rating Average"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-981"><a href="#cb44-981" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-982"><a href="#cb44-982" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Power Analysis for Independent Sample t-Test, Two-sided"</span>,</span>
<span id="cb44-983"><a href="#cb44-983" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">80</span>),</span>
<span id="cb44-984"><a href="#cb44-984" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">str_wrap</span>(<span class="fu">glue</span>(</span>
<span id="cb44-985"><a href="#cb44-985" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Effect size d = .5, 80% power, Sample sizes n1 = {comma(n1)}, "</span>,</span>
<span id="cb44-986"><a href="#cb44-986" aria-hidden="true" tabindex="-1"></a>      <span class="st">"n2 = {comma(n2)}. "</span>,</span>
<span id="cb44-987"><a href="#cb44-987" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Diff in averages &gt; {comma(crit_diff, .1)} reject H0 at alpha = .05."</span></span>
<span id="cb44-988"><a href="#cb44-988" aria-hidden="true" tabindex="-1"></a>    ), <span class="dv">95</span>)</span>
<span id="cb44-989"><a href="#cb44-989" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-990"><a href="#cb44-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-991"><a href="#cb44-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-992"><a href="#cb44-992" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-value Intuition</span></span>
<span id="cb44-993"><a href="#cb44-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-994"><a href="#cb44-994" aria-hidden="true" tabindex="-1"></a>What distribution of p-values would you expect if there *is* a true effect and you repeated the study many times? What if there is *no* true effect? The answer is completely determined by the statistical power of the study.^<span class="co">[</span><span class="ot">This section is based on ideas I learned from homework assignment 1 in Daniel Lakens's Coursera class [Improving your statistical inferences](https://www.coursera.org/learn/statistical-inferences/home/welcome).</span><span class="co">]</span></span>
<span id="cb44-995"><a href="#cb44-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-996"><a href="#cb44-996" aria-hidden="true" tabindex="-1"></a>To see this, run 100,000 simulations of an experiment measuring the average IQ from a sample of size *n* = 26. The samples will be 26 random values from the normal distribution centered at 106 with a standard deviation of 15. H0 is $\mu$ = 100.</span>
<span id="cb44-997"><a href="#cb44-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1000"><a href="#cb44-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1001"><a href="#cb44-1001" aria-hidden="true" tabindex="-1"></a><span class="co"># 100,000 random samples of IQ simulations from a normal distribution where</span></span>
<span id="cb44-1002"><a href="#cb44-1002" aria-hidden="true" tabindex="-1"></a><span class="co"># SIGMA = 15. True population value is 100, but we'll try other values.</span></span>
<span id="cb44-1003"><a href="#cb44-1003" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="fl">1E5</span></span>
<span id="cb44-1004"><a href="#cb44-1004" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb44-1005"><a href="#cb44-1005" aria-hidden="true" tabindex="-1"></a>SIGMA <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb44-1006"><a href="#cb44-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1007"><a href="#cb44-1007" aria-hidden="true" tabindex="-1"></a>run_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">MU_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">26</span>) {</span>
<span id="cb44-1008"><a href="#cb44-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n_sims) <span class="sc">%&gt;%</span></span>
<span id="cb44-1009"><a href="#cb44-1009" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb44-1010"><a href="#cb44-1010" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">map</span>(i, <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> MU_0, <span class="at">sd =</span> SIGMA)),</span>
<span id="cb44-1011"><a href="#cb44-1011" aria-hidden="true" tabindex="-1"></a>      <span class="at">z =</span> <span class="fu">map</span>(x, <span class="sc">~</span> <span class="fu">t.test</span>(., <span class="at">mu =</span> mu)),</span>
<span id="cb44-1012"><a href="#cb44-1012" aria-hidden="true" tabindex="-1"></a>      <span class="at">p =</span> <span class="fu">map_dbl</span>(z, <span class="sc">~</span> .x<span class="sc">$</span>p.value),</span>
<span id="cb44-1013"><a href="#cb44-1013" aria-hidden="true" tabindex="-1"></a>      <span class="at">x_bar =</span> <span class="fu">map_dbl</span>(x, mean)</span>
<span id="cb44-1014"><a href="#cb44-1014" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb44-1015"><a href="#cb44-1015" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(x_bar, p)</span>
<span id="cb44-1016"><a href="#cb44-1016" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-1017"><a href="#cb44-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1018"><a href="#cb44-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1019"><a href="#cb44-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb44-1020"><a href="#cb44-1020" aria-hidden="true" tabindex="-1"></a><span class="in">plot_sim &lt;- function(x, MU_0 = 106, n = 26, </span></span>
<span id="cb44-1021"><a href="#cb44-1021" aria-hidden="true" tabindex="-1"></a><span class="in">                     n_breaks = 20, x_lim = c(0, 1), </span></span>
<span id="cb44-1022"><a href="#cb44-1022" aria-hidden="true" tabindex="-1"></a><span class="in">                     p_max = 1.0) {</span></span>
<span id="cb44-1023"><a href="#cb44-1023" aria-hidden="true" tabindex="-1"></a><span class="in">  test_power = sum(x$p &lt; .05) / n_sims</span></span>
<span id="cb44-1024"><a href="#cb44-1024" aria-hidden="true" tabindex="-1"></a><span class="in">  x %&gt;% </span></span>
<span id="cb44-1025"><a href="#cb44-1025" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(p &lt;= p_max) %&gt;%</span></span>
<span id="cb44-1026"><a href="#cb44-1026" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = p)) +</span></span>
<span id="cb44-1027"><a href="#cb44-1027" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_bar(fill = "lightgoldenrod") + </span></span>
<span id="cb44-1028"><a href="#cb44-1028" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_binned(n.breaks = n_breaks, limits = x_lim, labels = waiver()) +</span></span>
<span id="cb44-1029"><a href="#cb44-1029" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_hline(yintercept = n_sims / n_breaks * p_max, color = "firebrick", linetype = 2) +</span></span>
<span id="cb44-1030"><a href="#cb44-1030" aria-hidden="true" tabindex="-1"></a><span class="in">    annotate("text", x = .8, y = n_sims / n_breaks * p_max, label = "5%") +</span></span>
<span id="cb44-1031"><a href="#cb44-1031" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_light() +</span></span>
<span id="cb44-1032"><a href="#cb44-1032" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(labels = scales::comma_format(), limits = c(0, n_sims)) +</span></span>
<span id="cb44-1033"><a href="#cb44-1033" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(</span></span>
<span id="cb44-1034"><a href="#cb44-1034" aria-hidden="true" tabindex="-1"></a><span class="in">      title = glue(</span></span>
<span id="cb44-1035"><a href="#cb44-1035" aria-hidden="true" tabindex="-1"></a><span class="in">        "Measured p-values in {n_sims} simulations of samples of size {n} distributed \n",</span></span>
<span id="cb44-1036"><a href="#cb44-1036" aria-hidden="true" tabindex="-1"></a><span class="in">        "N({MU_0}, {SIGMA}^2) with H0 = 100. Power of the test is {scales::percent(test_power)}."</span></span>
<span id="cb44-1037"><a href="#cb44-1037" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb44-1038"><a href="#cb44-1038" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb44-1039"><a href="#cb44-1039" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb44-1040"><a href="#cb44-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1041"><a href="#cb44-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1042"><a href="#cb44-1042" aria-hidden="true" tabindex="-1"></a>The null hypothesis is that the average IQ is 100. Our rigged simulation finds an average IQ of 106 - an effect size of 6. </span>
<span id="cb44-1043"><a href="#cb44-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1044"><a href="#cb44-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb44-1045"><a href="#cb44-1045" aria-hidden="true" tabindex="-1"></a><span class="in">sim_106_26 &lt;- run_sim(MU_0 = 106, n = 26)</span></span>
<span id="cb44-1046"><a href="#cb44-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1047"><a href="#cb44-1047" aria-hidden="true" tabindex="-1"></a><span class="in">glimpse(sim_106_26)</span></span>
<span id="cb44-1048"><a href="#cb44-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1049"><a href="#cb44-1049" aria-hidden="true" tabindex="-1"></a><span class="in">mean(sim_106_26$x_bar)</span></span>
<span id="cb44-1050"><a href="#cb44-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1051"><a href="#cb44-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1052"><a href="#cb44-1052" aria-hidden="true" tabindex="-1"></a>The statistical power achieved by the simulations is 50%. That is, the typical simulation detected the effect size of 6 at the .05 significance level about 50% of the time. </span>
<span id="cb44-1053"><a href="#cb44-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1056"><a href="#cb44-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1057"><a href="#cb44-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb44-1058"><a href="#cb44-1058" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">26</span>,</span>
<span id="cb44-1059"><a href="#cb44-1059" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> (<span class="dv">106</span> <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb44-1060"><a href="#cb44-1060" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb44-1061"><a href="#cb44-1061" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb44-1062"><a href="#cb44-1062" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb44-1063"><a href="#cb44-1063" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-1064"><a href="#cb44-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1065"><a href="#cb44-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1066"><a href="#cb44-1066" aria-hidden="true" tabindex="-1"></a>That means that given a population with an average IQ of 106, a two-sided hypothesis test of H0: $\mu$ = 100 from a sample of size 26 will measure an $\bar{x}$ with a *p*-value under .05 only 50% of the time. You can see that in this histogram of *p*-values.</span>
<span id="cb44-1067"><a href="#cb44-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1070"><a href="#cb44-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1071"><a href="#cb44-1071" aria-hidden="true" tabindex="-1"></a>sim_106_26 <span class="sc">%&gt;%</span> <span class="fu">plot_sim</span>()</span>
<span id="cb44-1072"><a href="#cb44-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1073"><a href="#cb44-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1074"><a href="#cb44-1074" aria-hidden="true" tabindex="-1"></a>Had there been no effect to observe, you'd expect all *p*-values to be equally likely, so the 20 bins would all have been 5% of the number of simulations -- i.e., *uniformly distributed under the null*. This is called "0 power", although 5% of the *p*-values will still be significant at the .05 level. The 5% of *p*-values &lt; .05 is the Type II error rate - that probability of a positive test result when there is no actual effect to observe.</span>
<span id="cb44-1075"><a href="#cb44-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1078"><a href="#cb44-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1079"><a href="#cb44-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">MU_0 =</span> <span class="dv">100</span>, <span class="at">n =</span> <span class="dv">26</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-1080"><a href="#cb44-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_sim</span>(<span class="at">MU_0 =</span> <span class="dv">100</span>)</span>
<span id="cb44-1081"><a href="#cb44-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1082"><a href="#cb44-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1083"><a href="#cb44-1083" aria-hidden="true" tabindex="-1"></a>If you want a higher powered study that would detect the effect at least 80% of the time (the normal standard), you'll need a higher sample size. How high? Conduct the power analysis again, but specify the power while leaving out the sample size.</span>
<span id="cb44-1084"><a href="#cb44-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1087"><a href="#cb44-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1088"><a href="#cb44-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb44-1089"><a href="#cb44-1089" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb44-1090"><a href="#cb44-1090" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> (<span class="dv">106</span> <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb44-1091"><a href="#cb44-1091" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb44-1092"><a href="#cb44-1092" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb44-1093"><a href="#cb44-1093" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb44-1094"><a href="#cb44-1094" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-1095"><a href="#cb44-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1096"><a href="#cb44-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1097"><a href="#cb44-1097" aria-hidden="true" tabindex="-1"></a>You need 51 people (technically, you might want to round up to 52). Here's what that looks like. 80% of *p*-values are below .05 now.</span>
<span id="cb44-1098"><a href="#cb44-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1101"><a href="#cb44-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1102"><a href="#cb44-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">MU_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-1103"><a href="#cb44-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_sim</span>(<span class="at">MU_0 =</span> <span class="dv">106</span>)</span>
<span id="cb44-1104"><a href="#cb44-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1105"><a href="#cb44-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1106"><a href="#cb44-1106" aria-hidden="true" tabindex="-1"></a>So far, we've discovered that when there *is* an effect, the probability that the measure *p*-value is under the $\alpha$ significance level equals the *power of the study*, 1 - $\beta$ - the *true positive* rate, and $\beta$ will be above the $\alpha$ level - the *false negative* rate. We've also discovered that when there is *no* effect, all *p*-values are equally likely, so $\alpha$ of them will be below the $alpha$ level of significance - the *false positive* rate, and 1 - $\alpha$ will be above $\alpha$ - the *true negative* rate.</span>
<span id="cb44-1107"><a href="#cb44-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1108"><a href="#cb44-1108" aria-hidden="true" tabindex="-1"></a>It's not the case that all p-values below 0.05 are support for the alternative hypothesis. If the statistical power is high enough, a *p*-value just under .05 can be even *less* likely under the null hypothesis.</span>
<span id="cb44-1109"><a href="#cb44-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1112"><a href="#cb44-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1113"><a href="#cb44-1113" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">MU_0 =</span> <span class="dv">108</span>, <span class="at">n =</span> <span class="dv">51</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb44-1114"><a href="#cb44-1114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bin =</span> <span class="fu">case_when</span>(p <span class="sc">&lt;</span> .<span class="dv">01</span> <span class="sc">~</span> <span class="st">"0.00 - 0.01"</span>,</span>
<span id="cb44-1115"><a href="#cb44-1115" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">02</span> <span class="sc">~</span> <span class="st">"0.01 - 0.02"</span>,</span>
<span id="cb44-1116"><a href="#cb44-1116" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">03</span> <span class="sc">~</span> <span class="st">"0.02 - 0.03"</span>,</span>
<span id="cb44-1117"><a href="#cb44-1117" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">04</span> <span class="sc">~</span> <span class="st">"0.03 - 0.04"</span>,</span>
<span id="cb44-1118"><a href="#cb44-1118" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">05</span> <span class="sc">~</span> <span class="st">"0.04 - 0.05"</span>,</span>
<span id="cb44-1119"><a href="#cb44-1119" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span>)</span>
<span id="cb44-1120"><a href="#cb44-1120" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-1121"><a href="#cb44-1121" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(bin)</span>
<span id="cb44-1122"><a href="#cb44-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1123"><a href="#cb44-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1124"><a href="#cb44-1124" aria-hidden="true" tabindex="-1"></a>(Recall that under H0, all *p*-values are equally likely, so each of the percentile bins would contain 1% of *p*-values.)</span>
<span id="cb44-1125"><a href="#cb44-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1126"><a href="#cb44-1126" aria-hidden="true" tabindex="-1"></a>In fact, at best, a *p*-value between .04 and .05 can only be about four times as likely under the alternative hypothesis as the null hypothesis. If your *p*-value is just under .05, it is at best weak support for the alternative hypothesis.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>