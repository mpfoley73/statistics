<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; One-Sample – Statistical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./pt1-group-differences.html" rel="next">
<link href="./03-bayesian-statistics.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-one-sample.html">Point Estimates</a></li><li class="breadcrumb-item"><a href="./04-one-sample.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One-Sample</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Inference</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Frequentist</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-frequentist-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Frequentist Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-likelihood-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Likelihood Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Bayesian</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-bayesian-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Point Estimates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-one-sample.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One-Sample</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pt1-group-differences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Group Differences</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-continuous-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Continuous ~ Binomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-continuous-binomial-pairwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Paired Samples t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-continuous-multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous ~ Multnomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-binomial-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binomial ~ Binomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-multinomial-multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multinomial ~ Multinomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-binomial-multinomial-pairwise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Pairwise Discrete ~ Multinomial</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Association</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-association.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Association</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Reference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-matrix-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix Algebra</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#one-sample-mean-z-test" id="toc-one-sample-mean-z-test" class="nav-link active" data-scroll-target="#one-sample-mean-z-test"><span class="header-section-number">4.1</span> One-Sample Mean z Test</a>
  <ul>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#one-sample-mean-t-test" id="toc-one-sample-mean-t-test" class="nav-link" data-scroll-target="#one-sample-mean-t-test"><span class="header-section-number">4.2</span> One-Sample Mean t Test</a>
  <ul>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#conditions" id="toc-conditions" class="nav-link" data-scroll-target="#conditions">Conditions</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#appendix-deciding-sample-size" id="toc-appendix-deciding-sample-size" class="nav-link" data-scroll-target="#appendix-deciding-sample-size">Appendix: Deciding Sample Size</a></li>
  </ul></li>
  <li><a href="#one-sample-median-wilcoxon-test" id="toc-one-sample-median-wilcoxon-test" class="nav-link" data-scroll-target="#one-sample-median-wilcoxon-test"><span class="header-section-number">4.3</span> One-Sample Median Wilcoxon Test</a></li>
  <li><a href="#chi-squared-goodness-of-fit-test" id="toc-chi-squared-goodness-of-fit-test" class="nav-link" data-scroll-target="#chi-squared-goodness-of-fit-test"><span class="header-section-number">4.4</span> Chi-Squared Goodness-of-Fit Test</a>
  <ul>
  <li><a href="#example-with-theoretical-values" id="toc-example-with-theoretical-values" class="nav-link" data-scroll-target="#example-with-theoretical-values">Example with Theoretical Values</a></li>
  <li><a href="#conditions-1" id="toc-conditions-1" class="nav-link" data-scroll-target="#conditions-1">Conditions</a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1">Results</a></li>
  <li><a href="#example-with-theoretical-distribution" id="toc-example-with-theoretical-distribution" class="nav-link" data-scroll-target="#example-with-theoretical-distribution">Example with Theoretical Distribution</a></li>
  <li><a href="#conditions-2" id="toc-conditions-2" class="nav-link" data-scroll-target="#conditions-2">Conditions</a></li>
  <li><a href="#results-2" id="toc-results-2" class="nav-link" data-scroll-target="#results-2">Results</a></li>
  </ul></li>
  <li><a href="#g-test" id="toc-g-test" class="nav-link" data-scroll-target="#g-test"><span class="header-section-number">4.5</span> G-Test</a></li>
  <li><a href="#one-sample-poisson-test" id="toc-one-sample-poisson-test" class="nav-link" data-scroll-target="#one-sample-poisson-test"><span class="header-section-number">4.6</span> One-Sample Poisson Test</a>
  <ul>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  <li><a href="#conditions-3" id="toc-conditions-3" class="nav-link" data-scroll-target="#conditions-3">Conditions</a></li>
  <li><a href="#results-3" id="toc-results-3" class="nav-link" data-scroll-target="#results-3">Results</a></li>
  </ul></li>
  <li><a href="#exact-binomial-test" id="toc-exact-binomial-test" class="nav-link" data-scroll-target="#exact-binomial-test"><span class="header-section-number">4.7</span> Exact Binomial Test</a>
  <ul>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3">Example</a></li>
  </ul></li>
  <li><a href="#one-sample-proportion-z-test" id="toc-one-sample-proportion-z-test" class="nav-link" data-scroll-target="#one-sample-proportion-z-test"><span class="header-section-number">4.8</span> One-Sample Proportion z Test</a>
  <ul>
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4">Example</a></li>
  </ul></li>
  <li><a href="#sample-t-test-for-categorical-var" id="toc-sample-t-test-for-categorical-var" class="nav-link" data-scroll-target="#sample-t-test-for-categorical-var"><span class="header-section-number">4.9</span> 1 sample t Test for Categorical Var</a></li>
  <li><a href="#wilcoxon-1-sample-median-test-for-categorical-var" id="toc-wilcoxon-1-sample-median-test-for-categorical-var" class="nav-link" data-scroll-target="#wilcoxon-1-sample-median-test-for-categorical-var"><span class="header-section-number">4.10</span> Wilcoxon 1-Sample Median Test for Categorical Var</a></li>
  <li><a href="#multivariate-statistics" id="toc-multivariate-statistics" class="nav-link" data-scroll-target="#multivariate-statistics"><span class="header-section-number">4.11</span> Multivariate Statistics</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-one-sample.html">Point Estimates</a></li><li class="breadcrumb-item"><a href="./04-one-sample.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One-Sample</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">One-Sample</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Use <em>one-sample</em> tests to either <em>describe</em> a single variable’s frequency or central tendency, or to <em>compare</em> the frequency or central tendency to a hypothesized distribution or value.</p>
<p>If the data generating process produces continuous outcomes (interval or ratio), and the outcomes are symmetrically distributed, the sample mean, <span class="math inline">\(\bar{x}\)</span>, is a random variable centered at the population mean, <span class="math inline">\(\mu\)</span>. You can then use a theoretical distribution (normal or student t) to estimate a 95% confidence interval (CI) around <span class="math inline">\(\mu\)</span>, or compare <span class="math inline">\(\bar{x}\)</span> to an hypothesized population mean, <span class="math inline">\(\mu_0\)</span>. If you (somehow) know the population variance, or the Central Limit Theorem (CLT) conditions hold, you can assume the random variable is normally distributed and use the <em>z</em>-test, otherwise assume the random variable has student <em>t</em> distribution and use the <em>t</em>-test.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> If the data generating process produces continuous outcomes that are <em>not</em> symmetrically distributed, use a non-parametric test like the Wilcoxon median test.</p>
<p>If the data generating process produces discrete outcomes (counts), the sample count, <span class="math inline">\(x\)</span>, is a random variable from a Poisson, binomial, normal, or multinomial distribution, or a random variable from a theoretical outcome. Whatever the source of the expected values, you use either the <em>chi-squared goodness-of-fit</em> test or <em>G</em> test to test whether the observed values fit the expected values from the distribution. In the special case of binary outcomes with small (<em>n</em> &lt; 1,000), you can use Fisher’s exact test instead. The discrete variable tests are discussed in <a href="https://online.stat.psu.edu/stat504">PSU STATS 504</a>.</p>
<ul>
<li><p>For counts over a fixed time or space, treat the count as a random variable from a Poisson distribution with expected value <span class="math inline">\(\lambda\)</span> and variance <span class="math inline">\(\lambda\)</span>.</p></li>
<li><p>For counts within a fixed total that are then classified into two levels (usually yes/no), then treat the count as a random variable from a binomial distribution with expected value <span class="math inline">\(n\pi\)</span> and variance <span class="math inline">\(n\pi(1-\pi)\)</span>.</p></li>
<li><p>For binomial distributions where <span class="math inline">\(n\ge30\)</span> and the frequency counts of both levels is <span class="math inline">\(\ge\)</span> 5, treat the <em>proportion</em> as a random variable from the normal distribution with expected valued <span class="math inline">\(\pi\)</span> and variance <span class="math inline">\(\frac{\pi(1-\pi)}{n}\)</span>.</p></li>
<li><p>For counts within a fixed total that are then classified into three or more levels, treat the count as a random variable from the multinomial distribution with expected value <span class="math inline">\(n\pi_j\)</span> and variance <span class="math inline">\(n\pi_j(1-\pi_j)\)</span>.</p></li>
</ul>
<section id="one-sample-mean-z-test" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="one-sample-mean-z-test"><span class="header-section-number">4.1</span> One-Sample Mean z Test</h2>
<p>The <em>z</em> test is also called the normal approximation <em>z</em> test. It only applies when the sampling distribution of the population mean is normally distributed with known variance, and there are no significant outliers. The sampling distribution is normally distributed when the underlying population is normally distributed, or when the sample size is large <span class="math inline">\((n &gt;= 30)\)</span>, as follows from the central limit theorem. The <em>t</em> test returns similar results, plus it is valid when the variance is unknown, and that is pretty much always. For that reason, you probably will never use this test.</p>
<p>Under the normal approximation method, the measured mean <span class="math inline">\(\bar{x}\)</span> approximates the population mean <span class="math inline">\(\mu\)</span>, and the sampling distribution has a normal distribution centered at <span class="math inline">\(\mu\)</span> with standard error <span class="math inline">\(se_\mu = \frac{\sigma}{\sqrt{n}}\)</span> where <span class="math inline">\(\sigma\)</span> is the standard deviation of the underlying population. Define a <span class="math inline">\((1 - \alpha)\%\)</span> confidence interval as <span class="math inline">\(\bar{x} \pm z_{(1 - \alpha) {/} 2} se_\mu\)</span>, or test <span class="math inline">\(H_0: \mu = \mu_0\)</span> with test statistic <span class="math inline">\(Z = \frac{\bar{x} - \mu_0}{se_\mu}\)</span>.</p>
<section id="example" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example">Example</h4>
<p>The <code>mtcars</code> data set is a sample of <em>n</em> = 32 cars. The mean fuel economy is <span class="math inline">\(\bar{x} \pm s\)</span> = 20.1 <span class="math inline">\(\pm\)</span> 6.0 mpg. The prior measured overall fuel economy for vehicles was <span class="math inline">\(\mu_0 \pm \sigma\)</span> = 18.0 <span class="math inline">\(\pm\)</span> 6.0 mpg. Has fuel economy improved?</p>
<p>The sample size is <span class="math inline">\(\ge\)</span> 30, so the sampling distribution of the population mean is normally distributed. The population variance is known, so use the <em>z</em> test.</p>
<p><span class="math inline">\(H_0: \mu = 16.0\)</span>, and <span class="math inline">\(H_a: \mu &gt; 16.0\)</span> - a right-tail test. The test statistic is <span class="math inline">\(Z = \frac{\bar{x} - \mu_0}{se_\mu}=\)</span> 1.97 where <span class="math inline">\(se_{\mu_0} = \frac{\mu_0}{\sqrt{n}} =\)</span> 1.06. <span class="math inline">\(P(z &gt; Z) =\)</span> 0.0244, so reject <span class="math inline">\(H_0\)</span> at the <span class="math inline">\(\alpha =\)</span> 0.05 level of significance.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>The 95% confidence interval for <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\bar{x} \pm z_{(1 - \alpha){/}2} se_\mu\)</span> where <span class="math inline">\(z_{(1 - \alpha){/}2} =\)</span> 1.96. <span class="math inline">\(\mu =\)</span> 20.09 <span class="math inline">\(\pm\)</span> 2.08 (95% CI 18.01 to 22.17).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="one-sample-mean-t-test" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="one-sample-mean-t-test"><span class="header-section-number">4.2</span> One-Sample Mean t Test</h2>
<p>The one-sample <em>t</em> test applies when the sampling distribution of the population mean is normally distributed and there are no significant outliers. Unlike the <em>z</em> test, the population variance can be unknown. The sampling distribution is normally distributed when the underlying population is normally distributed, or when the sample size is large <span class="math inline">\((n &gt;= 30)\)</span>, as follows from the central limit theorem.</p>
<p>Under the <em>t</em> test method, the measured mean, <span class="math inline">\(\bar{x}\)</span>, approximates the population mean, <span class="math inline">\(\mu\)</span>. The sample standard deviation, <span class="math inline">\(s\)</span>, estimates the unknown population standard deviation, <span class="math inline">\(\sigma\)</span>. The resulting sampling distribution has a <em>t</em> distribution centered at <span class="math inline">\(\mu\)</span> with standard error <span class="math inline">\(se_\bar{x} = \frac{s}{\sqrt{n}}\)</span>. Define a <span class="math inline">\((1 - \alpha)\%\)</span> confidence interval as <span class="math inline">\(\bar{x} \pm t_{(1 - \alpha){/}2} se_\bar{x}\)</span> and/or test <span class="math inline">\(H_0: \mu = \mu_0\)</span> with test statistic <span class="math inline">\(T = \frac{\bar{x} - \mu_0}{se_\bar{x}}\)</span>.</p>
<section id="example-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-1">Example</h4>
<p>A researcher recruits a random sample of <em>n</em> = 40 people to participate in a study about depression intervention. The researcher measures the participants’ depression level prior to the study. The mean depression score (3.72 <span class="math inline">\(\pm\)</span> 0.74) was lower than the population ‘normal’ depression score of 4.0. The null hypothesis is that the sample is representative of the overall population. Should you reject <span class="math inline">\(H_0\)</span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dep <span class="sc">%&gt;%</span> gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(<span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="zbmwqfhblt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zbmwqfhblt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zbmwqfhblt thead, #zbmwqfhblt tbody, #zbmwqfhblt tfoot, #zbmwqfhblt tr, #zbmwqfhblt td, #zbmwqfhblt th {
  border-style: none;
}

#zbmwqfhblt p {
  margin: 0;
  padding: 0;
}

#zbmwqfhblt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zbmwqfhblt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zbmwqfhblt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zbmwqfhblt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zbmwqfhblt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zbmwqfhblt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zbmwqfhblt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zbmwqfhblt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zbmwqfhblt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zbmwqfhblt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zbmwqfhblt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zbmwqfhblt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zbmwqfhblt .gt_spanner_row {
  border-bottom-style: hidden;
}

#zbmwqfhblt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zbmwqfhblt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zbmwqfhblt .gt_from_md > :first-child {
  margin-top: 0;
}

#zbmwqfhblt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zbmwqfhblt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zbmwqfhblt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zbmwqfhblt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zbmwqfhblt .gt_row_group_first td {
  border-top-width: 2px;
}

#zbmwqfhblt .gt_row_group_first th {
  border-top-width: 2px;
}

#zbmwqfhblt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zbmwqfhblt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zbmwqfhblt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zbmwqfhblt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zbmwqfhblt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zbmwqfhblt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zbmwqfhblt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zbmwqfhblt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zbmwqfhblt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zbmwqfhblt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zbmwqfhblt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zbmwqfhblt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zbmwqfhblt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zbmwqfhblt .gt_left {
  text-align: left;
}

#zbmwqfhblt .gt_center {
  text-align: center;
}

#zbmwqfhblt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zbmwqfhblt .gt_font_normal {
  font-weight: normal;
}

#zbmwqfhblt .gt_font_bold {
  font-weight: bold;
}

#zbmwqfhblt .gt_font_italic {
  font-style: italic;
}

#zbmwqfhblt .gt_super {
  font-size: 65%;
}

#zbmwqfhblt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zbmwqfhblt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zbmwqfhblt .gt_indent_1 {
  text-indent: 5px;
}

#zbmwqfhblt .gt_indent_2 {
  text-indent: 10px;
}

#zbmwqfhblt .gt_indent_3 {
  text-indent: 15px;
}

#zbmwqfhblt .gt_indent_4 {
  text-indent: 20px;
}

#zbmwqfhblt .gt_indent_5 {
  text-indent: 25px;
}

#zbmwqfhblt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zbmwqfhblt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="<div data-qmd-base64=&quot;KipDaGFyYWN0ZXJpc3RpYyoq&quot;><div class='gt_from_md'><p><strong>Characteristic</strong></p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><p><strong>Characteristic</strong></p></th>
<th id="<div data-qmd-base64=&quot;KipOID0gNDAqKg==&quot;><div class='gt_from_md'><p><strong>N = 40</strong></p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p><strong>N = 40</strong></p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">dep_score</td>
<td class="gt_row gt_center" headers="stat_0">3.72 (0.74)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
<p>Mean (SD)</p></td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="conditions" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conditions">Conditions</h4>
<p>The one-sample <em>t</em> test applies when the variable is continuous and the observations are independent. Additionally, there are two conditions related to the data distribution. If either condition fails, try the suggested work-arounds or use the non-parametric [Wilcoxon 1-Sample Median Test for Numeric Var] instead.</p>
<ol type="1">
<li><strong>Outliers</strong>. There should be no significant outliers. Outliers exert a large influence on the mean and standard deviation. Test with a box plot. If there are outliers, you might be able to drop them or transform the data.</li>
<li><strong>Normality</strong>. Values should be <em>nearly</em> normally distributed (“nearly” because the <em>t</em>-test is robust to the normality assumption). This condition is especially important with small sample sizes. Test with Q-Q plots or the Shapiro-Wilk test for normality. If the data is very non-normal, you might be able to transform the data.</li>
</ol>
<section id="outliers" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="outliers">Outliers</h5>
<p>Assess outliers with a box plot. Box plot whiskers extend up to 1.5*IQR from the upper and lower hinges and outliers (beyond the whiskers) are are plotted individually. The boxplot shows no outliers.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If the outliers might are data entry errors or measurement errors, fix them or discard them. If the outliers are genuine, you have a couple options before reverting to Wilcoxon.</p>
<ul>
<li>Transform the variable. Don’t do this unless the variable is also non-normal. Transformation also has the downside of making interpretation more difficult.</li>
<li>Leave it in if it doesn’t affect the conclusion (compared to taking it out).</li>
</ul>
</section>
<section id="normality" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="normality">Normality</h5>
<p>Assume the population is normally distributed if <em>n</em> <span class="math inline">\(\ge\)</span> 30. Otherwise, asses a Q-Q plot, skewness and kurtosis values, or a histogram. If you still don’t feel confident about normality, run a [Shapiro-Wilk Test].</p>
<p>The data set has <em>n</em> = 40 observations, so you can assume normality. Here is a QQ plot anyway. The QQ plot indicates normality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dep <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> dep_score)) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">col =</span> <span class="st">"goldenrod"</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal Q-Q Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here is the Shapiro-Wilk normality test. It fails to reject the null hypothesis of a normally distributed population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(dep<span class="sc">$</span>dep_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  dep$dep_score
W = 0.98446, p-value = 0.8474</code></pre>
</div>
</div>
<p>If the data is not normally distributed, you still have a couple options before reverting to Wilcoxon.</p>
<ul>
<li>Transform the dependent variable.</li>
<li>Carry on regardless - the one-sample <em>t</em>-test is fairly robust to deviations from normality.</li>
</ul>
</section>
</section>
<section id="results" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="results">Results</h4>
<p>Conduct the <em>t</em>-test. To get a 95% CI around the <em>difference</em> (instead of around the estimate), run the test using the difference, <span class="math inline">\(\mu_0 - \bar{x}\)</span>, and leave <code>mu</code> at its default of 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(dep_95ci <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> mu_0 <span class="sc">-</span> dep<span class="sc">$</span>dep_score, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">conf.level =</span> .<span class="dv">95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  mu_0 - dep$dep_score
t = 2.3811, df = 39, p-value = 0.02224
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.04176615 0.51323385
sample estimates:
mean of x 
   0.2775 </code></pre>
</div>
</div>
<p>The difference is statistically different from 0 at the <em>p</em> = .05 level. The effect size, called Cohen’s <em>d</em>, is defined as <span class="math inline">\(d = |M_D| / s\)</span>, where <span class="math inline">\(|M_D| = \bar{x} - \mu_0\)</span>, and <span class="math inline">\(s\)</span> is the sample standard deviation. <span class="math inline">\(d &lt;.2\)</span> is considered trivial, <span class="math inline">\(.2 \le d &lt; .5\)</span> small, and <span class="math inline">\(.5 \le d &lt; .8\)</span> large.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">cohens_d</span>(dep, dep_score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(effsize) <span class="sc">%&gt;%</span> <span class="fu">abs</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d 
0.3764788 </code></pre>
</div>
</div>
<p>Cohen’s <em>d</em> is 0.38, a small effect.</p>
<p>Make a habit of constructing a plot, just to make sure your head is on straight.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>Now you are ready to report the results.</p>
<blockquote class="blockquote">
<p>A one-sample <em>t</em>-test was run to determine whether depression score in recruited subjects was different from normal, as defined as a depression score of 4.0. Depression scores were normally distributed, as assessed by Shapiro-Wilk’s test (<em>p</em> &gt; .05) and there were no outliers in the data, as assessed by inspection of a boxplot. Data are mean <span class="math inline">\(\pm\)</span> standard deviation, unless otherwise stated. Mean depression score (3.72 <span class="math inline">\(\pm\)</span> 0.74) was lower than the population “normal” depression score of 4.00, a statistically significant difference of 0.28 (95% CI, 0.04 to 0.51), t(39) = 2.38, <em>p</em> = 0.022, <em>d</em> = 0.38.</p>
</blockquote>
</section>
<section id="appendix-deciding-sample-size" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="appendix-deciding-sample-size">Appendix: Deciding Sample Size</h4>
<p>Determine the sample size required for a maximum error <span class="math inline">\(\epsilon\)</span> in the estimate by solving the confidence interval equation, <span class="math inline">\(\bar{x} \pm t_{(1 - \alpha){/}2} \frac{s}{\sqrt{n}}\)</span> for <span class="math inline">\(n=\frac{{t_{\alpha/2,n-1}^2se^2}}{{\epsilon^2}}\)</span> . Unfortunately, <span class="math inline">\(t_{\alpha/2,n-1}^2\)</span> is dependent on <span class="math inline">\(n\)</span>, so replace it with <span class="math inline">\(z_{\alpha/2}^2\)</span>. What about <span class="math inline">\(s^2\)</span>? Estimate it from the literature, a pilot study, or using the empirical rule that 95% of the range falls within two standard deviations, <span class="math inline">\(s=range / 4\)</span>.</p>
<p>For example, if the maximum tolerable error is* <span class="math inline">\(\epsilon\)</span> = 3, and <span class="math inline">\(s\)</span> is approximately 10, what sample size produces an <span class="math inline">\(\alpha\)</span> =0.05 confidence level?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(<span class="fu">qnorm</span>(.<span class="dv">975</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">3</span><span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43</code></pre>
</div>
</div>
</section>
</section>
<section id="one-sample-median-wilcoxon-test" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="one-sample-median-wilcoxon-test"><span class="header-section-number">4.3</span> One-Sample Median Wilcoxon Test</h2>
<p>The Wilcoxon one-sample median test (aka Wilcoxon signed rank test) is a non-parametric alternative to the <em>t</em>-test for cases when the the sampling distribution of the population mean is <em>not</em> normally distributed, but is at least symmetric.</p>
<p>Under the Wilcoxon test, the measured median, <span class="math inline">\(\eta_x\)</span>, approximates the population median, <span class="math inline">\(\eta\)</span>. The method calculates the difference between each value and the hypothesized median, <span class="math inline">\(\eta_0\)</span>, ranks the difference magnitudes, then sums the ranks for the negative and the positive differences, <span class="math inline">\(W+\)</span> and <span class="math inline">\(W-\)</span>. The test compares the smaller of the two sums to a table of critical values.</p>
<p>Here is a case study. A store claims their checkout wait times are <span class="math inline">\(\le\)</span> 4 minutes. You challenge the claim by sampling 6 checkout experiences. The mean wait time was 4.6, but the data may violate normality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">wait =</span> wait) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> wait)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">col =</span> <span class="st">"goldenrod"</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal Q-Q Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Shapiro-Wilk rejects the null hypothesis of a normally distributed population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(wait)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  wait
W = 0.75105, p-value = 0.0204</code></pre>
</div>
</div>
<p>Use the Wilcoxon test instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(wt <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(wait, <span class="at">mu =</span> <span class="dv">4</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  wait
V = 14.5, p-value = 0.2309
alternative hypothesis: true location is greater than 4</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>A Wilcoxon Signed-Ranks Test indicated that wait times were <em>not</em> statistically significantly higher than the 4-minute claim, <em>z</em> = 14.5, <em>p</em> = 0.231.</p>
</blockquote>
</section>
<section id="chi-squared-goodness-of-fit-test" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="chi-squared-goodness-of-fit-test"><span class="header-section-number">4.4</span> Chi-Squared Goodness-of-Fit Test</h2>
<p>Use the chi-squared goodness-of-fit test to test whether the observed frequency counts, <span class="math inline">\(O_j\)</span>, of the <span class="math inline">\(J\)</span> levels of a categorical variable differ from the expected frequency counts, <span class="math inline">\(E_j\)</span>. <span class="math inline">\(H_0\)</span> is <span class="math inline">\(O_j = E_j\)</span>. You can use this test for dichotomous, nominal, or ordinal variables. There are only two conditions to use this test:</p>
<ul>
<li>the observations are independent, meaning either random assignment or random sampling without replacement from &lt;10% of the population, and</li>
<li>the <em>expected</em> frequency in each group is &gt;=5.</li>
</ul>
<p>The Pearson goodness-of-fit test statistic is</p>
<p><span class="math display">\[X^2 = \sum \frac{(O_j - E_j)^2}{E_j}\]</span></p>
<p>where <span class="math inline">\(O_j = p_j n\)</span> and <span class="math inline">\(E_j = \pi_j n\)</span>. The sampling distribution of <span class="math inline">\(X^2\)</span> approaches the <span class="math inline">\(\chi_{J-1}^2\)</span> as the sample size <span class="math inline">\(n \rightarrow \infty\)</span>. The assumption that <span class="math inline">\(X^2\)</span> is distributed <span class="math inline">\(\sim \chi^2\)</span> is not quite correct, so you will see researchers subtract .5 from the differences to increase the p-value, the so-called <a href="https://en.wikipedia.org/wiki/Yates%27s_correction_for_continuity">Yates Continuity Correction</a>.</p>
<p><span class="math display">\[X^2 = \sum \frac{(O_j - E_j - 0.5)^2}{E_j}\]</span></p>
<p><span class="math inline">\(X^2 \rightarrow 0\)</span> as the saturated model (the observed data represent the fit of the saturated model, the most complex model possible with the data) proportions approach the expected proportions, <span class="math inline">\(p_j \rightarrow \pi_j\)</span>. The chi-squared test calculates the probability of the occurrence of <span class="math inline">\(X^2\)</span> at least as extreme given that it is a chi-squared random variable with degrees of freedom equal to the number of levels of the variable minus one, <span class="math inline">\(J-1\)</span>.</p>
<section id="example-with-theoretical-values" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-with-theoretical-values">Example with Theoretical Values</h4>
<p>A researcher crosses tall cut-leaf tomatoes with dwarf potato-leaf tomatoes, then classifies the <em>n</em> = 1,611 offspring’s phenotype. The four phenotypes should occur with relative frequencies 9:3:3:1. The observed frequencies constitute a one-way table.</p>
<p>If you only care about one level (or if the variable is binary) of if, conduct a one-proportion <em>Z</em>-test or an exact binomial test. Otherwise, conduct an exact multinomial test (recommended when <em>n</em> &lt;= 1,000), Pearson’s chi-squared goodness-of-fit test, or a <em>G</em>-test.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conditions-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conditions-1">Conditions</h4>
<p>This is a randomized experiment. The minimum expected frequency was 100, so the chi-squared test of independence is valid.</p>
<p>Had the data violated the <span class="math inline">\(\ge\)</span> 5 condition, you could run an exact test (like the binomial, or in this case, the multinomial), or lump some factor levels together.</p>
</section>
<section id="results-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="results-1">Results</h4>
<p>You can calculate <span class="math inline">\(X^2\)</span> by hand, and find the probability of a test statistic at least as extreme using the <span class="math inline">\(\chi^2\)</span> distribution with 4-1 = 3 degrees of freedom.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(pheno_x2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((pheno_obs <span class="sc">-</span> pheno_exp)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> pheno_exp))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 9.54652</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>(pheno_p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="at">q =</span> pheno_x2, <span class="at">df =</span> <span class="fu">length</span>(pheno_type) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.02284158</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>That is what <code>chisq.test()</code> does. The function applies the Yates continuity correction by default, so I had to specify <code>correct = FALSE</code> to exclude it. In this case, setting it to <code>TRUE</code> has almost no effect because the sample size is large.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(pheno_chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pheno_obs, <span class="at">p =</span> pheno_pi, <span class="at">correct =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  pheno_obs
X-squared = 9.5465, df = 3, p-value = 0.02284</code></pre>
</div>
</div>
<p>As always, plot the distribution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>At this point you can report,</p>
<blockquote class="blockquote">
<p>Of the 1,611 offspring produced from the cross-fertiliation, 956 were <em>tall cut-leaf</em>, 258 were <em>tall potato-leaf</em>, 293 where <em>dwarf cut-leaf</em>, and 104 were <em>dwarf potato-leaf</em>. A chi-square goodness-of-fit test was conducted to determine whether the offspring had the same proportion of phenotypes as the theoretical distribution. The minimum expected frequency was 101. The chi-square goodness-of-fit test indicated that the number of tall cut-leaf, tall potato-leaf, dwarf cut-leaf, and dwarf potato-leaf offspring was statistically significantly different from the proportions expected in the theoretical distribution (<span class="math inline">\(X^2\)</span>(3) = 9.547, <em>p</em> = 0.023).</p>
</blockquote>
<p>If you reject <span class="math inline">\(H_0\)</span>, inspect the residuals to learn which differences contribute most to the rejection. Notice how <span class="math inline">\(X^2\)</span> is a sum of squared standardized cell differences, or “Pearson residuals”,</p>
<p><span class="math display">\[r_i = \frac{o_j - e_j}{\sqrt{e_j}}\]</span></p>
<p>Cells with the largest <span class="math inline">\(|r|\)</span> contribute the most to the total <span class="math inline">\(X^2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pheno_chisq_test<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> pheno_chisq_test<span class="sc">$</span>statistic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    tall cut-leaf  tall potato-leaf    dwarf cut-leaf dwarf potato-leaf 
       0.28682269        0.67328098        0.02848093        0.01141540 </code></pre>
</div>
</div>
<p>The two “tall” cells contributed over 95% of the <span class="math inline">\(X^2\)</span> test statistic, with the tall potato-leaf accounting for 67%. This aligns with what you’d expect from the bar plot.</p>
</section>
<section id="example-with-theoretical-distribution" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-with-theoretical-distribution">Example with Theoretical Distribution</h4>
<p>You need to reduce the degrees of freedom (df) in the chi-squared goodness-of-fit test by 1 if you test whether the data conform to a particular distribution instead of a set of theoretical values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">13</span>, <span class="dv">10</span>, <span class="dv">3</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>childr_n <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Suppose you sample <em>n</em> = 100 families and count the number of children. The count of children is a Poisson random variable, <span class="math inline">\(J\)</span>, with maximum likelihood estimate <span class="math inline">\(\hat{\lambda} = \sum{j_i O_i} / \sum{O_i}\)</span>. Test whether the observed values can be described as samples from a Poisson random variable. The probabilities for each possible count are</p>
<p><span class="math display">\[f(j; \lambda) = \frac{e^{-\hat{\lambda}} \hat{\lambda}^j}{j!}.\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conditions-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conditions-2">Conditions</h4>
<p>This is random sampling. The minimum expected frequency was 2, so the data violates the <span class="math inline">\(\ge\)</span> 5 rule. Lump the last two categories into “4-5”.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>The minimum expected frequency was 6, so now the chi-squared test of independence is valid.</p>
</section>
<section id="results-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="results-2">Results</h4>
<p>Compare the expected values to the observed values with the chi-squared goodness of fit test, but in this case <span class="math inline">\(df = 5 - 1 - 1\)</span> because the estimated parameter <span class="math inline">\(\lambda\)</span> reduces df by 1. You cannot set df in <code>chisq.test()</code>, so perform the test manually.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(X2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((o <span class="sc">-</span> e)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> e))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7.092968</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>(p.value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="at">q =</span> X2, <span class="at">df =</span> <span class="fu">length</span>(j) <span class="sc">-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.06899286</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>At this point you can report,</p>
<blockquote class="blockquote">
<p>Of the 100 families sampled, 19 had no children, 26 had one child, 29 had two children, 13 had three children, and 13 had 4 or 5 children. A chi-square goodness-of-fit test was conducted to determine whether the observed family sizes follow a Poisson distribution. The minimum expected frequency was 13. The chi-square goodness-of-fit test indicated that the number of children was not statistically significantly different from the proportions expected in the Poisson distribution (<span class="math inline">\(X^2\)</span>(3) = 7.093, <em>p</em> = 0.069).</p>
</blockquote>
</section>
</section>
<section id="g-test" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="g-test"><span class="header-section-number">4.5</span> G-Test</h2>
<p>The G-test is a likelihood-ratio statistical significance test increasingly used instead of chi-squared tests. The test statistic is defined</p>
<p><span class="math display">\[G^2 = 2 \sum O_j \log \left[ \frac{O_j}{E_j} \right]\]</span></p>
<p>where the 2 multiplier asymptotically aligns with the chi-squared test formula. <em>G</em> is distributed <span class="math inline">\(\sim \chi^2\)</span>, with the same number of degrees of freedom as in the corresponding chi-squared test. In fact, the chi-squared test statistic is a second order Taylor expansion of the natural logarithm around 1.</p>
<p>Returning to the phenotype case study in the chi-squared goodness-of-fit test section, you can calculate the <span class="math inline">\(G^2\)</span> test statistic and probability by hand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(pheno_g2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(pheno_obs <span class="sc">*</span> <span class="fu">log</span>(pheno_obs <span class="sc">/</span> pheno_exp)))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 9.836806</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">pchisq</span>(<span class="at">q =</span> pheno_g2, <span class="at">df =</span> <span class="fu">length</span>(pheno_type) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.02000552</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is pretty close to the <span class="math inline">\(X^2\)</span> = 9.547, <em>p</em> = 0.023 using the chi-squared goodness-of-fit test. The <code>DescTools::GTest()</code> function to conducts a G-test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">GTest</span>(pheno_obs, <span class="at">p =</span> pheno_pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Log likelihood ratio (G-test) goodness of fit test

data:  pheno_obs
G = 9.8368, X-squared df = 3, p-value = 0.02001</code></pre>
</div>
</div>
<p>According to the function documentation, the G-test is not usually used for 2x2 tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>EMT<span class="sc">::</span><span class="fu">multinomial.test</span>(o, f, <span class="at">useChisq =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(o, e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  o and e
X-squared = 15, df = 12, p-value = 0.2414</code></pre>
</div>
</div>
</section>
<section id="one-sample-poisson-test" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="one-sample-poisson-test"><span class="header-section-number">4.6</span> One-Sample Poisson Test</h2>
<p>If <span class="math inline">\(X\)</span> is the number of successes in <span class="math inline">\(n\)</span> (many) trials when the probability of success <span class="math inline">\(\lambda / n\)</span> is small, then <span class="math inline">\(X\)</span> is a random variable with a Poisson distribution, and the probability of observing <span class="math inline">\(X = x\)</span> successes is</p>
<p><span class="math display">\[f(x;\lambda) = \frac{e^{-\lambda} \lambda^x}{x!} \hspace{1cm} x \in (0, 1, ...), \hspace{2mm} \lambda &gt; 0\]</span></p>
<p>with <span class="math inline">\(E(X)=\lambda\)</span> and <span class="math inline">\(Var(X) = \lambda\)</span> where <span class="math inline">\(\lambda\)</span> is estimated by the sample <span class="math inline">\(\hat{\lambda}\)</span>,</p>
<p><span class="math display">\[\hat{\lambda} = \sum_{i=1}^N x_i / n.\]</span></p>
<p>Poisson sampling is used to model counts of events that occur randomly over a fixed period of time. You can use the Poisson distribution to perform an exact test on a Poisson random variable.</p>
<section id="example-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-2">Example</h4>
<p>You are analyzing goal totals from a sample consisting of the 95 matches in the first round of the 2002 World Cup. The average match produced a mean/sd of 1.38 <span class="math inline">\(\pm\)</span> 1.28 goals, lower than the 1.5 historical average. Should you reject the null hypothesis that the sample is representative of typical values?</p>
</section>
<section id="conditions-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conditions-3">Conditions</h4>
<ul>
<li>The events must be independent of each other. In this case, the goal-count in one match has no effect on goal-counts in other matches.</li>
<li>The expected value of each event must be the same (homogeneity). In this case, the expected goal-count of each match is the same regardless of which teams are playing. This assumption is often dubious, causing the distribution variance to be larger than the mean, a conditional called <em>over-dispersion</em>.</li>
</ul>
<p>You might also check whether the data is consistent with a Poisson model. This is random sampling, but the data violates the <span class="math inline">\(\ge\)</span> 5 rule because the minimum expected frequency was 0. To comply with the minimum frequency rule, lump the last six categories into “3-8”.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>The minimum expected frequency was 15, so now the chi-squared test of independence is valid. Compare the expected values to the observed values with the chi-squared goodness of fit test, but in this case <span class="math inline">\(df = 4 - 1 - 1\)</span> because the estimated parameter <span class="math inline">\(\lambda\)</span> reduces the df by 1. You cannot set df in <code>chisq.test()</code>, so perform the test manually.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(X2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((o <span class="sc">-</span> e)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> e))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8618219</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>(p.value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="at">q =</span> X2, <span class="at">df =</span> <span class="fu">length</span>(j) <span class="sc">-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.6499168</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Of the 95 World Cup matches, 23 had no goals, 37 had one goal, 20 had two goals, and 15 had 3-8 goals. A chi-square goodness-of-fit test was conducted to determine whether the observed goal counts follow a Poisson distribution. The minimum expected frequency was 15. The chi-square goodness-of-fit test indicated that the number of goals scored was not statistically significantly different from the frequencies expected from a Poisson distribution (<span class="math inline">\(X^2\)</span>(2) = 0.862, <em>p</em> = 0.650).</p>
</blockquote>
</section>
<section id="results-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="results-3">Results</h4>
<p>The conditions for the exact Poisson test were met, so go ahead and run the test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(pois_val <span class="ot">&lt;-</span> <span class="fu">poisson.test</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">sum</span>(dat_pois<span class="sc">$</span>goals <span class="sc">*</span> dat_pois<span class="sc">$</span>freq), </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">T =</span> <span class="fu">sum</span>(dat_pois<span class="sc">$</span>freq), </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r =</span> <span class="fl">1.5</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Poisson test

data:  sum(dat_pois$goals * dat_pois$freq) time base: sum(dat_pois$freq)
number of events = 131, time base = 95, p-value = 0.3567
alternative hypothesis: true event rate is not equal to 1.5
95 percent confidence interval:
 1.152935 1.636315
sample estimates:
event rate 
  1.378947 </code></pre>
</div>
</div>
<p>Construct a plot showing the 95% CI around the hypothesized value. For a Poisson distribution, I built the distribution around the expected value, <span class="math inline">\(n\lambda\)</span>, not the rate, <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>I think you could report these results like this.</p>
<blockquote class="blockquote">
<p>A one-sample exact Poisson test was run to determine whether the number of goals scored in the first round of the 2002 World Cup was different from past World Cups, 1.5. A chi-square goodness-of-fit test indicated that the number of goals was not statistically significantly different from the counts expected in the Poisson distribution (<span class="math inline">\(X^2\)</span>(2) = 0.862, <em>p</em> = 0.650). Data are mean <span class="math inline">\(\pm\)</span> standard deviation, unless otherwise stated. Mean goals scored (1.38 <span class="math inline">\(\pm\)</span> 1.28) was lower than the historical mean of 1.50, but was not statistically significantly different (95% CI, 1.15 to 1.64), <em>p</em> = 0.357.</p>
</blockquote>
</section>
</section>
<section id="exact-binomial-test" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="exact-binomial-test"><span class="header-section-number">4.7</span> Exact Binomial Test</h2>
<p>The Clopper-Pearson exact binomial test is precise, but theoretically complicated in that it inverts two single-tailed binomial tests (<em>No theory here - I’ll just rely on the software</em>). Use the exact binomial test if you have a small sample size or an extreme success/failure probability that invalidates the chi-square and <em>G</em> tests. The exact binomial also applies when you have a one-tail test. The exact binomial test has two conditions:</p>
<ul>
<li>independence, and</li>
<li>at least <span class="math inline">\(n\pi \ge 5\)</span> successes <em>or</em> <span class="math inline">\(n(1−\pi)\ge 5\)</span> failures.</li>
</ul>
<p>You can use this test for multinomial variables too, but the test only compares a single level’s proportion to a hypothesized value.</p>
<section id="example-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-3">Example</h4>
<p>A pharmaceutical company claims its drug reduces fever in &gt;60% of cases. In a random sample of <em>n</em> = 40 cases the drug reduces fever in 20 cases. Do you reject the claim?</p>
<p>You are testing <span class="math inline">\(P(x \le 20)\)</span> in <em>n</em> = 40 trials when <em>p</em> = 60%, a one-tail test. The sample is a random assignment experiment with 20&gt;5 successes and 20&gt;5 failures, so it meets the conditions for the exact binomial test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  20 and 40
number of successes = 20, number of trials = 40, p-value = 0.9256
alternative hypothesis: true probability of success is greater than 0.6
95 percent confidence interval:
 0.3610917 1.0000000
sample estimates:
probability of success 
                   0.5 </code></pre>
</div>
</div>
<p>The exact binomial test uses the “method of small <em>p</em>-values”, in which the probability of observing a proportion <span class="math inline">\(p\)</span> as far or further from <span class="math inline">\(\pi_0\)</span> is the sum of all <span class="math inline">\(P(X=p_i)\)</span> where <span class="math inline">\(p_i &lt;= p\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">40</span>, <span class="fl">0.6</span>), <span class="sc">~</span><span class="fu">if_else</span>(. <span class="sc">&lt;=</span> <span class="fl">0.5</span>, ., <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1297657</code></pre>
</div>
</div>
<p>That is what <code>pbinom()</code> does.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">20</span>, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1297657</code></pre>
</div>
</div>
<p>A 95% confidence interval means 95% of confidence intervals constructed from a random sample of the population will contain the true population proportion. There are several methods to calculate a binomial confidence interval<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> <code>binom.test()</code> uses the Clopper-Pearson interval. This method calculates lower (<span class="math inline">\(P_L\)</span>) and upper (<span class="math inline">\(P_U\)</span>) limits that satisfy</p>
<p><span class="math display">\[
\begin{eqnarray}
\sum_{x=n_1}^n \binom{n}{x} p_L^x(1 - p_L)^{n-x} &amp;=&amp; \alpha/2\\
\sum_{x=0}^{n_1} \binom{n}{x} p_U^x(1 - p_U)^{n-x} &amp;=&amp; \alpha/2
\end{eqnarray}
\]</span></p>
<p>where <span class="math inline">\(n_i\)</span> is the measured successes in <span class="math inline">\(n\)</span> trials. For a one-tail test, the confidence interval is calculated with the right side equaling 0 and <span class="math inline">\(/alpha\)</span> instead of <span class="math inline">\(\alpha/2\)</span>. A right-tailed 95% confidence interval means 95% of confidence intervals will contain a lower limit that is less than the true population proportion. If you wanted to construct a confidence interval around the population proportion, use a two-sided test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  20 and 40
number of successes = 20, number of trials = 40, p-value = 0.2007
alternative hypothesis: true probability of success is not equal to 0.6
95 percent confidence interval:
 0.3380178 0.6619822
sample estimates:
probability of success 
                   0.5 </code></pre>
</div>
</div>
<p>If you just wanted to know whether 20 successes in 40 trials is compatible with a population proportion of 60%, then you could use the chi-squared goodness-of-fit test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>), <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  c(20, 20)
X-squared = 1.6667, df = 1, p-value = 0.1967</code></pre>
</div>
</div>
</section>
</section>
<section id="one-sample-proportion-z-test" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="one-sample-proportion-z-test"><span class="header-section-number">4.8</span> One-Sample Proportion z Test</h2>
<p>The <em>z</em>-test uses the sample proportion of group <span class="math inline">\(j\)</span>, <span class="math inline">\(p_j\)</span>, as an estimate of the population proportion <span class="math inline">\(\pi_j\)</span> to evaluate an hypothesized population proportion <span class="math inline">\(\pi_{0j}\)</span> and/or construct a <span class="math inline">\((1−\alpha)\%\)</span> confidence interval around <span class="math inline">\(p_j\)</span> to estimate <span class="math inline">\(\pi_j\)</span> within a margin of error <span class="math inline">\(\epsilon\)</span>.</p>
<p>The <em>z</em>-test is intuitive to learn, but it only applies when the central limit theorem conditions hold:</p>
<ul>
<li>the sample is independently drawn, meaning random assignment (experiments), or random sampling without replacement from &lt;10% of the population (observational studies),</li>
<li>there are at least 5 successes and 5 failures,</li>
<li>the sample size is &gt;=30, and</li>
<li>the expected probability of success is not extreme, between 0.2 and 0.8.</li>
</ul>
<p>If these conditions hold, the sampling distribution of <span class="math inline">\(\pi\)</span> is normally distributed around <span class="math inline">\(p\)</span> with standard error <span class="math inline">\(se_p = \frac{s_p}{\sqrt{n}} = \frac{\sqrt{p(1−p)}}{\sqrt{n}}\)</span>. The measured values <span class="math inline">\(p\)</span> and <span class="math inline">\(s_p\)</span> approximate the population values <span class="math inline">\(\pi\)</span> and <span class="math inline">\(\sigma_\pi\)</span>. You can define a <span class="math inline">\((1 − \alpha)\%\)</span> confidence interval as <span class="math inline">\(p \pm z_{\alpha / 2}se_p\)</span>. Test the hypothesis of <span class="math inline">\(\pi = \pi_0\)</span> with test statistic <span class="math inline">\(z = \frac{p − \pi_0}{se_{\pi_0}}\)</span> where <span class="math inline">\(se_{\pi_0} = \frac{s_{\pi_0}}{\sqrt{n}} = \frac{\sqrt{{\pi_0}(1−{\pi_0})}}{\sqrt{n}}\)</span>.</p>
<section id="example-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-4">Example</h4>
<p>A machine is supposed to randomly churn out prizes in 60% of boxes. In a random sample of <em>n</em> = 40 boxes there are prizes in 20 boxes. Is the machine flawed?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="fl">0.6</span>, <span class="st">"two.sided"</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test without continuity correction

data:  20 out of 40, null probability 0.6
X-squared = 1.6667, df = 1, p-value = 0.1967
alternative hypothesis: true p is not equal to 0.6
95 percent confidence interval:
 0.3519953 0.6480047
sample estimates:
  p 
0.5 </code></pre>
</div>
</div>
<p>The first thing you’ll notice is that <code>prop.test()</code> performs a chi-squared goodness-of-fit test, not a one-proportion <em>Z</em>-test!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">40-20</span>), <span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">6</span>, .<span class="dv">4</span>), <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  c(20, 40 - 20)
X-squared = 1.6667, df = 1, p-value = 0.1967</code></pre>
</div>
</div>
<p>It turns out <span class="math inline">\(P(\chi^2 &gt; X^2)\)</span> equals <span class="math inline">\(2 \cdot P(Z &gt; z).\)</span> Here is the manual calculation of the chi-squared test statistic <span class="math inline">\(X^2\)</span> and resulting <em>p</em>-value on 1 dof.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pi_0 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">/</span> <span class="dv">40</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p) <span class="sc">*</span> <span class="dv">40</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">c</span>(pi_0, <span class="dv">1</span><span class="sc">-</span>pi_0) <span class="sc">*</span> <span class="dv">40</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(X2, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1967056</code></pre>
</div>
</div>
<p>And here is the manual calculation of the <em>Z</em>-test statistic <span class="math inline">\(z\)</span> and resulting <em>p</em>-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi_0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pi_0)) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (p <span class="sc">-</span> pi_0) <span class="sc">/</span> se</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1967056</code></pre>
</div>
</div>
<p>The 95% CI presented by <code>prop.test()</code> is also not the <span class="math inline">\(p \pm z_{\alpha / 2}se_p\)</span> Wald interval; it is the <em>Wilson</em> interval!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">BinomCI</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">method =</span> <span class="st">"wilson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     est    lwr.ci    upr.ci
[1,] 0.5 0.3519953 0.6480047</code></pre>
</div>
</div>
<p>There are a lot of methods (<em>see</em> <code>?DescTools::BinomCI</code>), and <em>Wilson</em> is the one Agresti-Coull recommends. If you want <em>Wald</em>, use <code>DescTools::BinomCI()</code> with <code>method = "wald"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">BinomCI</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">method =</span> <span class="st">"wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     est    lwr.ci    upr.ci
[1,] 0.5 0.3450512 0.6549488</code></pre>
</div>
</div>
<p>This matches the manual calculation below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>z_crit <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">05</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>(CI <span class="ot">&lt;-</span> <span class="fu">c</span>(p <span class="sc">-</span> z_crit<span class="sc">*</span>se, p <span class="sc">+</span> z_crit<span class="sc">*</span>se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3450512 0.6549488</code></pre>
</div>
</div>
<p><code>prop.test()</code> (and <code>chissq.test()</code>) reported a <em>p</em>-value of 0.1967056, so you cannot reject the null hypothesis that <span class="math inline">\(\pi = 0.6\)</span>. It’s good practice to plot this out to make sure your head is on straight.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-one-sample_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Incidentally, if you have a margin of error requirement, you can back into the required sample size to achieve it. Just solve the margin of error equation <span class="math inline">\(\epsilon  = z_{\alpha/2}^2 = \sqrt{\frac{\pi_0(1-\pi_0)}{n}}\)</span> for <span class="math inline">\(n = \frac{z_{\alpha/2}^2 \pi_0(1-\pi_0)}{\epsilon^2}.\)</span></p>
</section>
</section>
<section id="sample-t-test-for-categorical-var" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="sample-t-test-for-categorical-var"><span class="header-section-number">4.9</span> 1 sample t Test for Categorical Var</h2>
<p>This test applies when you do not know the population variance.</p>
</section>
<section id="wilcoxon-1-sample-median-test-for-categorical-var" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="wilcoxon-1-sample-median-test-for-categorical-var"><span class="header-section-number">4.10</span> Wilcoxon 1-Sample Median Test for Categorical Var</h2>
<p>This test applies when the variable is not normally distributed.</p>
</section>
<section id="multivariate-statistics" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="multivariate-statistics"><span class="header-section-number">4.11</span> Multivariate Statistics</h2>
<p>The t-tests and analysis of variance tests have multivariate analogs. Multivariate statistics apply when multiple variables are simultaneously analyzed. Hotellings’s <em>T</em>^2 extends the independent samples <em>t</em>-test and MANOVA extends ANOVA to cases where there are two or more dependent variables (e.g., do math, science, and reading scores depend on students’ anxiety level?).</p>
<p>The mean of variable <span class="math inline">\(j\)</span> is the average of row vector <span class="math inline">\(X_j\)</span>, <span class="math inline">\(\bar{x}_j = \frac{1}{n} \sum_{i = 1}^n X_{ij}\)</span>. <span class="math inline">\(\bar{x}_j\)</span> estimates the population mean, <span class="math inline">\(\mu_j = E(X_j)\)</span>. The collection of means is a column vector, <span class="math inline">\(\bar{\mathbf{x}}\)</span> estimating <span class="math inline">\(\boldsymbol{\mu}\)</span>.</p>
<p>The variance of variable <span class="math inline">\(j\)</span> is the average squared difference from the mean for row vector <span class="math inline">\(X_j\)</span>, <span class="math inline">\(s_j^2 = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j)^2\)</span>. It estimates the population variance, <span class="math inline">\(\sigma_j^2 = E(X_j - \mu_j)^2\)</span>. The collection of variances is a column vector, <span class="math inline">\(\mathbf{s}^2\)</span> estimating <span class="math inline">\(\boldsymbol{\sigma}^2\)</span>.</p>
<p>The covariance of variables <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span> is the average product of differences from their respective means, <span class="math inline">\(s_{jk} = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j) (X_{ik} - \bar{x}_k)\)</span>. It estimates the population covariance, <span class="math inline">\(\sigma_{jk} = E\{ (X_{ij} - \mu_j) (X_{ik} - \mu_k)\}\)</span>. The generalization across the entire matrix is the <em>variance-covariance matrix</em>, <span class="math inline">\(\textbf{S}\)</span> which estimates <span class="math inline">\(\boldsymbol{\Sigma}\)</span>.</p>
<p><span class="math inline">\(\bar{\mathbf{x}}\)</span> is a function of random data, so it is also a random vector with a <em>sampling distribution</em> mean and variance-covariance matrix. The variance of the sample mean is <span class="math inline">\(V(\bar{\mathbf{x}}) = \frac{\textbf{S}}{n}\)</span>. It estimates the variance of the population mean, <span class="math inline">\(V(\bar{\mathbf{x}}) = \frac{\boldsymbol{\Sigma}}{n}\)</span>. If the samples are taken from a normal distribution or the sample size is large, the sampling distribution is approximately normal, <span class="math inline">\(\bar{\textbf{x}} \sim N \left(\boldsymbol{\mu}, \frac{\boldsymbol{\Sigma}}{n} \right)\)</span>.</p>
<p>The joint estimate of confidence intervals (CIs) around a multivariate set of population means is complicated by how the individual variables are treated.</p>
<ul>
<li><p><strong>One at a time intervals</strong>. The <span class="math inline">\(1 - \alpha\)</span> CI is <span class="math inline">\(\bar{x}_j \pm t_{n-1}(\alpha / 2) \frac{s_j}{\sqrt{n}}\)</span>.</p></li>
<li><p><strong>Bonferroni method</strong>. A family of confidence intervals has a family-wide error rate of at least one CI not capturing its population mean equal to the sum of the individual error rates. The Bonferroni method divides <span class="math inline">\(\alpha\)</span> by the <span class="math inline">\(p\)</span> variables in the family, so the <span class="math inline">\(1 - \alpha\)</span> CI is <span class="math inline">\(\bar{x}_j \pm t_{n-1}(\alpha / 2p) \frac{s_j}{\sqrt{n}}\)</span>.</p></li>
<li><p><strong>Simultaneous confidence region</strong>. This method considers the family of all possible linear combinations of the population means. The <span class="math inline">\(1 - \alpha\)</span> CI is <span class="math inline">\(\bar{x}_j \pm \sqrt{\frac{p(n-1)}{n-p} F_{p, n-p}(\alpha)} \frac{s_j}{\sqrt{n}}\)</span>.</p></li>
</ul>
<p><strong>Quick Example</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose you have p = 3 variables with mean and sd as follows.</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">25</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">84390</span>, <span class="fl">1.79268</span>, .<span class="dv">70440</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>SD <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">11402</span>, .<span class="dv">28347</span>, .<span class="dv">10756</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># One at a time margins of error</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>(prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> .<span class="dv">05</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.975</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>(mult <span class="ot">&lt;-</span> <span class="fu">qt</span>(prob, n<span class="dv">-1</span>))</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.063899 2.063899 2.063899</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>(ME <span class="ot">&lt;-</span> mult <span class="sc">*</span> SE)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.04706514 0.11701067 0.04439859</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferonni</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>(prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> .<span class="dv">05</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>p))</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9916667</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>(mult <span class="ot">&lt;-</span> <span class="fu">qt</span>(prob, n<span class="dv">-1</span>))</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.573641 2.573641 2.573641</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>(ME <span class="ot">&lt;-</span> mult <span class="sc">*</span> SE)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.05868931 0.14591000 0.05536417</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Simultaneous</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>(mult <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((p <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">/</span> (n<span class="sc">-</span>p)) <span class="sc">*</span> <span class="fu">qf</span>(.<span class="dv">95</span>, p, n<span class="sc">-</span>p)))</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.158948 3.158948 3.158948</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>(ME <span class="ot">&lt;-</span> mult <span class="sc">*</span> SE)</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.07203666 0.17909342 0.06795530</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The <em>t</em>-test returns nearly the same result as the <em>z</em>-test when the CLT holds, so in practice no one bothers with the <em>z</em>-test except as an aid to teach the <em>t</em>-test.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval">Wikipedia</a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-bayesian-statistics.html" class="pagination-link" aria-label="Bayesian Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./pt1-group-differences.html" class="pagination-link" aria-label="Group Differences">
        <span class="nav-page-text">Group Differences</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb57" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># One-Sample</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="in">library(broom)</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(gtsummary)</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>Use *one-sample* tests to either *describe* a single variable's frequency or central tendency, or to *compare* the frequency or central tendency to a hypothesized distribution or value.</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>If the data generating process produces continuous outcomes (interval or ratio), and the outcomes are symmetrically distributed, the sample mean, $\bar{x}$, is a random variable centered at the population mean, $\mu$. You can then use a theoretical distribution (normal or student t) to estimate a 95% confidence interval (CI) around $\mu$, or compare $\bar{x}$ to an hypothesized population mean, $\mu_0$. If you (somehow) know the population variance, or the Central Limit Theorem (CLT) conditions hold, you can assume the random variable is normally distributed and use the *z*-test, otherwise assume the random variable has student *t* distribution and use the *t*-test.^[The *t*-test returns nearly the same result as the *z*-test when the CLT holds, so in practice no one bothers with the *z*-test except as an aid to teach the *t*-test.] If the data generating process produces continuous outcomes that are *not* symmetrically distributed, use a non-parametric test like the Wilcoxon median test.</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>If the data generating process produces discrete outcomes (counts), the sample count, $x$, is a random variable from a Poisson, binomial, normal, or multinomial distribution, or a random variable from a theoretical outcome. Whatever the source of the expected values, you use either the *chi-squared goodness-of-fit* test or *G* test to test whether the observed values fit the expected values from the distribution. In the special case of binary outcomes with small (*n* &lt; 1,000), you can use Fisher's exact test instead. The discrete variable tests are discussed in <span class="co">[</span><span class="ot">PSU STATS 504</span><span class="co">](https://online.stat.psu.edu/stat504)</span>.</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>For counts over a fixed time or space, treat the count as a random variable from a Poisson distribution with expected value $\lambda$ and variance $\lambda$.</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>For counts within a fixed total that are then classified into two levels (usually yes/no), then treat the count as a random variable from a binomial distribution with expected value $n\pi$ and variance $n\pi(1-\pi)$.</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>For binomial distributions where $n\ge30$ and the frequency counts of both levels is $\ge$ 5, treat the *proportion* as a random variable from the normal distribution with expected valued $\pi$ and variance $\frac{\pi(1-\pi)}{n}$.</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>For counts within a fixed total that are then classified into three or more levels, treat the count as a random variable from the multinomial distribution with expected value $n\pi_j$ and variance $n\pi_j(1-\pi_j)$.</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-Sample Mean z Test</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>The *z* test is also called the normal approximation *z* test.  It only applies when the sampling distribution of the population mean is normally distributed with known variance, and there are no significant outliers. The sampling distribution is normally distributed when the underlying population is normally distributed, or when the sample size is large $(n &gt;= 30)$, as follows from the central limit theorem. The *t* test returns similar results, plus it is valid when the variance is unknown, and that is pretty much always. For that reason, you probably will never use this test.</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>Under the normal approximation method, the measured mean $\bar{x}$ approximates the population mean $\mu$, and the sampling distribution has a normal distribution centered at $\mu$ with standard error $se_\mu = \frac{\sigma}{\sqrt{n}}$ where $\sigma$ is the standard deviation of the underlying population. Define a $(1 - \alpha)\%$ confidence interval as $\bar{x} \pm z_{(1 - \alpha) {/} 2} se_\mu$, or test $H_0: \mu = \mu_0$ with test statistic $Z = \frac{\bar{x} - \mu_0}{se_\mu}$.  </span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example {-}</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- nrow(mtcars)</span></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="in">x_bar &lt;- mean(mtcars$mpg)</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a><span class="in">s &lt;- sd(mtcars$mpg)</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a><span class="in">mu_0 &lt;- 18.0</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a><span class="in">sigma &lt;- 6</span></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>The <span class="in">`mtcars`</span> data set is a sample of *n* = <span class="in">`r n`</span> cars. The mean fuel economy is $\bar{x} \pm s$ = <span class="in">`r x_bar %&gt;% format(digits = 1, nsmall=1)`</span> $\pm$ <span class="in">`r s %&gt;% format(digits = 1, nsmall=1)`</span> mpg. The prior measured overall fuel economy for vehicles was $\mu_0 \pm \sigma$ = <span class="in">`r mu_0 %&gt;% format(digits = 1, nsmall=1)`</span> $\pm$ <span class="in">`r sigma %&gt;% format(digits = 1, nsmall=1)`</span> mpg. Has fuel economy improved?</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>The sample size is $\ge$ 30, so the sampling distribution of the population mean is normally distributed. The population variance is known, so use the *z* test.  </span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a><span class="in">se &lt;- sigma / sqrt(n)</span></span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a><span class="in">Z &lt;- (x_bar - mu_0) / se</span></span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- pnorm(q = Z, lower.tail = FALSE)</span></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>$H_0: \mu = 16.0$, and $H_a: \mu &gt; 16.0$ - a right-tail test. The test statistic is $Z = \frac{\bar{x} - \mu_0}{se_\mu}=$ <span class="in">`r Z %&gt;% format(digits = 1, nsmall = 2)`</span> where $se_{\mu_0} = \frac{\mu_0}{\sqrt{n}} =$ <span class="in">`r se %&gt;% format(digits = 1, nsmall = 2)`</span>. $P(z &gt; Z) =$ <span class="in">`r p %&gt;% format(digits = 1, nsmall = 4)`</span>, so reject $H_0$ at the $\alpha =$ 0.05 level of significance.</span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, warning=FALSE, fig.height=3.5, fig.width=6.5}</span></span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a><span class="in">lrr = -Inf  # right-tailed test</span></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="in">urr = mu_0 + qnorm(p = .05, lower.tail = FALSE) * se</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(mu = seq(10, 25, by = .1)) %&gt;%</span></span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Z = (mu - mu_0) / se,</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a><span class="in">         prob = dnorm(Z),</span></span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a><span class="in">         rr = ifelse(mu &lt; lrr | mu &gt; urr, prob, NA_real_)) %&gt;%</span></span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = mu, y = prob)) +</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = mu, y = rr), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = mu_0), size = 1) +</span></span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = x_bar), color = "goldenrod", size = 1, linetype = 2) +</span></span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none",</span></span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_blank()) +</span></span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = bquote("Right-Tail z Test"),</span></span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "mu",</span></span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Probability")</span></span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a><span class="in">z_crit &lt;- qnorm(p = 1-.05/2, lower.tail = TRUE)</span></span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a><span class="in">epsilon &lt;- z_crit * se</span></span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a><span class="in">ci_low &lt;- x_bar - epsilon</span></span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a><span class="in">ci_high &lt;- x_bar + epsilon</span></span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-79"><a href="#cb57-79" aria-hidden="true" tabindex="-1"></a>The 95% confidence interval for $\mu$ is $\bar{x} \pm z_{(1 - \alpha){/}2} se_\mu$ where $z_{(1 - \alpha){/}2} =$ <span class="in">`r z_crit %&gt;% round(2)`</span>. $\mu =$ <span class="in">`r x_bar %&gt;% format(digits = 1, nsmall = 2)`</span> $\pm$ <span class="in">`r epsilon %&gt;% format(digits = 1, nsmall = 2)`</span> (95% CI <span class="in">`r ci_low %&gt;% format(digits = 1, nsmall = 2)`</span> to <span class="in">`r ci_high %&gt;% format(digits = 1, nsmall = 2)`</span>).</span>
<span id="cb57-80"><a href="#cb57-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-81"><a href="#cb57-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, warning=FALSE, fig.height=3.5, fig.width=6.5}</span></span>
<span id="cb57-82"><a href="#cb57-82" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(mu = seq(15, 25, by = .1)) %&gt;%</span></span>
<span id="cb57-83"><a href="#cb57-83" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Z = (mu - x_bar) / se,</span></span>
<span id="cb57-84"><a href="#cb57-84" aria-hidden="true" tabindex="-1"></a><span class="in">         prob = dnorm(x = Z), </span></span>
<span id="cb57-85"><a href="#cb57-85" aria-hidden="true" tabindex="-1"></a><span class="in">         ci = if_else(mu &gt;= ci_low &amp; mu &lt;= ci_high, prob, NA_real_)) %&gt;%</span></span>
<span id="cb57-86"><a href="#cb57-86" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-87"><a href="#cb57-87" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = mu, y = prob), color = "goldenrod") +</span></span>
<span id="cb57-88"><a href="#cb57-88" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = mu, y = ci), fill = "goldenrod", alpha = 0.3) +</span></span>
<span id="cb57-89"><a href="#cb57-89" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = x_bar), color = "goldenrod", size = 1, linetype = 2) +</span></span>
<span id="cb57-90"><a href="#cb57-90" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-91"><a href="#cb57-91" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none",</span></span>
<span id="cb57-92"><a href="#cb57-92" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_blank()) +</span></span>
<span id="cb57-93"><a href="#cb57-93" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "95% CI",x = "mu",y = "Probability") </span></span>
<span id="cb57-94"><a href="#cb57-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-95"><a href="#cb57-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-96"><a href="#cb57-96" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-Sample Mean t Test</span></span>
<span id="cb57-97"><a href="#cb57-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-98"><a href="#cb57-98" aria-hidden="true" tabindex="-1"></a>The one-sample *t* test applies when the sampling distribution of the population mean is normally distributed and there are no significant outliers. Unlike the *z* test, the population variance can be unknown. The sampling distribution is normally distributed when the underlying population is normally distributed, or when the sample size is large $(n &gt;= 30)$, as follows from the central limit theorem. </span>
<span id="cb57-99"><a href="#cb57-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-100"><a href="#cb57-100" aria-hidden="true" tabindex="-1"></a>Under the *t* test method, the measured mean, $\bar{x}$, approximates the population mean, $\mu$. The sample standard deviation, $s$, estimates the unknown population standard deviation, $\sigma$. The resulting sampling distribution has a *t* distribution centered at $\mu$ with standard error $se_\bar{x} = \frac{s}{\sqrt{n}}$. Define a $(1 - \alpha)\%$ confidence interval as $\bar{x} \pm t_{(1 - \alpha){/}2} se_\bar{x}$ and/or test $H_0: \mu = \mu_0$ with test statistic $T = \frac{\bar{x} - \mu_0}{se_\bar{x}}$.</span>
<span id="cb57-101"><a href="#cb57-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-102"><a href="#cb57-102" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example{-}</span></span>
<span id="cb57-103"><a href="#cb57-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-104"><a href="#cb57-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-105"><a href="#cb57-105" aria-hidden="true" tabindex="-1"></a><span class="in">dep &lt;- foreign::read.spss("./input/one-sample-t-test.sav", to.data.frame = TRUE)</span></span>
<span id="cb57-106"><a href="#cb57-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-107"><a href="#cb57-107" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- nrow(dep)</span></span>
<span id="cb57-108"><a href="#cb57-108" aria-hidden="true" tabindex="-1"></a><span class="in">mu_0 &lt;- 4.0</span></span>
<span id="cb57-109"><a href="#cb57-109" aria-hidden="true" tabindex="-1"></a><span class="in">x_bar &lt;- mean(dep$dep_score)</span></span>
<span id="cb57-110"><a href="#cb57-110" aria-hidden="true" tabindex="-1"></a><span class="in">s &lt;- sd(dep$dep_score)</span></span>
<span id="cb57-111"><a href="#cb57-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-112"><a href="#cb57-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-113"><a href="#cb57-113" aria-hidden="true" tabindex="-1"></a>A researcher recruits a random sample of *n* = <span class="in">`r n`</span> people to participate in a study about depression intervention. The researcher measures the participants' depression level prior to the study. The mean depression score (<span class="in">`r format(x_bar, digits = 2, nsmall = 2)`</span> $\pm$ <span class="in">`r format(s, digits = 2, nsmall = 2)`</span>) was lower than the population 'normal' depression score of <span class="in">`r format(mu_0, digits = 2, nsmall = 1)`</span>. The null hypothesis is that the sample is representative of the overall population. Should you reject $H_0$?</span>
<span id="cb57-114"><a href="#cb57-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-117"><a href="#cb57-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-118"><a href="#cb57-118" aria-hidden="true" tabindex="-1"></a>dep <span class="sc">%&gt;%</span> gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(<span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>))</span>
<span id="cb57-119"><a href="#cb57-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-120"><a href="#cb57-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-121"><a href="#cb57-121" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditions {-}</span></span>
<span id="cb57-122"><a href="#cb57-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-123"><a href="#cb57-123" aria-hidden="true" tabindex="-1"></a>The one-sample *t* test applies when the variable is continuous and the observations are independent. Additionally, there are two conditions related to the data distribution. If either condition fails, try the suggested work-arounds or use the non-parametric <span class="co">[</span><span class="ot">Wilcoxon 1-Sample Median Test for Numeric Var</span><span class="co">]</span> instead.</span>
<span id="cb57-124"><a href="#cb57-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-125"><a href="#cb57-125" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Outliers**. There should be no significant outliers. Outliers exert a large influence on the mean and standard deviation. Test with a box plot. If there are outliers, you might be able to drop them or transform the data.</span>
<span id="cb57-126"><a href="#cb57-126" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Normality**.  Values should be *nearly* normally distributed ("nearly" because the *t*-test is robust to the normality assumption). This condition is especially important with small sample sizes. Test with Q-Q plots or the Shapiro-Wilk test for normality. If the data is very non-normal, you might be able to transform the data.</span>
<span id="cb57-127"><a href="#cb57-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-128"><a href="#cb57-128" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Outliers {-}</span></span>
<span id="cb57-129"><a href="#cb57-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-130"><a href="#cb57-130" aria-hidden="true" tabindex="-1"></a>Assess outliers with a box plot. Box plot whiskers extend up to 1.5<span class="sc">\*</span>IQR from the upper and lower hinges and outliers (beyond the whiskers) are are plotted individually. The boxplot shows no outliers.</span>
<span id="cb57-131"><a href="#cb57-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-132"><a href="#cb57-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, fig.height=2.5}</span></span>
<span id="cb57-133"><a href="#cb57-133" aria-hidden="true" tabindex="-1"></a><span class="in">dep %&gt;%</span></span>
<span id="cb57-134"><a href="#cb57-134" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = "dep_score", y = dep_score)) +</span></span>
<span id="cb57-135"><a href="#cb57-135" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(fill = "snow3", color = "snow4", alpha = 0.6, width = 0.5, </span></span>
<span id="cb57-136"><a href="#cb57-136" aria-hidden="true" tabindex="-1"></a><span class="in">               outlier.color = "goldenrod", outlier.size = 2) +</span></span>
<span id="cb57-137"><a href="#cb57-137" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-138"><a href="#cb57-138" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Boxplot of Depression Score",</span></span>
<span id="cb57-139"><a href="#cb57-139" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Score", x = NULL)</span></span>
<span id="cb57-140"><a href="#cb57-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-141"><a href="#cb57-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-142"><a href="#cb57-142" aria-hidden="true" tabindex="-1"></a>If the outliers might are data entry errors or measurement errors, fix them or discard them. If the outliers are genuine, you have a couple options before reverting to Wilcoxon.</span>
<span id="cb57-143"><a href="#cb57-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-144"><a href="#cb57-144" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Transform the variable. Don't do this unless the variable is also non-normal. Transformation also has the downside of making interpretation more difficult.</span>
<span id="cb57-145"><a href="#cb57-145" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Leave it in if it doesn't affect the conclusion (compared to taking it out).</span>
<span id="cb57-146"><a href="#cb57-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-147"><a href="#cb57-147" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Normality {-}</span></span>
<span id="cb57-148"><a href="#cb57-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-149"><a href="#cb57-149" aria-hidden="true" tabindex="-1"></a>Assume the population is normally distributed if *n* $\ge$ 30. Otherwise, asses a Q-Q plot, skewness and kurtosis values, or a histogram. If you still don't feel confident about normality, run a <span class="co">[</span><span class="ot">Shapiro-Wilk Test</span><span class="co">]</span>.</span>
<span id="cb57-150"><a href="#cb57-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-151"><a href="#cb57-151" aria-hidden="true" tabindex="-1"></a>The data set has *n* = 40 observations, so you can assume normality. Here is a QQ plot anyway. The QQ plot indicates normality.</span>
<span id="cb57-152"><a href="#cb57-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-153"><a href="#cb57-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height=2.5}</span></span>
<span id="cb57-154"><a href="#cb57-154" aria-hidden="true" tabindex="-1"></a><span class="in">dep %&gt;%</span></span>
<span id="cb57-155"><a href="#cb57-155" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(sample = dep_score)) +</span></span>
<span id="cb57-156"><a href="#cb57-156" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq() +</span></span>
<span id="cb57-157"><a href="#cb57-157" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq_line(col = "goldenrod") +</span></span>
<span id="cb57-158"><a href="#cb57-158" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-159"><a href="#cb57-159" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Normal Q-Q Plot")</span></span>
<span id="cb57-160"><a href="#cb57-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-161"><a href="#cb57-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-162"><a href="#cb57-162" aria-hidden="true" tabindex="-1"></a>Here is the Shapiro-Wilk normality test. It fails to reject the null hypothesis of a normally distributed population.</span>
<span id="cb57-163"><a href="#cb57-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-166"><a href="#cb57-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-167"><a href="#cb57-167" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(dep<span class="sc">$</span>dep_score)</span>
<span id="cb57-168"><a href="#cb57-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-169"><a href="#cb57-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-170"><a href="#cb57-170" aria-hidden="true" tabindex="-1"></a>If the data is not normally distributed, you still have a couple options before reverting to Wilcoxon.</span>
<span id="cb57-171"><a href="#cb57-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-172"><a href="#cb57-172" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Transform the dependent variable.</span>
<span id="cb57-173"><a href="#cb57-173" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Carry on regardless - the one-sample *t*-test is fairly robust to deviations from normality.</span>
<span id="cb57-174"><a href="#cb57-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-175"><a href="#cb57-175" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results {-}</span></span>
<span id="cb57-176"><a href="#cb57-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-177"><a href="#cb57-177" aria-hidden="true" tabindex="-1"></a>Conduct the *t*-test. To get a 95% CI around the *difference* (instead of around the estimate), run the test using the difference, $\mu_0 - \bar{x}$, and leave <span class="in">`mu`</span> at its default of 0.</span>
<span id="cb57-178"><a href="#cb57-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-181"><a href="#cb57-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-182"><a href="#cb57-182" aria-hidden="true" tabindex="-1"></a>(dep_95ci <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> mu_0 <span class="sc">-</span> dep<span class="sc">$</span>dep_score, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">conf.level =</span> .<span class="dv">95</span>))</span>
<span id="cb57-183"><a href="#cb57-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-184"><a href="#cb57-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-185"><a href="#cb57-185" aria-hidden="true" tabindex="-1"></a>The difference is statistically different from 0 at the *p* = .05 level. The effect size, called Cohen's *d*, is defined as $d = |M_D| / s$, where $|M_D| = \bar{x} - \mu_0$, and $s$ is the sample standard deviation. $d &lt;.2$ is considered trivial, $.2 \le d &lt; .5$ small, and $.5 \le d &lt; .8$ large.</span>
<span id="cb57-186"><a href="#cb57-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-189"><a href="#cb57-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-190"><a href="#cb57-190" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">cohens_d</span>(dep, dep_score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(effsize) <span class="sc">%&gt;%</span> <span class="fu">abs</span>())</span>
<span id="cb57-191"><a href="#cb57-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-192"><a href="#cb57-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-193"><a href="#cb57-193" aria-hidden="true" tabindex="-1"></a>Cohen's *d* is <span class="in">`r d %&gt;% format(digits = 2, nsmall = 2)`</span>, a small effect. </span>
<span id="cb57-194"><a href="#cb57-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-195"><a href="#cb57-195" aria-hidden="true" tabindex="-1"></a>Make a habit of constructing a plot, just to make sure your head is on straight.</span>
<span id="cb57-196"><a href="#cb57-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-197"><a href="#cb57-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, warning=FALSE, fig.height=3.5, fig.width=6.5}</span></span>
<span id="cb57-198"><a href="#cb57-198" aria-hidden="true" tabindex="-1"></a><span class="in">se &lt;- s / sqrt(n)</span></span>
<span id="cb57-199"><a href="#cb57-199" aria-hidden="true" tabindex="-1"></a><span class="in">lrr = mu_0 + qt(p = .05, df = n - 1, lower.tail = TRUE) * se</span></span>
<span id="cb57-200"><a href="#cb57-200" aria-hidden="true" tabindex="-1"></a><span class="in">urr = mu_0 + qt(p = .05, df = n - 1, lower.tail = FALSE) * se</span></span>
<span id="cb57-201"><a href="#cb57-201" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(mu = seq(3.5, 4.5, by = .01)) %&gt;%</span></span>
<span id="cb57-202"><a href="#cb57-202" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(t = (mu - mu_0) / se,</span></span>
<span id="cb57-203"><a href="#cb57-203" aria-hidden="true" tabindex="-1"></a><span class="in">         prob = dt(x = t, df = n - 1),</span></span>
<span id="cb57-204"><a href="#cb57-204" aria-hidden="true" tabindex="-1"></a><span class="in">         lrr = if_else(mu &lt; lrr, prob, NA_real_),</span></span>
<span id="cb57-205"><a href="#cb57-205" aria-hidden="true" tabindex="-1"></a><span class="in">         urr = if_else(mu &gt; urr, prob, NA_real_)) %&gt;%</span></span>
<span id="cb57-206"><a href="#cb57-206" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-207"><a href="#cb57-207" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = mu, y = prob)) +</span></span>
<span id="cb57-208"><a href="#cb57-208" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = mu, y = lrr), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-209"><a href="#cb57-209" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = mu, y = urr), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-210"><a href="#cb57-210" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = mu_0), size = 1) +</span></span>
<span id="cb57-211"><a href="#cb57-211" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = x_bar), color = "goldenrod", size = 1, linetype = 2) +</span></span>
<span id="cb57-212"><a href="#cb57-212" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-213"><a href="#cb57-213" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none",</span></span>
<span id="cb57-214"><a href="#cb57-214" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_blank()) +</span></span>
<span id="cb57-215"><a href="#cb57-215" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = bquote("Two-Tailed t Test"),</span></span>
<span id="cb57-216"><a href="#cb57-216" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "mu",</span></span>
<span id="cb57-217"><a href="#cb57-217" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Probability")</span></span>
<span id="cb57-218"><a href="#cb57-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-219"><a href="#cb57-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-220"><a href="#cb57-220" aria-hidden="true" tabindex="-1"></a>Now you are ready to report the results.</span>
<span id="cb57-221"><a href="#cb57-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-222"><a href="#cb57-222" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A one-sample *t*-test was run to determine whether depression score in recruited subjects was different from normal, as defined as a depression score of 4.0. Depression scores were normally distributed, as assessed by Shapiro-Wilk's test (*p* &gt; .05) and there were no outliers in the data, as assessed by inspection of a boxplot. Data are mean $\pm$ standard deviation, unless otherwise stated. Mean depression score (`r format(x_bar, digits = 2, nsmall = 2)` $\pm$ `r format(s, digits = 2, nsmall = 2)`) was lower than the population "normal" depression score of `r format(mu_0, digits = 2, nsmall = 2)`, a statistically significant difference of `r format(dep_95ci$estimate, digits = 2, nsmall = 2)` (95% CI, `r format(dep_95ci$conf.int[1], digits = 1, nsmall = 2)` to `r format(dep_95ci$conf.int[2], digits = 1, nsmall = 2)`), t(`r dep_95ci$parameter`) = `r format(dep_95ci$statistic, digits = 1, nsmall = 2)`, *p* = `r format(dep_95ci$p.value, digits = 1, nsmall = 3)`, *d* = </span><span class="in">`r d %&gt;% format(digits = 2, nsmall = 2)`</span><span class="at">.</span></span>
<span id="cb57-223"><a href="#cb57-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-224"><a href="#cb57-224" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Appendix: Deciding Sample Size {-}</span></span>
<span id="cb57-225"><a href="#cb57-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-226"><a href="#cb57-226" aria-hidden="true" tabindex="-1"></a>Determine the sample size required for a maximum error $\epsilon$ in the estimate by solving the confidence interval equation, $\bar{x} \pm t_{(1 - \alpha){/}2} \frac{s}{\sqrt{n}}$ for $n=\frac{{t_{\alpha/2,n-1}^2se^2}}{{\epsilon^2}}$ . Unfortunately, $t_{\alpha/2,n-1}^2$ is dependent on $n$, so replace it with $z_{\alpha/2}^2$. What about $s^2$?  Estimate it from the literature, a pilot study, or using the empirical rule that 95% of the range falls within two standard deviations, $s=range / 4$.</span>
<span id="cb57-227"><a href="#cb57-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-228"><a href="#cb57-228" aria-hidden="true" tabindex="-1"></a>For example, if the maximum tolerable error is* $\epsilon$ = 3, and $s$ is approximately 10, what sample size produces an $\alpha$ =0.05 confidence level?</span>
<span id="cb57-229"><a href="#cb57-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-232"><a href="#cb57-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-233"><a href="#cb57-233" aria-hidden="true" tabindex="-1"></a><span class="fu">ceiling</span>(<span class="fu">qnorm</span>(.<span class="dv">975</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">3</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-234"><a href="#cb57-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-235"><a href="#cb57-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-236"><a href="#cb57-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-Sample Median Wilcoxon Test</span></span>
<span id="cb57-237"><a href="#cb57-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-238"><a href="#cb57-238" aria-hidden="true" tabindex="-1"></a>The Wilcoxon one-sample median test (aka Wilcoxon signed rank test) is a non-parametric alternative to the *t*-test for cases when the the sampling distribution of the population mean is *not* normally distributed, but is at least symmetric.</span>
<span id="cb57-239"><a href="#cb57-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-240"><a href="#cb57-240" aria-hidden="true" tabindex="-1"></a>Under the Wilcoxon test, the measured median, $\eta_x$, approximates the population median, $\eta$. The method calculates the difference between each value and the hypothesized median, $\eta_0$, ranks the difference magnitudes, then sums the ranks for the negative and the positive differences, $W+$ and $W-$. The test compares the smaller of the two sums to a table of critical values.</span>
<span id="cb57-241"><a href="#cb57-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-242"><a href="#cb57-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-243"><a href="#cb57-243" aria-hidden="true" tabindex="-1"></a><span class="in">wait &lt;- c(3.8, 4.3, 3.5, 4.5, 7.2, 4.1)</span></span>
<span id="cb57-244"><a href="#cb57-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-245"><a href="#cb57-245" aria-hidden="true" tabindex="-1"></a><span class="in">eta &lt;- median(wait)</span></span>
<span id="cb57-246"><a href="#cb57-246" aria-hidden="true" tabindex="-1"></a><span class="in">eta_0 &lt;- 4.0</span></span>
<span id="cb57-247"><a href="#cb57-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-248"><a href="#cb57-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-249"><a href="#cb57-249" aria-hidden="true" tabindex="-1"></a>Here is a case study. A store claims their checkout wait times are $\le$ 4 minutes. You challenge the claim by sampling 6 checkout experiences. The mean wait time was <span class="in">`r mean(wait) %&gt;% scales::comma(accuracy = 0.1)`</span>, but the data may violate normality.</span>
<span id="cb57-250"><a href="#cb57-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-251"><a href="#cb57-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height=2.5}</span></span>
<span id="cb57-252"><a href="#cb57-252" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(wait = wait) %&gt;%</span></span>
<span id="cb57-253"><a href="#cb57-253" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(sample = wait)) +</span></span>
<span id="cb57-254"><a href="#cb57-254" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq() +</span></span>
<span id="cb57-255"><a href="#cb57-255" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq_line(col = "goldenrod") +</span></span>
<span id="cb57-256"><a href="#cb57-256" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-257"><a href="#cb57-257" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Normal Q-Q Plot")</span></span>
<span id="cb57-258"><a href="#cb57-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-259"><a href="#cb57-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-260"><a href="#cb57-260" aria-hidden="true" tabindex="-1"></a>Shapiro-Wilk rejects the null hypothesis of a normally distributed population.</span>
<span id="cb57-261"><a href="#cb57-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-264"><a href="#cb57-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-265"><a href="#cb57-265" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(wait)</span>
<span id="cb57-266"><a href="#cb57-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-267"><a href="#cb57-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-268"><a href="#cb57-268" aria-hidden="true" tabindex="-1"></a>Use the Wilcoxon test instead.</span>
<span id="cb57-269"><a href="#cb57-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-272"><a href="#cb57-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-273"><a href="#cb57-273" aria-hidden="true" tabindex="-1"></a>(wt <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(wait, <span class="at">mu =</span> <span class="dv">4</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>))</span>
<span id="cb57-274"><a href="#cb57-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-275"><a href="#cb57-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-276"><a href="#cb57-276" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A Wilcoxon Signed-Ranks Test indicated that wait times were *not* statistically significantly higher than the 4-minute claim, *z* = `r wt$statistic`, *p* = </span><span class="in">`r scales::comma(wt$p.value, accuracy = 0.001)`</span><span class="at">. </span></span>
<span id="cb57-277"><a href="#cb57-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-278"><a href="#cb57-278" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chi-Squared Goodness-of-Fit Test</span></span>
<span id="cb57-279"><a href="#cb57-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-280"><a href="#cb57-280" aria-hidden="true" tabindex="-1"></a>Use the chi-squared goodness-of-fit test to test whether the observed frequency counts, $O_j$, of the $J$ levels of a categorical variable differ from the expected frequency counts, $E_j$. $H_0$ is $O_j = E_j$. You can use this test for dichotomous, nominal, or ordinal variables. There are only two conditions to use this test:</span>
<span id="cb57-281"><a href="#cb57-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-282"><a href="#cb57-282" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>the observations are independent, meaning either random assignment or random sampling without replacement from &lt;10% of the population, and </span>
<span id="cb57-283"><a href="#cb57-283" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>the *expected* frequency in each group is &gt;=5.</span>
<span id="cb57-284"><a href="#cb57-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-285"><a href="#cb57-285" aria-hidden="true" tabindex="-1"></a>The Pearson goodness-of-fit test statistic is</span>
<span id="cb57-286"><a href="#cb57-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-287"><a href="#cb57-287" aria-hidden="true" tabindex="-1"></a>$$X^2 = \sum \frac{(O_j - E_j)^2}{E_j}$$</span>
<span id="cb57-288"><a href="#cb57-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-289"><a href="#cb57-289" aria-hidden="true" tabindex="-1"></a>where $O_j = p_j n$ and $E_j = \pi_j n$. The sampling distribution of $X^2$ approaches the $\chi_{J-1}^2$ as the sample size $n \rightarrow \infty$. The assumption that $X^2$ is distributed $\sim \chi^2$ is not quite correct, so you will see researchers subtract .5 from the differences to increase the p-value, the so-called <span class="co">[</span><span class="ot">Yates Continuity Correction</span><span class="co">](https://en.wikipedia.org/wiki/Yates%27s_correction_for_continuity)</span>.</span>
<span id="cb57-290"><a href="#cb57-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-291"><a href="#cb57-291" aria-hidden="true" tabindex="-1"></a>$$X^2 = \sum \frac{(O_j - E_j - 0.5)^2}{E_j}$$</span>
<span id="cb57-292"><a href="#cb57-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-293"><a href="#cb57-293" aria-hidden="true" tabindex="-1"></a>$X^2 \rightarrow 0$ as the saturated model (the observed data represent the fit of the saturated model, the most complex model possible with the data) proportions approach the expected proportions, $p_j \rightarrow \pi_j$. The chi-squared test calculates the probability of the occurrence of $X^2$ at least as extreme given that it is a chi-squared random variable with degrees of freedom equal to the number of levels of the variable minus one, $J-1$. </span>
<span id="cb57-294"><a href="#cb57-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-295"><a href="#cb57-295" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example with Theoretical Values {-}</span></span>
<span id="cb57-296"><a href="#cb57-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-297"><a href="#cb57-297" aria-hidden="true" tabindex="-1"></a>A researcher crosses tall cut-leaf tomatoes with dwarf potato-leaf tomatoes, then classifies the *n* = 1,611 offspring's phenotype. The four phenotypes should occur with relative frequencies 9:3:3:1. The observed frequencies constitute a one-way table.</span>
<span id="cb57-298"><a href="#cb57-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-299"><a href="#cb57-299" aria-hidden="true" tabindex="-1"></a>If you only care about one level (or if the variable is binary) of if, conduct a one-proportion *Z*-test or an exact binomial test. Otherwise, conduct an exact multinomial test (recommended when *n* &lt;= 1,000), Pearson's chi-squared goodness-of-fit test, or a *G*-test.</span>
<span id="cb57-300"><a href="#cb57-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-301"><a href="#cb57-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, fig.height=2.5, fig.width=6.5}</span></span>
<span id="cb57-302"><a href="#cb57-302" aria-hidden="true" tabindex="-1"></a><span class="in">pheno_type &lt;- c("tall cut-leaf", "tall potato-leaf", "dwarf cut-leaf", "dwarf potato-leaf")</span></span>
<span id="cb57-303"><a href="#cb57-303" aria-hidden="true" tabindex="-1"></a><span class="in">pheno_obs &lt;- c(956, 258, 293, 104)</span></span>
<span id="cb57-304"><a href="#cb57-304" aria-hidden="true" tabindex="-1"></a><span class="in">pheno_pi &lt;- c(9, 3, 3, 1) / (9 + 3 + 3 + 1)</span></span>
<span id="cb57-305"><a href="#cb57-305" aria-hidden="true" tabindex="-1"></a><span class="in">pheno_exp &lt;- sum(pheno_obs) * pheno_pi</span></span>
<span id="cb57-306"><a href="#cb57-306" aria-hidden="true" tabindex="-1"></a><span class="in">names(pheno_obs) &lt;- pheno_type</span></span>
<span id="cb57-307"><a href="#cb57-307" aria-hidden="true" tabindex="-1"></a><span class="in">names(pheno_exp) &lt;- pheno_type</span></span>
<span id="cb57-308"><a href="#cb57-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-309"><a href="#cb57-309" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(type = pheno_type,</span></span>
<span id="cb57-310"><a href="#cb57-310" aria-hidden="true" tabindex="-1"></a><span class="in">           Observed = pheno_obs,</span></span>
<span id="cb57-311"><a href="#cb57-311" aria-hidden="true" tabindex="-1"></a><span class="in">           Expected = pheno_exp) %&gt;%</span></span>
<span id="cb57-312"><a href="#cb57-312" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = c(Observed, Expected)) %&gt;%</span></span>
<span id="cb57-313"><a href="#cb57-313" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = fct_inorder(type), y = value, color = fct_rev(name), fill = fct_rev(name))) +</span></span>
<span id="cb57-314"><a href="#cb57-314" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col(alpha = 0.6, width = 0.5, position = position_dodge2(padding = 0.1)) +</span></span>
<span id="cb57-315"><a href="#cb57-315" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-316"><a href="#cb57-316" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-317"><a href="#cb57-317" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-318"><a href="#cb57-318" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Phenotype Counts",</span></span>
<span id="cb57-319"><a href="#cb57-319" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Expected ratio of 9:3:3:1",</span></span>
<span id="cb57-320"><a href="#cb57-320" aria-hidden="true" tabindex="-1"></a><span class="in">       x = NULL, y = NULL, color = NULL, fill = NULL)</span></span>
<span id="cb57-321"><a href="#cb57-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-322"><a href="#cb57-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-323"><a href="#cb57-323" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditions {-}</span></span>
<span id="cb57-324"><a href="#cb57-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-325"><a href="#cb57-325" aria-hidden="true" tabindex="-1"></a>This is a randomized experiment. The minimum expected frequency was <span class="in">`r floor(min(pheno_exp))`</span>, so the chi-squared test of independence is valid.</span>
<span id="cb57-326"><a href="#cb57-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-327"><a href="#cb57-327" aria-hidden="true" tabindex="-1"></a>Had the data violated the $\ge$ 5 condition, you could run an exact test (like the binomial, or in this case, the multinomial), or lump some factor levels together.</span>
<span id="cb57-328"><a href="#cb57-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-329"><a href="#cb57-329" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results {-}</span></span>
<span id="cb57-330"><a href="#cb57-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-331"><a href="#cb57-331" aria-hidden="true" tabindex="-1"></a>You can calculate $X^2$ by hand, and find the probability of a test statistic at least as extreme using the $\chi^2$ distribution with 4-1 = 3 degrees of freedom.</span>
<span id="cb57-332"><a href="#cb57-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-333"><a href="#cb57-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb57-334"><a href="#cb57-334" aria-hidden="true" tabindex="-1"></a><span class="in">(pheno_x2 &lt;- sum((pheno_obs - pheno_exp)^2 / pheno_exp))</span></span>
<span id="cb57-335"><a href="#cb57-335" aria-hidden="true" tabindex="-1"></a><span class="in">(pheno_p &lt;- pchisq(q = pheno_x2, df = length(pheno_type) - 1, lower.tail = FALSE))</span></span>
<span id="cb57-336"><a href="#cb57-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-337"><a href="#cb57-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-338"><a href="#cb57-338" aria-hidden="true" tabindex="-1"></a>That is what <span class="in">`chisq.test()`</span> does. The function applies the Yates continuity correction by default, so I had to specify <span class="in">`correct = FALSE`</span> to exclude it. In this case, setting it to <span class="in">`TRUE`</span> has almost no effect because the sample size is large. </span>
<span id="cb57-339"><a href="#cb57-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-342"><a href="#cb57-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-343"><a href="#cb57-343" aria-hidden="true" tabindex="-1"></a>(pheno_chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pheno_obs, <span class="at">p =</span> pheno_pi, <span class="at">correct =</span> <span class="cn">FALSE</span>))</span>
<span id="cb57-344"><a href="#cb57-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-345"><a href="#cb57-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-346"><a href="#cb57-346" aria-hidden="true" tabindex="-1"></a>As always, plot the distribution.</span>
<span id="cb57-347"><a href="#cb57-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-348"><a href="#cb57-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE, fig.height=3, fig.width=5, echo=FALSE, fig.align="center"}</span></span>
<span id="cb57-349"><a href="#cb57-349" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(chi2 = seq(from = 0, to = 20, by = .1)) %&gt;%</span></span>
<span id="cb57-350"><a href="#cb57-350" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(density = dchisq(chi2, df = length(pheno_type) - 1)) %&gt;%</span></span>
<span id="cb57-351"><a href="#cb57-351" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(q95 = if_else(chi2 &gt; qchisq(p = .95, df = length(pheno_type) - 1), density, NA_real_)) %&gt;%</span></span>
<span id="cb57-352"><a href="#cb57-352" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-353"><a href="#cb57-353" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = chi2, y = q95), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-354"><a href="#cb57-354" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = chi2, y = density)) +</span></span>
<span id="cb57-355"><a href="#cb57-355" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = pheno_x2), color = "goldenrod", size = 1, linetype = 2) +</span></span>
<span id="cb57-356"><a href="#cb57-356" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Chi-Square Goodness-of-Fit Test",</span></span>
<span id="cb57-357"><a href="#cb57-357" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = expression(paste(X^2, " = 9.55 (p = .023)")),</span></span>
<span id="cb57-358"><a href="#cb57-358" aria-hidden="true" tabindex="-1"></a><span class="in">       x = expression(chi^2), y = "Density") +</span></span>
<span id="cb57-359"><a href="#cb57-359" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-360"><a href="#cb57-360" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none")</span></span>
<span id="cb57-361"><a href="#cb57-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-362"><a href="#cb57-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-363"><a href="#cb57-363" aria-hidden="true" tabindex="-1"></a>At this point you can report,</span>
<span id="cb57-364"><a href="#cb57-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-365"><a href="#cb57-365" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Of the </span><span class="in">`r sum(pheno_obs) %&gt;% scales::comma()`</span><span class="at"> offspring produced from the cross-fertiliation, </span><span class="in">`r pheno_obs["tall cut-leaf"]`</span><span class="at"> were *tall cut-leaf*, `r pheno_obs["tall potato-leaf"]` were *tall potato-leaf*, `r pheno_obs["dwarf cut-leaf"]` where *dwarf cut-leaf*, and `r pheno_obs["dwarf potato-leaf"]` were *dwarf potato-leaf*. A chi-square goodness-of-fit test was conducted to determine whether the offspring had the same proportion of phenotypes as the theoretical distribution. The minimum expected frequency was `r min(pheno_exp) %&gt;% scales::comma()`. The chi-square goodness-of-fit test indicated that the number of tall cut-leaf, tall potato-leaf, dwarf cut-leaf, and dwarf potato-leaf offspring was statistically significantly different from the proportions expected in the theoretical distribution ($X^2$(`r length(pheno_type) - 1`) = `r scales::comma(pheno_chisq_test$statistic, accuracy = 0.001)`, *p* = </span><span class="in">`r scales::comma(pheno_chisq_test$p.value, accuracy = 0.001)`</span><span class="at">).</span></span>
<span id="cb57-366"><a href="#cb57-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-367"><a href="#cb57-367" aria-hidden="true" tabindex="-1"></a>If you reject $H_0$, inspect the residuals to learn which differences contribute most to the rejection. Notice how $X^2$ is a sum of squared standardized cell differences, or "Pearson residuals", </span>
<span id="cb57-368"><a href="#cb57-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-369"><a href="#cb57-369" aria-hidden="true" tabindex="-1"></a>$$r_i = \frac{o_j - e_j}{\sqrt{e_j}}$$ </span>
<span id="cb57-370"><a href="#cb57-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-371"><a href="#cb57-371" aria-hidden="true" tabindex="-1"></a>Cells with the largest $|r|$ contribute the most to the total $X^2$. </span>
<span id="cb57-372"><a href="#cb57-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-375"><a href="#cb57-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-376"><a href="#cb57-376" aria-hidden="true" tabindex="-1"></a>pheno_chisq_test<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> pheno_chisq_test<span class="sc">$</span>statistic</span>
<span id="cb57-377"><a href="#cb57-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-378"><a href="#cb57-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-379"><a href="#cb57-379" aria-hidden="true" tabindex="-1"></a>The two "tall" cells contributed over 95% of the $X^2$ test statistic, with the tall potato-leaf accounting for 67%. This aligns with what you'd expect from the bar plot.</span>
<span id="cb57-380"><a href="#cb57-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-381"><a href="#cb57-381" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example with Theoretical Distribution {-}</span></span>
<span id="cb57-382"><a href="#cb57-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-383"><a href="#cb57-383" aria-hidden="true" tabindex="-1"></a>You need to reduce the degrees of freedom (df) in the chi-squared goodness-of-fit test by 1 if you test whether the data conform to a particular distribution instead of a set of theoretical values. </span>
<span id="cb57-384"><a href="#cb57-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-387"><a href="#cb57-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-388"><a href="#cb57-388" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb57-389"><a href="#cb57-389" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">13</span>, <span class="dv">10</span>, <span class="dv">3</span>)</span>
<span id="cb57-390"><a href="#cb57-390" aria-hidden="true" tabindex="-1"></a>childr_n <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb57-391"><a href="#cb57-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-392"><a href="#cb57-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-393"><a href="#cb57-393" aria-hidden="true" tabindex="-1"></a>Suppose you sample *n* = <span class="in">`r sum(o)`</span> families and count the number of children. The count of children is a Poisson random variable, $J$, with maximum likelihood estimate $\hat{\lambda} = \sum{j_i O_i} / \sum{O_i}$. Test whether the observed values can be described as samples from a Poisson random variable. The probabilities for each possible count are </span>
<span id="cb57-394"><a href="#cb57-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-395"><a href="#cb57-395" aria-hidden="true" tabindex="-1"></a>$$f(j; \lambda) = \frac{e^{-\hat{\lambda}} \hat{\lambda}^j}{j!}.$$</span>
<span id="cb57-396"><a href="#cb57-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-397"><a href="#cb57-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, fig.height=2.5, fig.width=6.5}</span></span>
<span id="cb57-398"><a href="#cb57-398" aria-hidden="true" tabindex="-1"></a><span class="in">lambda &lt;- sum(j * o) / sum(o)</span></span>
<span id="cb57-399"><a href="#cb57-399" aria-hidden="true" tabindex="-1"></a><span class="in">f &lt;- exp(-lambda) * lambda^j / factorial(j)</span></span>
<span id="cb57-400"><a href="#cb57-400" aria-hidden="true" tabindex="-1"></a><span class="in">e &lt;- f * sum(o)</span></span>
<span id="cb57-401"><a href="#cb57-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-402"><a href="#cb57-402" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(children = childr_n, Observed = o, Expected = e) %&gt;%</span></span>
<span id="cb57-403"><a href="#cb57-403" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = c(Observed, Expected)) %&gt;%</span></span>
<span id="cb57-404"><a href="#cb57-404" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = fct_inorder(children), y = value, color = fct_rev(name), fill = fct_rev(name))) +</span></span>
<span id="cb57-405"><a href="#cb57-405" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col(alpha = 0.6, width = 0.5, position = position_dodge2(padding = 0.1)) +</span></span>
<span id="cb57-406"><a href="#cb57-406" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-407"><a href="#cb57-407" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-408"><a href="#cb57-408" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-409"><a href="#cb57-409" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Children in Family Counts",</span></span>
<span id="cb57-410"><a href="#cb57-410" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Expected Poisson distribution",</span></span>
<span id="cb57-411"><a href="#cb57-411" aria-hidden="true" tabindex="-1"></a><span class="in">       x = NULL, y = NULL, color = NULL, fill = NULL)</span></span>
<span id="cb57-412"><a href="#cb57-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-413"><a href="#cb57-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-414"><a href="#cb57-414" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditions {-}</span></span>
<span id="cb57-415"><a href="#cb57-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-416"><a href="#cb57-416" aria-hidden="true" tabindex="-1"></a>This is random sampling. The minimum expected frequency was <span class="in">`r floor(min(e))`</span>, so the data violates the $\ge$ 5 rule. Lump the last two categories into "4-5".</span>
<span id="cb57-417"><a href="#cb57-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-418"><a href="#cb57-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, fig.height=2.5, fig.width=6.5}</span></span>
<span id="cb57-419"><a href="#cb57-419" aria-hidden="true" tabindex="-1"></a><span class="in">j &lt;- c(0:4)</span></span>
<span id="cb57-420"><a href="#cb57-420" aria-hidden="true" tabindex="-1"></a><span class="in">o &lt;- c(19, 26, 29, 13, 10 + 3)</span></span>
<span id="cb57-421"><a href="#cb57-421" aria-hidden="true" tabindex="-1"></a><span class="in">childr_n &lt;- c(as.character(0:3), "4-5")</span></span>
<span id="cb57-422"><a href="#cb57-422" aria-hidden="true" tabindex="-1"></a><span class="in">lambda &lt;- sum(j * o) / sum(o)</span></span>
<span id="cb57-423"><a href="#cb57-423" aria-hidden="true" tabindex="-1"></a><span class="in">f &lt;- exp(-lambda) * lambda^j / factorial(j)</span></span>
<span id="cb57-424"><a href="#cb57-424" aria-hidden="true" tabindex="-1"></a><span class="in">e &lt;- f * sum(o)</span></span>
<span id="cb57-425"><a href="#cb57-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-426"><a href="#cb57-426" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(children = childr_n, Observed = o, Expected = e) %&gt;%</span></span>
<span id="cb57-427"><a href="#cb57-427" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = c(Observed, Expected)) %&gt;%</span></span>
<span id="cb57-428"><a href="#cb57-428" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = fct_inorder(children), y = value, color = fct_rev(name), fill = fct_rev(name))) +</span></span>
<span id="cb57-429"><a href="#cb57-429" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col(alpha = 0.6, width = 0.5, position = position_dodge2(padding = 0.1)) +</span></span>
<span id="cb57-430"><a href="#cb57-430" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-431"><a href="#cb57-431" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-432"><a href="#cb57-432" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-433"><a href="#cb57-433" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Children in Family Counts",</span></span>
<span id="cb57-434"><a href="#cb57-434" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Expected Poisson distribution",</span></span>
<span id="cb57-435"><a href="#cb57-435" aria-hidden="true" tabindex="-1"></a><span class="in">       x = NULL, y = NULL, color = NULL, fill = NULL)</span></span>
<span id="cb57-436"><a href="#cb57-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-437"><a href="#cb57-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-438"><a href="#cb57-438" aria-hidden="true" tabindex="-1"></a>The minimum expected frequency was <span class="in">`r floor(min(e))`</span>, so now the chi-squared test of independence is valid.</span>
<span id="cb57-439"><a href="#cb57-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-440"><a href="#cb57-440" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results {-}</span></span>
<span id="cb57-441"><a href="#cb57-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-442"><a href="#cb57-442" aria-hidden="true" tabindex="-1"></a>Compare the expected values to the observed values with the chi-squared goodness of fit test, but in this case $df = 5 - 1 - 1$ because the estimated parameter $\lambda$ reduces df by 1. You cannot set df in <span class="in">`chisq.test()`</span>, so perform the test manually.</span>
<span id="cb57-443"><a href="#cb57-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-444"><a href="#cb57-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb57-445"><a href="#cb57-445" aria-hidden="true" tabindex="-1"></a><span class="in">(X2 &lt;- sum((o - e)^2 / e))</span></span>
<span id="cb57-446"><a href="#cb57-446" aria-hidden="true" tabindex="-1"></a><span class="in">(p.value &lt;- pchisq(q = X2, df = length(j) - 1 - 1, lower.tail = FALSE))</span></span>
<span id="cb57-447"><a href="#cb57-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-448"><a href="#cb57-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-449"><a href="#cb57-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE, fig.height=3, fig.width=5, echo=FALSE, fig.align="center"}</span></span>
<span id="cb57-450"><a href="#cb57-450" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(chi2 = seq(from = 0, to = 20, by = .1)) %&gt;%</span></span>
<span id="cb57-451"><a href="#cb57-451" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(density = dchisq(chi2, df = length(j) - 1 - 1)) %&gt;%</span></span>
<span id="cb57-452"><a href="#cb57-452" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb57-453"><a href="#cb57-453" aria-hidden="true" tabindex="-1"></a><span class="in">    q025 = if_else(chi2 &lt; qchisq(p = .025, df = length(j) - 1 - 1), density, NA_real_),</span></span>
<span id="cb57-454"><a href="#cb57-454" aria-hidden="true" tabindex="-1"></a><span class="in">    q975 = if_else(chi2 &gt; qchisq(p = .975, df = length(j) - 1 - 1), density, NA_real_)) %&gt;%</span></span>
<span id="cb57-455"><a href="#cb57-455" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-456"><a href="#cb57-456" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = chi2, y = q025), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-457"><a href="#cb57-457" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = chi2, y = q975), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-458"><a href="#cb57-458" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = chi2, y = density)) +</span></span>
<span id="cb57-459"><a href="#cb57-459" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = X2), color = "goldenrod", size = 1, linetype = 2) +</span></span>
<span id="cb57-460"><a href="#cb57-460" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Chi-Square Goodness-of-Fit Test",</span></span>
<span id="cb57-461"><a href="#cb57-461" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = expression(paste(X^2, " = 7.09 (p = .931)")),</span></span>
<span id="cb57-462"><a href="#cb57-462" aria-hidden="true" tabindex="-1"></a><span class="in">       x = expression(chi^2), y = "Density") +</span></span>
<span id="cb57-463"><a href="#cb57-463" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-464"><a href="#cb57-464" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none")</span></span>
<span id="cb57-465"><a href="#cb57-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-466"><a href="#cb57-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-467"><a href="#cb57-467" aria-hidden="true" tabindex="-1"></a>At this point you can report,</span>
<span id="cb57-468"><a href="#cb57-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-469"><a href="#cb57-469" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Of the </span><span class="in">`r sum(o) %&gt;% scales::comma()`</span><span class="at"> families sampled, </span><span class="in">`r o[1]`</span><span class="at"> had no children, </span><span class="in">`r o[2]`</span><span class="at"> had one child, </span><span class="in">`r o[3]`</span><span class="at"> had two children, </span><span class="in">`r o[4]`</span><span class="at"> had three children, and </span><span class="in">`r o[5]`</span><span class="at"> had 4 or 5 children. A chi-square goodness-of-fit test was conducted to determine whether the observed family sizes follow a Poisson distribution. The minimum expected frequency was </span><span class="in">`r min(o) %&gt;% scales::comma()`</span><span class="at">. The chi-square goodness-of-fit test indicated that the number of children was not statistically significantly different from the proportions expected in the Poisson distribution ($X^2$(</span><span class="in">`r length(o) - 1 - 1`</span><span class="at">) = </span><span class="in">`r scales::comma(X2, accuracy = 0.001)`</span><span class="at">, *p* = </span><span class="in">`r scales::comma(p.value, accuracy = 0.001)`</span><span class="at">).</span></span>
<span id="cb57-470"><a href="#cb57-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-471"><a href="#cb57-471" aria-hidden="true" tabindex="-1"></a><span class="fu">## G-Test</span></span>
<span id="cb57-472"><a href="#cb57-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-473"><a href="#cb57-473" aria-hidden="true" tabindex="-1"></a>The G-test is a likelihood-ratio statistical significance test increasingly used instead of chi-squared tests. The test statistic is defined </span>
<span id="cb57-474"><a href="#cb57-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-475"><a href="#cb57-475" aria-hidden="true" tabindex="-1"></a>$$G^2 = 2 \sum O_j \log \left<span class="co">[</span><span class="ot"> \frac{O_j}{E_j} \right</span><span class="co">]</span>$$</span>
<span id="cb57-476"><a href="#cb57-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-477"><a href="#cb57-477" aria-hidden="true" tabindex="-1"></a>where the 2 multiplier asymptotically aligns with the chi-squared test formula. *G* is distributed $\sim \chi^2$, with the same number of degrees of freedom as in the corresponding chi-squared test. In fact, the chi-squared test statistic is a second order Taylor expansion of the natural logarithm around 1. </span>
<span id="cb57-478"><a href="#cb57-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-479"><a href="#cb57-479" aria-hidden="true" tabindex="-1"></a>Returning to the phenotype case study in the chi-squared goodness-of-fit test section, you can calculate the $G^2$ test statistic and probability by hand.</span>
<span id="cb57-480"><a href="#cb57-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-481"><a href="#cb57-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb57-482"><a href="#cb57-482" aria-hidden="true" tabindex="-1"></a><span class="in">(pheno_g2 &lt;- 2 * sum(pheno_obs * log(pheno_obs / pheno_exp)))</span></span>
<span id="cb57-483"><a href="#cb57-483" aria-hidden="true" tabindex="-1"></a><span class="in">(pchisq(q = pheno_g2, df = length(pheno_type) - 1, lower.tail = FALSE))</span></span>
<span id="cb57-484"><a href="#cb57-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-485"><a href="#cb57-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-486"><a href="#cb57-486" aria-hidden="true" tabindex="-1"></a>This is pretty close to the $X^2$ = <span class="in">`r pheno_chisq_test$statistic %&gt;% scales::comma(accuracy = 0.001)`</span>, *p* = <span class="in">`r pheno_chisq_test$p.value %&gt;% scales::comma(accuracy = 0.001)`</span> using the chi-squared goodness-of-fit test. The <span class="in">`DescTools::GTest()`</span> function to conducts a G-test. </span>
<span id="cb57-487"><a href="#cb57-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-490"><a href="#cb57-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-491"><a href="#cb57-491" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">GTest</span>(pheno_obs, <span class="at">p =</span> pheno_pi)</span>
<span id="cb57-492"><a href="#cb57-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-493"><a href="#cb57-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-494"><a href="#cb57-494" aria-hidden="true" tabindex="-1"></a>According to the function documentation, the G-test is not usually used for 2x2 tables.</span>
<span id="cb57-495"><a href="#cb57-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-496"><a href="#cb57-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-497"><a href="#cb57-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb57-498"><a href="#cb57-498" aria-hidden="true" tabindex="-1"></a><span class="in">EMT::multinomial.test(o, f, useChisq = TRUE)</span></span>
<span id="cb57-499"><a href="#cb57-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-500"><a href="#cb57-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-503"><a href="#cb57-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-504"><a href="#cb57-504" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(o, e)</span>
<span id="cb57-505"><a href="#cb57-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-506"><a href="#cb57-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-507"><a href="#cb57-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-508"><a href="#cb57-508" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-Sample Poisson Test</span></span>
<span id="cb57-509"><a href="#cb57-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-510"><a href="#cb57-510" aria-hidden="true" tabindex="-1"></a>If $X$ is the number of successes in $n$ (many) trials when the probability of success $\lambda / n$ is small, then $X$ is a random variable with a Poisson distribution, and the probability of observing $X = x$ successes is </span>
<span id="cb57-511"><a href="#cb57-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-512"><a href="#cb57-512" aria-hidden="true" tabindex="-1"></a>$$f(x;\lambda) = \frac{e^{-\lambda} \lambda^x}{x!} \hspace{1cm} x \in (0, 1, ...), \hspace{2mm} \lambda &gt; 0$$</span>
<span id="cb57-513"><a href="#cb57-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-514"><a href="#cb57-514" aria-hidden="true" tabindex="-1"></a>with $E(X)=\lambda$ and $Var(X) = \lambda$ where $\lambda$ is estimated by the sample $\hat{\lambda}$,</span>
<span id="cb57-515"><a href="#cb57-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-516"><a href="#cb57-516" aria-hidden="true" tabindex="-1"></a>$$\hat{\lambda} = \sum_{i=1}^N x_i / n.$$</span>
<span id="cb57-517"><a href="#cb57-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-518"><a href="#cb57-518" aria-hidden="true" tabindex="-1"></a>Poisson sampling is used to model counts of events that occur randomly over a fixed period of time. You can use the Poisson distribution to perform an exact test on a Poisson random variable.</span>
<span id="cb57-519"><a href="#cb57-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-520"><a href="#cb57-520" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example {-}</span></span>
<span id="cb57-521"><a href="#cb57-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-522"><a href="#cb57-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-523"><a href="#cb57-523" aria-hidden="true" tabindex="-1"></a><span class="in">dat_pois &lt;- data.frame(</span></span>
<span id="cb57-524"><a href="#cb57-524" aria-hidden="true" tabindex="-1"></a><span class="in">  goals = c(0, 1, 2, 3, 4, 5, 6, 7, 8),</span></span>
<span id="cb57-525"><a href="#cb57-525" aria-hidden="true" tabindex="-1"></a><span class="in">  freq = c(23, 37, 20, 11, 2, 1, 0, 0, 1)</span></span>
<span id="cb57-526"><a href="#cb57-526" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb57-527"><a href="#cb57-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-528"><a href="#cb57-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-529"><a href="#cb57-529" aria-hidden="true" tabindex="-1"></a>You are analyzing goal totals from a sample consisting of the <span class="in">`r sum(dat_pois$freq)`</span> matches in the first round of the 2002 World Cup. The average match produced a mean/sd of <span class="in">`r weighted.mean(x = dat_pois$goals, w = dat_pois$freq) %&gt;% scales::comma(accuracy = .01)`</span> $\pm$ <span class="in">`r radiant.data::weighted.sd(x = dat_pois$goals, w = dat_pois$freq) %&gt;% scales::comma(accuracy = .01)`</span> goals, lower than the 1.5 historical average. Should you reject the null hypothesis that the sample is representative of typical values?</span>
<span id="cb57-530"><a href="#cb57-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-531"><a href="#cb57-531" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditions {-}</span></span>
<span id="cb57-532"><a href="#cb57-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-533"><a href="#cb57-533" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The events must be independent of each other. In this case, the goal-count in one match has no effect on goal-counts in other matches.</span>
<span id="cb57-534"><a href="#cb57-534" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The expected value of each event must be the same (homogeneity). In this case, the expected goal-count of each match is the same regardless of which teams are playing. This assumption is often dubious, causing the distribution variance to be larger than the mean, a conditional called *over-dispersion*.</span>
<span id="cb57-535"><a href="#cb57-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-536"><a href="#cb57-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb57-537"><a href="#cb57-537" aria-hidden="true" tabindex="-1"></a><span class="in">o &lt;- dat_pois$freq</span></span>
<span id="cb57-538"><a href="#cb57-538" aria-hidden="true" tabindex="-1"></a><span class="in">j &lt;- dat_pois$goals</span></span>
<span id="cb57-539"><a href="#cb57-539" aria-hidden="true" tabindex="-1"></a><span class="in">lambda &lt;- weighted.mean(j, o)</span></span>
<span id="cb57-540"><a href="#cb57-540" aria-hidden="true" tabindex="-1"></a><span class="in">f &lt;- exp(-lambda) * lambda^j / factorial(j)</span></span>
<span id="cb57-541"><a href="#cb57-541" aria-hidden="true" tabindex="-1"></a><span class="in">e &lt;- f * sum(o)</span></span>
<span id="cb57-542"><a href="#cb57-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-543"><a href="#cb57-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-544"><a href="#cb57-544" aria-hidden="true" tabindex="-1"></a>You might also check whether the data is consistent with a Poisson model. This is random sampling, but the data violates the $\ge$ 5 rule because the minimum expected frequency was <span class="in">`r floor(min(e))`</span>. To comply with the minimum frequency rule, lump the last six categories into "3-8".</span>
<span id="cb57-545"><a href="#cb57-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-546"><a href="#cb57-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, fig.height=2.5, fig.width=6.5}</span></span>
<span id="cb57-547"><a href="#cb57-547" aria-hidden="true" tabindex="-1"></a><span class="in">o &lt;- c(o[0:3], sum(o[4:9]))</span></span>
<span id="cb57-548"><a href="#cb57-548" aria-hidden="true" tabindex="-1"></a><span class="in">e &lt;- c(e[0:3], sum(e[4:9]))</span></span>
<span id="cb57-549"><a href="#cb57-549" aria-hidden="true" tabindex="-1"></a><span class="in">j &lt;- c(j[0:3], paste(j[4], j[9], sep = "-"))</span></span>
<span id="cb57-550"><a href="#cb57-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-551"><a href="#cb57-551" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(goals = j, Observed = o, Expected = e) %&gt;%</span></span>
<span id="cb57-552"><a href="#cb57-552" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = c(Observed, Expected)) %&gt;%</span></span>
<span id="cb57-553"><a href="#cb57-553" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = fct_inorder(as.character(goals)), y = value, color = fct_rev(name), fill = fct_rev(name))) +</span></span>
<span id="cb57-554"><a href="#cb57-554" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col(alpha = 0.6, width = 0.5, position = position_dodge2(padding = 0.1)) +</span></span>
<span id="cb57-555"><a href="#cb57-555" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-556"><a href="#cb57-556" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_grey(start = 0.6, end = 0.8) +</span></span>
<span id="cb57-557"><a href="#cb57-557" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-558"><a href="#cb57-558" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.title = element_text(size = 9)) +</span></span>
<span id="cb57-559"><a href="#cb57-559" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Counts of 2002 World Cup Round 1 Match Goals",</span></span>
<span id="cb57-560"><a href="#cb57-560" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Expected Poisson distribution",</span></span>
<span id="cb57-561"><a href="#cb57-561" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Goals in Match", y = "Count of Matches", color = NULL, fill = NULL)</span></span>
<span id="cb57-562"><a href="#cb57-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-563"><a href="#cb57-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-564"><a href="#cb57-564" aria-hidden="true" tabindex="-1"></a>The minimum expected frequency was <span class="in">`r floor(min(e))`</span>, so now the chi-squared test of independence is valid. Compare the expected values to the observed values with the chi-squared goodness of fit test, but in this case $df = 4 - 1 - 1$ because the estimated parameter $\lambda$ reduces the df by 1. You cannot set df in <span class="in">`chisq.test()`</span>, so perform the test manually.</span>
<span id="cb57-565"><a href="#cb57-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-566"><a href="#cb57-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb57-567"><a href="#cb57-567" aria-hidden="true" tabindex="-1"></a><span class="in">(X2 &lt;- sum((o - e)^2 / e))</span></span>
<span id="cb57-568"><a href="#cb57-568" aria-hidden="true" tabindex="-1"></a><span class="in">(p.value &lt;- pchisq(q = X2, df = length(j) - 1 - 1, lower.tail = FALSE))</span></span>
<span id="cb57-569"><a href="#cb57-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-570"><a href="#cb57-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-571"><a href="#cb57-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE, fig.height=2.5, fig.width=5, echo=FALSE, fig.align="center"}</span></span>
<span id="cb57-572"><a href="#cb57-572" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(chi2 = seq(from = 0, to = 10, by = .1)) %&gt;%</span></span>
<span id="cb57-573"><a href="#cb57-573" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(density = dchisq(chi2, df = length(j) - 1 - 1)) %&gt;%</span></span>
<span id="cb57-574"><a href="#cb57-574" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb57-575"><a href="#cb57-575" aria-hidden="true" tabindex="-1"></a><span class="in">    q025 = if_else(chi2 &lt; qchisq(p = .025, df = length(j) - 1 - 1), density, NA_real_),</span></span>
<span id="cb57-576"><a href="#cb57-576" aria-hidden="true" tabindex="-1"></a><span class="in">    q975 = if_else(chi2 &gt; qchisq(p = .975, df = length(j) - 1 - 1), density, NA_real_)) %&gt;%</span></span>
<span id="cb57-577"><a href="#cb57-577" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-578"><a href="#cb57-578" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = chi2, y = q025), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-579"><a href="#cb57-579" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = chi2, y = q975), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-580"><a href="#cb57-580" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = chi2, y = density)) +</span></span>
<span id="cb57-581"><a href="#cb57-581" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = X2), color = "goldenrod", size = 1, linetype = 2) +</span></span>
<span id="cb57-582"><a href="#cb57-582" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Chi-Square Goodness-of-Fit Test",</span></span>
<span id="cb57-583"><a href="#cb57-583" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = expression(paste(X^2, "(2) = 0.86, (p = .650)")),</span></span>
<span id="cb57-584"><a href="#cb57-584" aria-hidden="true" tabindex="-1"></a><span class="in">       x = expression(chi^2), y = "Density") +</span></span>
<span id="cb57-585"><a href="#cb57-585" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-586"><a href="#cb57-586" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none")</span></span>
<span id="cb57-587"><a href="#cb57-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-588"><a href="#cb57-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-589"><a href="#cb57-589" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Of the </span><span class="in">`r sum(o) %&gt;% scales::comma()`</span><span class="at"> World Cup matches, </span><span class="in">`r o[1]`</span><span class="at"> had no goals, </span><span class="in">`r o[2]`</span><span class="at"> had one goal, </span><span class="in">`r o[3]`</span><span class="at"> had two goals, and </span><span class="in">`r o[4]`</span><span class="at"> had 3-8 goals. A chi-square goodness-of-fit test was conducted to determine whether the observed goal counts follow a Poisson distribution. The minimum expected frequency was </span><span class="in">`r min(o) %&gt;% scales::comma()`</span><span class="at">. The chi-square goodness-of-fit test indicated that the number of goals scored was not statistically significantly different from the frequencies expected from a Poisson distribution ($X^2$(</span><span class="in">`r length(o) - 1 - 1`</span><span class="at">) = </span><span class="in">`r scales::comma(X2, accuracy = 0.001)`</span><span class="at">, *p* = </span><span class="in">`r scales::comma(p.value, accuracy = 0.001)`</span><span class="at">).</span></span>
<span id="cb57-590"><a href="#cb57-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-591"><a href="#cb57-591" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results {-}</span></span>
<span id="cb57-592"><a href="#cb57-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-593"><a href="#cb57-593" aria-hidden="true" tabindex="-1"></a>The conditions for the exact Poisson test were met, so go ahead and run the test.</span>
<span id="cb57-594"><a href="#cb57-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-597"><a href="#cb57-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-598"><a href="#cb57-598" aria-hidden="true" tabindex="-1"></a>(pois_val <span class="ot">&lt;-</span> <span class="fu">poisson.test</span>(</span>
<span id="cb57-599"><a href="#cb57-599" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">sum</span>(dat_pois<span class="sc">$</span>goals <span class="sc">*</span> dat_pois<span class="sc">$</span>freq), </span>
<span id="cb57-600"><a href="#cb57-600" aria-hidden="true" tabindex="-1"></a>  <span class="at">T =</span> <span class="fu">sum</span>(dat_pois<span class="sc">$</span>freq), </span>
<span id="cb57-601"><a href="#cb57-601" aria-hidden="true" tabindex="-1"></a>  <span class="at">r =</span> <span class="fl">1.5</span>)</span>
<span id="cb57-602"><a href="#cb57-602" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-603"><a href="#cb57-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-604"><a href="#cb57-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-605"><a href="#cb57-605" aria-hidden="true" tabindex="-1"></a>Construct a plot showing the 95% CI around the hypothesized value. For a Poisson distribution, I built the distribution around the expected value, $n\lambda$, not the rate, $\lambda$.</span>
<span id="cb57-606"><a href="#cb57-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-607"><a href="#cb57-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, warning=FALSE, fig.height=3.5, fig.width=6.5}</span></span>
<span id="cb57-608"><a href="#cb57-608" aria-hidden="true" tabindex="-1"></a><span class="in">lrr = qpois(.025, 1.5 * sum(dat_pois$freq), lower.tail = TRUE)</span></span>
<span id="cb57-609"><a href="#cb57-609" aria-hidden="true" tabindex="-1"></a><span class="in">urr = qpois(.025, 1.5 * sum(dat_pois$freq), lower.tail = FALSE)</span></span>
<span id="cb57-610"><a href="#cb57-610" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(tot_goals = seq(50, 200, by = 1)) %&gt;%</span></span>
<span id="cb57-611"><a href="#cb57-611" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(prob = dpois(x = tot_goals, lambda = 1.5 * sum(dat_pois$freq)),</span></span>
<span id="cb57-612"><a href="#cb57-612" aria-hidden="true" tabindex="-1"></a><span class="in">         lrr = if_else(tot_goals &lt; lrr, prob, NA_real_),</span></span>
<span id="cb57-613"><a href="#cb57-613" aria-hidden="true" tabindex="-1"></a><span class="in">         urr = if_else(tot_goals &gt; urr, prob, NA_real_)) %&gt;%</span></span>
<span id="cb57-614"><a href="#cb57-614" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-615"><a href="#cb57-615" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = tot_goals, y = prob)) +</span></span>
<span id="cb57-616"><a href="#cb57-616" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = tot_goals, y = lrr), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-617"><a href="#cb57-617" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = tot_goals, y = urr), fill = "firebrick", alpha = 0.6) +</span></span>
<span id="cb57-618"><a href="#cb57-618" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = 1.5 * sum(dat_pois$freq)), size = 1) +</span></span>
<span id="cb57-619"><a href="#cb57-619" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = pois_val$estimate * sum(dat_pois$freq)),</span></span>
<span id="cb57-620"><a href="#cb57-620" aria-hidden="true" tabindex="-1"></a><span class="in">             color = "goldenrod", size = 1, linetype = 2) +</span></span>
<span id="cb57-621"><a href="#cb57-621" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-622"><a href="#cb57-622" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none",</span></span>
<span id="cb57-623"><a href="#cb57-623" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_blank()) +</span></span>
<span id="cb57-624"><a href="#cb57-624" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = bquote("Two-Tailed Poisson Test"),</span></span>
<span id="cb57-625"><a href="#cb57-625" aria-hidden="true" tabindex="-1"></a><span class="in">       x = expression(paste("n", lambda)),</span></span>
<span id="cb57-626"><a href="#cb57-626" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Probability")</span></span>
<span id="cb57-627"><a href="#cb57-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-628"><a href="#cb57-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-629"><a href="#cb57-629" aria-hidden="true" tabindex="-1"></a>I think you could report these results like this.</span>
<span id="cb57-630"><a href="#cb57-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-631"><a href="#cb57-631" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A one-sample exact Poisson test was run to determine whether the number of goals scored in the first round of the 2002 World Cup was different from past World Cups, 1.5. A chi-square goodness-of-fit test indicated that the number of goals was not statistically significantly different from the counts expected in the Poisson distribution ($X^2$(</span><span class="in">`r length(o) - 1 - 1`</span><span class="at">) = </span><span class="in">`r scales::comma(X2, accuracy = 0.001)`</span><span class="at">, *p* = `r scales::comma(p.value, accuracy = 0.001)`). Data are mean $\pm$ standard deviation, unless otherwise stated. Mean goals scored (`r format(lambda, digits = 2, nsmall = 2)` $\pm$ `r radiant.data::weighted.sd(x = dat_pois$goals, w = dat_pois$freq) %&gt;% scales::comma(accuracy = .01)`) was lower than the historical mean of `r format(1.5, digits = 2, nsmall = 2)`, but was not statistically significantly different (95% CI, `r format(pois_val$conf.int[1], digits = 1, nsmall = 2)` to `r format(pois_val$conf.int[2], digits = 1, nsmall = 2)`), *p* = </span><span class="in">`r format(pois_val$p.value, digits = 1, nsmall = 3)`</span><span class="at">.</span></span>
<span id="cb57-632"><a href="#cb57-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-633"><a href="#cb57-633" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exact Binomial Test</span></span>
<span id="cb57-634"><a href="#cb57-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-635"><a href="#cb57-635" aria-hidden="true" tabindex="-1"></a>The Clopper-Pearson exact binomial test is precise, but theoretically complicated in that it inverts two single-tailed binomial tests (*No theory here - I'll just rely on the software*). Use the exact binomial test if you have a small sample size or an extreme success/failure probability that invalidates the chi-square and *G* tests. The exact binomial also applies when you have a one-tail test. The exact binomial test has two conditions: </span>
<span id="cb57-636"><a href="#cb57-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-637"><a href="#cb57-637" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>independence, and </span>
<span id="cb57-638"><a href="#cb57-638" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>at least $n\pi \ge 5$ successes *or* $n(1−\pi)\ge 5$ failures. </span>
<span id="cb57-639"><a href="#cb57-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-640"><a href="#cb57-640" aria-hidden="true" tabindex="-1"></a>You can use this test for multinomial variables too, but the test only compares a single level's proportion to a hypothesized value.</span>
<span id="cb57-641"><a href="#cb57-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-642"><a href="#cb57-642" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example {-}</span></span>
<span id="cb57-643"><a href="#cb57-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-644"><a href="#cb57-644" aria-hidden="true" tabindex="-1"></a>A pharmaceutical company claims its drug reduces fever in &gt;60% of cases. In a random sample of *n* = 40 cases the drug reduces fever in 20 cases. Do you reject the claim?</span>
<span id="cb57-645"><a href="#cb57-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-646"><a href="#cb57-646" aria-hidden="true" tabindex="-1"></a>You are testing $P(x \le 20)$ in *n* = 40 trials when *p* = 60%, a one-tail test. The sample is a random assignment experiment with 20&gt;5 successes and 20&gt;5 failures, so it meets the conditions for the exact binomial test.</span>
<span id="cb57-647"><a href="#cb57-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-650"><a href="#cb57-650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-651"><a href="#cb57-651" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb57-652"><a href="#cb57-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-653"><a href="#cb57-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-654"><a href="#cb57-654" aria-hidden="true" tabindex="-1"></a>The exact binomial test uses the "method of small *p*-values", in which the probability of observing a proportion $p$ as far or further from $\pi_0$ is the sum of all $P(X=p_i)$ where $p_i &lt;= p$.</span>
<span id="cb57-655"><a href="#cb57-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-658"><a href="#cb57-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-659"><a href="#cb57-659" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">40</span>, <span class="fl">0.6</span>), <span class="sc">~</span><span class="fu">if_else</span>(. <span class="sc">&lt;=</span> <span class="fl">0.5</span>, ., <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb57-660"><a href="#cb57-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-661"><a href="#cb57-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-662"><a href="#cb57-662" aria-hidden="true" tabindex="-1"></a>That is what <span class="in">`pbinom()`</span> does.</span>
<span id="cb57-663"><a href="#cb57-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-666"><a href="#cb57-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-667"><a href="#cb57-667" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">20</span>, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-668"><a href="#cb57-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-669"><a href="#cb57-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-670"><a href="#cb57-670" aria-hidden="true" tabindex="-1"></a>A 95% confidence interval means 95% of confidence intervals constructed from a random sample of the population will contain the true population proportion. There are several methods to calculate a binomial confidence interval^[<span class="co">[</span><span class="ot">Wikipedia</span><span class="co">](https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval)</span>.] <span class="in">`binom.test()`</span> uses the Clopper-Pearson interval. This method calculates lower ($P_L$) and upper ($P_U$) limits that satisfy </span>
<span id="cb57-671"><a href="#cb57-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-672"><a href="#cb57-672" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb57-673"><a href="#cb57-673" aria-hidden="true" tabindex="-1"></a>\begin{eqnarray}</span>
<span id="cb57-674"><a href="#cb57-674" aria-hidden="true" tabindex="-1"></a>\sum_{x=n_1}^n \binom{n}{x} p_L^x(1 - p_L)^{n-x} &amp;=&amp; \alpha/2<span class="sc">\\</span></span>
<span id="cb57-675"><a href="#cb57-675" aria-hidden="true" tabindex="-1"></a>\sum_{x=0}^{n_1} \binom{n}{x} p_U^x(1 - p_U)^{n-x} &amp;=&amp; \alpha/2</span>
<span id="cb57-676"><a href="#cb57-676" aria-hidden="true" tabindex="-1"></a>\end{eqnarray}</span>
<span id="cb57-677"><a href="#cb57-677" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb57-678"><a href="#cb57-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-679"><a href="#cb57-679" aria-hidden="true" tabindex="-1"></a>where $n_i$ is the measured successes in $n$ trials. For a one-tail test, the confidence interval is calculated with the right side equaling 0 and $/alpha$ instead of $\alpha/2$. A right-tailed 95% confidence interval means 95% of confidence intervals will contain a lower limit that is less than the true population proportion. If you wanted to construct a confidence interval around the population proportion, use a two-sided test.</span>
<span id="cb57-680"><a href="#cb57-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-683"><a href="#cb57-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-684"><a href="#cb57-684" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb57-685"><a href="#cb57-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-686"><a href="#cb57-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-687"><a href="#cb57-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-688"><a href="#cb57-688" aria-hidden="true" tabindex="-1"></a>If you just wanted to know whether 20 successes in 40 trials is compatible with a population proportion of 60%, then you could use the chi-squared goodness-of-fit test.</span>
<span id="cb57-689"><a href="#cb57-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-692"><a href="#cb57-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-693"><a href="#cb57-693" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>), <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-694"><a href="#cb57-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-695"><a href="#cb57-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-696"><a href="#cb57-696" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-Sample Proportion z Test</span></span>
<span id="cb57-697"><a href="#cb57-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-698"><a href="#cb57-698" aria-hidden="true" tabindex="-1"></a>The *z*-test uses the sample proportion of group $j$, $p_j$, as an estimate of the population proportion $\pi_j$ to evaluate an hypothesized population proportion $\pi_{0j}$ and/or construct a $(1−\alpha)\%$ confidence interval around $p_j$ to estimate $\pi_j$ within a margin of error $\epsilon$.</span>
<span id="cb57-699"><a href="#cb57-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-700"><a href="#cb57-700" aria-hidden="true" tabindex="-1"></a>The *z*-test is intuitive to learn, but it only applies when the central limit theorem conditions hold:</span>
<span id="cb57-701"><a href="#cb57-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-702"><a href="#cb57-702" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>the sample is independently drawn, meaning random assignment (experiments), or random sampling without replacement from &lt;10% of the population (observational studies),</span>
<span id="cb57-703"><a href="#cb57-703" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>there are at least 5 successes and 5 failures,</span>
<span id="cb57-704"><a href="#cb57-704" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>the sample size is &gt;=30, and</span>
<span id="cb57-705"><a href="#cb57-705" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>the expected probability of success is not extreme, between 0.2 and 0.8.</span>
<span id="cb57-706"><a href="#cb57-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-707"><a href="#cb57-707" aria-hidden="true" tabindex="-1"></a>If these conditions hold, the sampling distribution of $\pi$ is normally distributed around $p$ with standard error $se_p = \frac{s_p}{\sqrt{n}} = \frac{\sqrt{p(1−p)}}{\sqrt{n}}$. The measured values $p$ and $s_p$ approximate the population values $\pi$ and $\sigma_\pi$. You can define a $(1 − \alpha)\%$ confidence interval as $p \pm z_{\alpha / 2}se_p$. Test the hypothesis of $\pi = \pi_0$ with test statistic $z = \frac{p − \pi_0}{se_{\pi_0}}$ where $se_{\pi_0} = \frac{s_{\pi_0}}{\sqrt{n}} = \frac{\sqrt{{\pi_0}(1−{\pi_0})}}{\sqrt{n}}$.</span>
<span id="cb57-708"><a href="#cb57-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-709"><a href="#cb57-709" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example {-}</span></span>
<span id="cb57-710"><a href="#cb57-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-711"><a href="#cb57-711" aria-hidden="true" tabindex="-1"></a>A machine is supposed to randomly churn out prizes in 60% of boxes. In a random sample of *n* = 40 boxes there are prizes in 20 boxes. Is the machine flawed?</span>
<span id="cb57-712"><a href="#cb57-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-715"><a href="#cb57-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-716"><a href="#cb57-716" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="fl">0.6</span>, <span class="st">"two.sided"</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-717"><a href="#cb57-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-718"><a href="#cb57-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-719"><a href="#cb57-719" aria-hidden="true" tabindex="-1"></a>The first thing you'll notice is that <span class="in">`prop.test()`</span> performs a chi-squared goodness-of-fit test, not a one-proportion *Z*-test!</span>
<span id="cb57-720"><a href="#cb57-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-723"><a href="#cb57-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-724"><a href="#cb57-724" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">40-20</span>), <span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">6</span>, .<span class="dv">4</span>), <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-725"><a href="#cb57-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-726"><a href="#cb57-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-727"><a href="#cb57-727" aria-hidden="true" tabindex="-1"></a>It turns out $P(\chi^2 &gt; X^2)$ equals $2 \cdot P(Z &gt; z).$ Here is the manual calculation of the chi-squared test statistic $X^2$ and resulting *p*-value on 1 dof.</span>
<span id="cb57-728"><a href="#cb57-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-731"><a href="#cb57-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-732"><a href="#cb57-732" aria-hidden="true" tabindex="-1"></a>pi_0 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb57-733"><a href="#cb57-733" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">/</span> <span class="dv">40</span></span>
<span id="cb57-734"><a href="#cb57-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-735"><a href="#cb57-735" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p) <span class="sc">*</span> <span class="dv">40</span></span>
<span id="cb57-736"><a href="#cb57-736" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">c</span>(pi_0, <span class="dv">1</span><span class="sc">-</span>pi_0) <span class="sc">*</span> <span class="dv">40</span></span>
<span id="cb57-737"><a href="#cb57-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-738"><a href="#cb57-738" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb57-739"><a href="#cb57-739" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(X2, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-740"><a href="#cb57-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-741"><a href="#cb57-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-742"><a href="#cb57-742" aria-hidden="true" tabindex="-1"></a>And here is the manual calculation of the *Z*-test statistic $z$ and resulting *p*-value.</span>
<span id="cb57-745"><a href="#cb57-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-746"><a href="#cb57-746" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi_0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pi_0)) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>)</span>
<span id="cb57-747"><a href="#cb57-747" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (p <span class="sc">-</span> pi_0) <span class="sc">/</span> se</span>
<span id="cb57-748"><a href="#cb57-748" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb57-749"><a href="#cb57-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-750"><a href="#cb57-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-751"><a href="#cb57-751" aria-hidden="true" tabindex="-1"></a>The 95% CI presented by <span class="in">`prop.test()`</span> is also not the $p \pm z_{\alpha / 2}se_p$ Wald interval; it is the *Wilson* interval!</span>
<span id="cb57-752"><a href="#cb57-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-755"><a href="#cb57-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-756"><a href="#cb57-756" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">BinomCI</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">method =</span> <span class="st">"wilson"</span>)</span>
<span id="cb57-757"><a href="#cb57-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-758"><a href="#cb57-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-759"><a href="#cb57-759" aria-hidden="true" tabindex="-1"></a>There are a lot of methods (*see* `?DescTools::BinomCI`), and *Wilson* is the one Agresti-Coull recommends. If you want *Wald*, use <span class="in">`DescTools::BinomCI()`</span> with <span class="in">`method = "wald"`</span>.</span>
<span id="cb57-760"><a href="#cb57-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-763"><a href="#cb57-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-764"><a href="#cb57-764" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">BinomCI</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="at">method =</span> <span class="st">"wald"</span>)</span>
<span id="cb57-765"><a href="#cb57-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-766"><a href="#cb57-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-767"><a href="#cb57-767" aria-hidden="true" tabindex="-1"></a>This matches the manual calculation below.</span>
<span id="cb57-768"><a href="#cb57-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-771"><a href="#cb57-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-772"><a href="#cb57-772" aria-hidden="true" tabindex="-1"></a>z_crit <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">05</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb57-773"><a href="#cb57-773" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>)</span>
<span id="cb57-774"><a href="#cb57-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-775"><a href="#cb57-775" aria-hidden="true" tabindex="-1"></a>(CI <span class="ot">&lt;-</span> <span class="fu">c</span>(p <span class="sc">-</span> z_crit<span class="sc">*</span>se, p <span class="sc">+</span> z_crit<span class="sc">*</span>se))</span>
<span id="cb57-776"><a href="#cb57-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-777"><a href="#cb57-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-778"><a href="#cb57-778" aria-hidden="true" tabindex="-1"></a><span class="in">`prop.test()`</span> (and <span class="in">`chissq.test()`</span>) reported a *p*-value of <span class="in">`r prop.test(20, 40, 0.6, "two.sided", correct = FALSE)["p.value"] %&gt;% unlist()`</span>, so you cannot reject the null hypothesis that $\pi = 0.6$. It's good practice to plot this out to make sure your head is on straight.</span>
<span id="cb57-779"><a href="#cb57-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-780"><a href="#cb57-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE, fig.height=3, fig.width=5, echo=FALSE, fig.align="center"}</span></span>
<span id="cb57-781"><a href="#cb57-781" aria-hidden="true" tabindex="-1"></a><span class="in">p_value = prop.test(20, 40, 0.6, "two.sided", correct = FALSE)["p.value"] %&gt;% unlist()</span></span>
<span id="cb57-782"><a href="#cb57-782" aria-hidden="true" tabindex="-1"></a><span class="in">se_pi_0 &lt;- sqrt(pi_0 * (1 - pi_0) / 40)</span></span>
<span id="cb57-783"><a href="#cb57-783" aria-hidden="true" tabindex="-1"></a><span class="in">p_value &lt;- pnorm(z, lower.tail = FALSE) * 2</span></span>
<span id="cb57-784"><a href="#cb57-784" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(pi = seq(from = 0.2, to = 0.8, by = .001)) %&gt;%</span></span>
<span id="cb57-785"><a href="#cb57-785" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(density = dnorm(pi, pi_0, se_pi_0),</span></span>
<span id="cb57-786"><a href="#cb57-786" aria-hidden="true" tabindex="-1"></a><span class="in">         q25 = ifelse(pi &lt; qnorm(p = .025, pi_0, se_pi_0), density, as.numeric(NA)),</span></span>
<span id="cb57-787"><a href="#cb57-787" aria-hidden="true" tabindex="-1"></a><span class="in">         q95 = ifelse(pi &gt; qnorm(p = .975, pi_0, se_pi_0), density, as.numeric(NA))) %&gt;%</span></span>
<span id="cb57-788"><a href="#cb57-788" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb57-789"><a href="#cb57-789" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = pi, y = q25), fill = "#EF7C8E") +</span></span>
<span id="cb57-790"><a href="#cb57-790" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_area(aes(x = pi, y = q95), fill = "#EF7C8E") +</span></span>
<span id="cb57-791"><a href="#cb57-791" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x = pi, y = density)) +</span></span>
<span id="cb57-792"><a href="#cb57-792" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = p), color = "#0C6980", size = 1.0) +</span></span>
<span id="cb57-793"><a href="#cb57-793" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(aes(xintercept = pi_0), color = "#000000", size = 0.5, linetype = 2) +</span></span>
<span id="cb57-794"><a href="#cb57-794" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "One-Proportion Z-Test",</span></span>
<span id="cb57-795"><a href="#cb57-795" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = expression(paste(pi[0], " = 0.6, p = 0.5, p-value = 0.197")),</span></span>
<span id="cb57-796"><a href="#cb57-796" aria-hidden="true" tabindex="-1"></a><span class="in">       x = expression(pi), y = "Density") +</span></span>
<span id="cb57-797"><a href="#cb57-797" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb57-798"><a href="#cb57-798" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position="none")</span></span>
<span id="cb57-799"><a href="#cb57-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-800"><a href="#cb57-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-801"><a href="#cb57-801" aria-hidden="true" tabindex="-1"></a>Incidentally, if you have a margin of error requirement, you can back into the required sample size to achieve it. Just solve the margin of error equation $\epsilon  = z_{\alpha/2}^2 = \sqrt{\frac{\pi_0(1-\pi_0)}{n}}$ for $n = \frac{z_{\alpha/2}^2 \pi_0(1-\pi_0)}{\epsilon^2}.$</span>
<span id="cb57-802"><a href="#cb57-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-803"><a href="#cb57-803" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1 sample t Test for Categorical Var</span></span>
<span id="cb57-804"><a href="#cb57-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-805"><a href="#cb57-805" aria-hidden="true" tabindex="-1"></a>This test applies when you do not know the population variance.</span>
<span id="cb57-806"><a href="#cb57-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-807"><a href="#cb57-807" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wilcoxon 1-Sample Median Test for Categorical Var</span></span>
<span id="cb57-808"><a href="#cb57-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-809"><a href="#cb57-809" aria-hidden="true" tabindex="-1"></a>This test applies when the variable is not normally distributed.</span>
<span id="cb57-810"><a href="#cb57-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-811"><a href="#cb57-811" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multivariate Statistics</span></span>
<span id="cb57-812"><a href="#cb57-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-813"><a href="#cb57-813" aria-hidden="true" tabindex="-1"></a>The t-tests and analysis of variance tests have multivariate analogs. Multivariate statistics apply when multiple variables are simultaneously analyzed. Hotellings's *T*^2 extends the independent samples *t*-test and MANOVA extends ANOVA to cases where there are two or more dependent variables (e.g., do math, science, and reading scores depend on students' anxiety level?). </span>
<span id="cb57-814"><a href="#cb57-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-815"><a href="#cb57-815" aria-hidden="true" tabindex="-1"></a>The mean of variable $j$ is the average of row vector $X_j$, $\bar{x}_j = \frac{1}{n} \sum_{i = 1}^n X_{ij}$. $\bar{x}_j$ estimates the population mean, $\mu_j = E(X_j)$. The collection of means is a column vector, $\bar{\mathbf{x}}$ estimating $\boldsymbol{\mu}$.</span>
<span id="cb57-816"><a href="#cb57-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-817"><a href="#cb57-817" aria-hidden="true" tabindex="-1"></a>The variance of variable $j$ is the average squared difference from the mean for row vector $X_j$, $s_j^2 = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j)^2$. It estimates the population variance, $\sigma_j^2 = E(X_j - \mu_j)^2$. The collection of variances is a column vector, $\mathbf{s}^2$ estimating $\boldsymbol{\sigma}^2$. </span>
<span id="cb57-818"><a href="#cb57-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-819"><a href="#cb57-819" aria-hidden="true" tabindex="-1"></a>The covariance of variables $j$ and $k$ is the average product of differences from their respective means, $s_{jk} = \frac{1}{n-1} \sum_{i=1}^n (X_{ij} - \bar{x}_j) (X_{ik} - \bar{x}_k)$. It estimates the population covariance, $\sigma_{jk} = E\{ (X_{ij} - \mu_j) (X_{ik} - \mu_k)\}$. The generalization across the entire matrix is the _variance-covariance matrix_, $\textbf{S}$ which estimates $\boldsymbol{\Sigma}$.</span>
<span id="cb57-820"><a href="#cb57-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-821"><a href="#cb57-821" aria-hidden="true" tabindex="-1"></a>$\bar{\mathbf{x}}$ is a function of random data, so it is also a random vector with a _sampling distribution_ mean and variance-covariance matrix. The variance of the sample mean is $V(\bar{\mathbf{x}}) = \frac{\textbf{S}}{n}$. It estimates the variance of the population mean,  $V(\bar{\mathbf{x}}) = \frac{\boldsymbol{\Sigma}}{n}$. If the samples are taken from a normal distribution or the sample size is large, the sampling distribution is approximately normal, $\bar{\textbf{x}} \sim N \left(\boldsymbol{\mu}, \frac{\boldsymbol{\Sigma}}{n} \right)$.</span>
<span id="cb57-822"><a href="#cb57-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-823"><a href="#cb57-823" aria-hidden="true" tabindex="-1"></a>The joint estimate of confidence intervals (CIs) around a multivariate set of population means is complicated by how the individual variables are treated.</span>
<span id="cb57-824"><a href="#cb57-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-825"><a href="#cb57-825" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**One at a time intervals**. The $1 - \alpha$ CI is $\bar{x}_j \pm t_{n-1}(\alpha / 2) \frac{s_j}{\sqrt{n}}$.</span>
<span id="cb57-826"><a href="#cb57-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-827"><a href="#cb57-827" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Bonferroni method**. A family of confidence intervals has a family-wide error rate of at least one CI not capturing its population mean equal to the sum of the individual error rates. The Bonferroni method divides $\alpha$ by the $p$ variables in the family, so the $1 - \alpha$ CI is $\bar{x}_j \pm t_{n-1}(\alpha / 2p) \frac{s_j}{\sqrt{n}}$.</span>
<span id="cb57-828"><a href="#cb57-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-829"><a href="#cb57-829" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Simultaneous confidence region**. This method considers the family of all possible linear combinations of the population means. The $1 - \alpha$ CI is $\bar{x}_j \pm \sqrt{\frac{p(n-1)}{n-p} F_{p, n-p}(\alpha)} \frac{s_j}{\sqrt{n}}$.</span>
<span id="cb57-830"><a href="#cb57-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-831"><a href="#cb57-831" aria-hidden="true" tabindex="-1"></a>**Quick Example**. </span>
<span id="cb57-832"><a href="#cb57-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-833"><a href="#cb57-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapse=TRUE}</span></span>
<span id="cb57-834"><a href="#cb57-834" aria-hidden="true" tabindex="-1"></a><span class="in"># Suppose you have p = 3 variables with mean and sd as follows.</span></span>
<span id="cb57-835"><a href="#cb57-835" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- 3</span></span>
<span id="cb57-836"><a href="#cb57-836" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- c(25, 25, 25)</span></span>
<span id="cb57-837"><a href="#cb57-837" aria-hidden="true" tabindex="-1"></a><span class="in">M &lt;- c(.84390, 1.79268, .70440)</span></span>
<span id="cb57-838"><a href="#cb57-838" aria-hidden="true" tabindex="-1"></a><span class="in">SD &lt;- c(.11402, .28347, .10756)</span></span>
<span id="cb57-839"><a href="#cb57-839" aria-hidden="true" tabindex="-1"></a><span class="in">SE &lt;- SD / sqrt(n)</span></span>
<span id="cb57-840"><a href="#cb57-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-841"><a href="#cb57-841" aria-hidden="true" tabindex="-1"></a><span class="in"># One at a time margins of error</span></span>
<span id="cb57-842"><a href="#cb57-842" aria-hidden="true" tabindex="-1"></a><span class="in">(prob &lt;- 1 - .05/2)</span></span>
<span id="cb57-843"><a href="#cb57-843" aria-hidden="true" tabindex="-1"></a><span class="in">(mult &lt;- qt(prob, n-1))</span></span>
<span id="cb57-844"><a href="#cb57-844" aria-hidden="true" tabindex="-1"></a><span class="in">(ME &lt;- mult * SE)</span></span>
<span id="cb57-845"><a href="#cb57-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-846"><a href="#cb57-846" aria-hidden="true" tabindex="-1"></a><span class="in"># Bonferonni</span></span>
<span id="cb57-847"><a href="#cb57-847" aria-hidden="true" tabindex="-1"></a><span class="in">(prob &lt;- 1 - .05/(2*p))</span></span>
<span id="cb57-848"><a href="#cb57-848" aria-hidden="true" tabindex="-1"></a><span class="in">(mult &lt;- qt(prob, n-1))</span></span>
<span id="cb57-849"><a href="#cb57-849" aria-hidden="true" tabindex="-1"></a><span class="in">(ME &lt;- mult * SE)</span></span>
<span id="cb57-850"><a href="#cb57-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-851"><a href="#cb57-851" aria-hidden="true" tabindex="-1"></a><span class="in"># Simultaneous</span></span>
<span id="cb57-852"><a href="#cb57-852" aria-hidden="true" tabindex="-1"></a><span class="in">(mult &lt;- sqrt((p * (n-1) / (n-p)) * qf(.95, p, n-p)))</span></span>
<span id="cb57-853"><a href="#cb57-853" aria-hidden="true" tabindex="-1"></a><span class="in">(ME &lt;- mult * SE)</span></span>
<span id="cb57-854"><a href="#cb57-854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb57-855"><a href="#cb57-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-856"><a href="#cb57-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-857"><a href="#cb57-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-858"><a href="#cb57-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-859"><a href="#cb57-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-860"><a href="#cb57-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-861"><a href="#cb57-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-862"><a href="#cb57-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-863"><a href="#cb57-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-864"><a href="#cb57-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-865"><a href="#cb57-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-866"><a href="#cb57-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-867"><a href="#cb57-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-868"><a href="#cb57-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-869"><a href="#cb57-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-870"><a href="#cb57-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-871"><a href="#cb57-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-872"><a href="#cb57-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-873"><a href="#cb57-873" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>